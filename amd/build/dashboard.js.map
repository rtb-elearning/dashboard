{"version":3,"file":"dashboard.js","sources":["../../node_modules/.pnpm/preact@10.27.2/node_modules/preact/dist/preact.module.js","../../node_modules/.pnpm/preact@10.27.2/node_modules/preact/jsx-runtime/dist/jsxRuntime.module.js","../../node_modules/.pnpm/preact@10.27.2/node_modules/preact/hooks/dist/hooks.module.js","../src/components/Dashboard.tsx","../src/components/Sidebar.tsx","../src/components/CompletionReport.tsx","../src/components/CoursesReport.tsx","../src/components/SchoolDirectory.tsx","../src/components/SchoolDetail.tsx","../src/components/StudentList.tsx","../src/components/TrafficReport.tsx","../src/components/AccessLog.tsx","../src/components/AdminPanel.tsx","../src/app.tsx","../src/dashboard.ts"],"sourcesContent":["var n,l,u,t,i,r,o,e,f,c,s,a,h,p={},v=[],y=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,w=Array.isArray;function d(n,l){for(var u in l)n[u]=l[u];return n}function g(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function _(l,u,t){var i,r,o,e={};for(o in u)\"key\"==o?i=u[o]:\"ref\"==o?r=u[o]:e[o]=u[o];if(arguments.length>2&&(e.children=arguments.length>3?n.call(arguments,2):t),\"function\"==typeof l&&null!=l.defaultProps)for(o in l.defaultProps)void 0===e[o]&&(e[o]=l.defaultProps[o]);return m(l,e,i,r,null)}function m(n,t,i,r,o){var e={type:n,props:t,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==o?++u:o,__i:-1,__u:0};return null==o&&null!=l.vnode&&l.vnode(e),e}function b(){return{current:null}}function k(n){return n.children}function x(n,l){this.props=n,this.context=l}function S(n,l){if(null==l)return n.__?S(n.__,n.__i+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?S(n):null}function C(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return C(n)}}function M(n){(!n.__d&&(n.__d=!0)&&i.push(n)&&!$.__r++||r!=l.debounceRendering)&&((r=l.debounceRendering)||o)($)}function $(){for(var n,u,t,r,o,f,c,s=1;i.length;)i.length>s&&i.sort(e),n=i.shift(),s=i.length,n.__d&&(t=void 0,r=void 0,o=(r=(u=n).__v).__e,f=[],c=[],u.__P&&((t=d({},r)).__v=r.__v+1,l.vnode&&l.vnode(t),O(u.__P,t,r,u.__n,u.__P.namespaceURI,32&r.__u?[o]:null,f,null==o?S(r):o,!!(32&r.__u),c),t.__v=r.__v,t.__.__k[t.__i]=t,N(f,t,c),r.__e=r.__=null,t.__e!=o&&C(t)));$.__r=0}function I(n,l,u,t,i,r,o,e,f,c,s){var a,h,y,w,d,g,_,m=t&&t.__k||v,b=l.length;for(f=P(u,l,m,f,b),a=0;a<b;a++)null!=(y=u.__k[a])&&(h=-1==y.__i?p:m[y.__i]||p,y.__i=a,g=O(n,y,h,i,r,o,e,f,c,s),w=y.__e,y.ref&&h.ref!=y.ref&&(h.ref&&B(h.ref,null,y),s.push(y.ref,y.__c||w,y)),null==d&&null!=w&&(d=w),(_=!!(4&y.__u))||h.__k===y.__k?f=A(y,f,n,_):\"function\"==typeof y.type&&void 0!==g?f=g:w&&(f=w.nextSibling),y.__u&=-7);return u.__e=d,f}function P(n,l,u,t,i){var r,o,e,f,c,s=u.length,a=s,h=0;for(n.__k=new Array(i),r=0;r<i;r++)null!=(o=l[r])&&\"boolean\"!=typeof o&&\"function\"!=typeof o?(f=r+h,(o=n.__k[r]=\"string\"==typeof o||\"number\"==typeof o||\"bigint\"==typeof o||o.constructor==String?m(null,o,null,null,null):w(o)?m(k,{children:o},null,null,null):null==o.constructor&&o.__b>0?m(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=n,o.__b=n.__b+1,e=null,-1!=(c=o.__i=L(o,u,f,a))&&(a--,(e=u[c])&&(e.__u|=2)),null==e||null==e.__v?(-1==c&&(i>s?h--:i<s&&h++),\"function\"!=typeof o.type&&(o.__u|=4)):c!=f&&(c==f-1?h--:c==f+1?h++:(c>f?h--:h++,o.__u|=4))):n.__k[r]=null;if(a)for(r=0;r<s;r++)null!=(e=u[r])&&0==(2&e.__u)&&(e.__e==t&&(t=S(e)),D(e,e));return t}function A(n,l,u,t){var i,r;if(\"function\"==typeof n.type){for(i=n.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=n,l=A(i[r],l,u,t));return l}n.__e!=l&&(t&&(l&&n.type&&!l.parentNode&&(l=S(n)),u.insertBefore(n.__e,l||null)),l=n.__e);do{l=l&&l.nextSibling}while(null!=l&&8==l.nodeType);return l}function H(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(w(n)?n.some(function(n){H(n,l)}):l.push(n)),l}function L(n,l,u,t){var i,r,o,e=n.key,f=n.type,c=l[u],s=null!=c&&0==(2&c.__u);if(null===c&&null==n.key||s&&e==c.key&&f==c.type)return u;if(t>(s?1:0))for(i=u-1,r=u+1;i>=0||r<l.length;)if(null!=(c=l[o=i>=0?i--:r++])&&0==(2&c.__u)&&e==c.key&&f==c.type)return o;return-1}function T(n,l,u){\"-\"==l[0]?n.setProperty(l,null==u?\"\":u):n[l]=null==u?\"\":\"number\"!=typeof u||y.test(l)?u:u+\"px\"}function j(n,l,u,t,i){var r,o;n:if(\"style\"==l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof t&&(n.style.cssText=t=\"\"),t)for(l in t)u&&l in u||T(n.style,l,\"\");if(u)for(l in u)t&&u[l]==t[l]||T(n.style,l,u[l])}else if(\"o\"==l[0]&&\"n\"==l[1])r=l!=(l=l.replace(f,\"$1\")),o=l.toLowerCase(),l=o in n||\"onFocusOut\"==l||\"onFocusIn\"==l?o.slice(2):l.slice(2),n.l||(n.l={}),n.l[l+r]=u,u?t?u.u=t.u:(u.u=c,n.addEventListener(l,r?a:s,r)):n.removeEventListener(l,r?a:s,r);else{if(\"http://www.w3.org/2000/svg\"==i)l=l.replace(/xlink(H|:h)/,\"h\").replace(/sName$/,\"s\");else if(\"width\"!=l&&\"height\"!=l&&\"href\"!=l&&\"list\"!=l&&\"form\"!=l&&\"tabIndex\"!=l&&\"download\"!=l&&\"rowSpan\"!=l&&\"colSpan\"!=l&&\"role\"!=l&&\"popover\"!=l&&l in n)try{n[l]=null==u?\"\":u;break n}catch(n){}\"function\"==typeof u||(null==u||!1===u&&\"-\"!=l[4]?n.removeAttribute(l):n.setAttribute(l,\"popover\"==l&&1==u?\"\":u))}}function F(n){return function(u){if(this.l){var t=this.l[u.type+n];if(null==u.t)u.t=c++;else if(u.t<t.u)return;return t(l.event?l.event(u):u)}}}function O(n,u,t,i,r,o,e,f,c,s){var a,h,p,v,y,_,m,b,S,C,M,$,P,A,H,L,T,j=u.type;if(null!=u.constructor)return null;128&t.__u&&(c=!!(32&t.__u),o=[f=u.__e=t.__e]),(a=l.__b)&&a(u);n:if(\"function\"==typeof j)try{if(b=u.props,S=\"prototype\"in j&&j.prototype.render,C=(a=j.contextType)&&i[a.__c],M=a?C?C.props.value:a.__:i,t.__c?m=(h=u.__c=t.__c).__=h.__E:(S?u.__c=h=new j(b,M):(u.__c=h=new x(b,M),h.constructor=j,h.render=E),C&&C.sub(h),h.props=b,h.state||(h.state={}),h.context=M,h.__n=i,p=h.__d=!0,h.__h=[],h._sb=[]),S&&null==h.__s&&(h.__s=h.state),S&&null!=j.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=d({},h.__s)),d(h.__s,j.getDerivedStateFromProps(b,h.__s))),v=h.props,y=h.state,h.__v=u,p)S&&null==j.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),S&&null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(S&&null==j.getDerivedStateFromProps&&b!==v&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(b,M),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(b,h.__s,M)||u.__v==t.__v){for(u.__v!=t.__v&&(h.props=b,h.state=h.__s,h.__d=!1),u.__e=t.__e,u.__k=t.__k,u.__k.some(function(n){n&&(n.__=u)}),$=0;$<h._sb.length;$++)h.__h.push(h._sb[$]);h._sb=[],h.__h.length&&e.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(b,h.__s,M),S&&null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(v,y,_)})}if(h.context=M,h.props=b,h.__P=n,h.__e=!1,P=l.__r,A=0,S){for(h.state=h.__s,h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),H=0;H<h._sb.length;H++)h.__h.push(h._sb[H]);h._sb=[]}else do{h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++A<25);h.state=h.__s,null!=h.getChildContext&&(i=d(d({},i),h.getChildContext())),S&&!p&&null!=h.getSnapshotBeforeUpdate&&(_=h.getSnapshotBeforeUpdate(v,y)),L=a,null!=a&&a.type===k&&null==a.key&&(L=V(a.props.children)),f=I(n,w(L)?L:[L],u,t,i,r,o,e,f,c,s),h.base=u.__e,u.__u&=-161,h.__h.length&&e.push(h),m&&(h.__E=h.__=null)}catch(n){if(u.__v=null,c||null!=o)if(n.then){for(u.__u|=c?160:128;f&&8==f.nodeType&&f.nextSibling;)f=f.nextSibling;o[o.indexOf(f)]=null,u.__e=f}else{for(T=o.length;T--;)g(o[T]);z(u)}else u.__e=t.__e,u.__k=t.__k,n.then||z(u);l.__e(n,u,t)}else null==o&&u.__v==t.__v?(u.__k=t.__k,u.__e=t.__e):f=u.__e=q(t.__e,u,t,i,r,o,e,c,s);return(a=l.diffed)&&a(u),128&u.__u?void 0:f}function z(n){n&&n.__c&&(n.__c.__e=!0),n&&n.__k&&n.__k.forEach(z)}function N(n,u,t){for(var i=0;i<t.length;i++)B(t[i],t[++i],t[++i]);l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function V(n){return\"object\"!=typeof n||null==n||n.__b&&n.__b>0?n:w(n)?n.map(V):d({},n)}function q(u,t,i,r,o,e,f,c,s){var a,h,v,y,d,_,m,b=i.props,k=t.props,x=t.type;if(\"svg\"==x?o=\"http://www.w3.org/2000/svg\":\"math\"==x?o=\"http://www.w3.org/1998/Math/MathML\":o||(o=\"http://www.w3.org/1999/xhtml\"),null!=e)for(a=0;a<e.length;a++)if((d=e[a])&&\"setAttribute\"in d==!!x&&(x?d.localName==x:3==d.nodeType)){u=d,e[a]=null;break}if(null==u){if(null==x)return document.createTextNode(k);u=document.createElementNS(o,x,k.is&&k),c&&(l.__m&&l.__m(t,e),c=!1),e=null}if(null==x)b===k||c&&u.data==k||(u.data=k);else{if(e=e&&n.call(u.childNodes),b=i.props||p,!c&&null!=e)for(b={},a=0;a<u.attributes.length;a++)b[(d=u.attributes[a]).name]=d.value;for(a in b)if(d=b[a],\"children\"==a);else if(\"dangerouslySetInnerHTML\"==a)v=d;else if(!(a in k)){if(\"value\"==a&&\"defaultValue\"in k||\"checked\"==a&&\"defaultChecked\"in k)continue;j(u,a,null,d,o)}for(a in k)d=k[a],\"children\"==a?y=d:\"dangerouslySetInnerHTML\"==a?h=d:\"value\"==a?_=d:\"checked\"==a?m=d:c&&\"function\"!=typeof d||b[a]===d||j(u,a,d,b[a],o);if(h)c||v&&(h.__html==v.__html||h.__html==u.innerHTML)||(u.innerHTML=h.__html),t.__k=[];else if(v&&(u.innerHTML=\"\"),I(\"template\"==t.type?u.content:u,w(y)?y:[y],t,i,r,\"foreignObject\"==x?\"http://www.w3.org/1999/xhtml\":o,e,f,e?e[0]:i.__k&&S(i,0),c,s),null!=e)for(a=e.length;a--;)g(e[a]);c||(a=\"value\",\"progress\"==x&&null==_?u.removeAttribute(\"value\"):null!=_&&(_!==u[a]||\"progress\"==x&&!_||\"option\"==x&&_!=b[a])&&j(u,a,_,b[a],o),a=\"checked\",null!=m&&m!=u[a]&&j(u,a,m,b[a],o))}return u}function B(n,u,t){try{if(\"function\"==typeof n){var i=\"function\"==typeof n.__u;i&&n.__u(),i&&null==u||(n.__u=n(u))}else n.current=u}catch(n){l.__e(n,t)}}function D(n,u,t){var i,r;if(l.unmount&&l.unmount(n),(i=n.ref)&&(i.current&&i.current!=n.__e||B(i,null,u)),null!=(i=n.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(n){l.__e(n,u)}i.base=i.__P=null}if(i=n.__k)for(r=0;r<i.length;r++)i[r]&&D(i[r],u,t||\"function\"!=typeof n.type);t||g(n.__e),n.__c=n.__=n.__e=void 0}function E(n,l,u){return this.constructor(n,u)}function G(u,t,i){var r,o,e,f;t==document&&(t=document.documentElement),l.__&&l.__(u,t),o=(r=\"function\"==typeof i)?null:i&&i.__k||t.__k,e=[],f=[],O(t,u=(!r&&i||t).__k=_(k,null,[u]),o||p,p,t.namespaceURI,!r&&i?[i]:o?null:t.firstChild?n.call(t.childNodes):null,e,!r&&i?i:o?o.__e:t.firstChild,r,f),N(e,u,f)}function J(n,l){G(n,l,J)}function K(l,u,t){var i,r,o,e,f=d({},l.props);for(o in l.type&&l.type.defaultProps&&(e=l.type.defaultProps),u)\"key\"==o?i=u[o]:\"ref\"==o?r=u[o]:f[o]=void 0===u[o]&&null!=e?e[o]:u[o];return arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):t),m(l.type,f,i||l.key,r||l.ref,null)}function Q(n){function l(n){var u,t;return this.getChildContext||(u=new Set,(t={})[l.__c]=this,this.getChildContext=function(){return t},this.componentWillUnmount=function(){u=null},this.shouldComponentUpdate=function(n){this.props.value!=n.value&&u.forEach(function(n){n.__e=!0,M(n)})},this.sub=function(n){u.add(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u&&u.delete(n),l&&l.call(n)}}),n.children}return l.__c=\"__cC\"+h++,l.__=n,l.Provider=l.__l=(l.Consumer=function(n,l){return n.children(l)}).contextType=l,l}n=v.slice,l={__e:function(n,l,u,t){for(var i,r,o;l=l.__;)if((i=l.__c)&&!i.__)try{if((r=i.constructor)&&null!=r.getDerivedStateFromError&&(i.setState(r.getDerivedStateFromError(n)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(n,t||{}),o=i.__d),o)return i.__E=i}catch(l){n=l}throw n}},u=0,t=function(n){return null!=n&&null==n.constructor},x.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=d({},this.state),\"function\"==typeof n&&(n=n(d({},u),this.props)),n&&d(u,n),null!=n&&this.__v&&(l&&this._sb.push(l),M(this))},x.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),M(this))},x.prototype.render=k,i=[],o=\"function\"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e=function(n,l){return n.__v.__b-l.__v.__b},$.__r=0,f=/(PointerCapture)$|Capture$/i,c=0,s=F(!1),a=F(!0),h=0;export{x as Component,k as Fragment,K as cloneElement,Q as createContext,_ as createElement,b as createRef,_ as h,J as hydrate,t as isValidElement,l as options,G as render,H as toChildArray};\n//# sourceMappingURL=preact.module.js.map\n","import{options as r,Fragment as e}from\"preact\";export{Fragment}from\"preact\";var t=/[\"&<]/;function n(r){if(0===r.length||!1===t.test(r))return r;for(var e=0,n=0,o=\"\",f=\"\";n<r.length;n++){switch(r.charCodeAt(n)){case 34:f=\"&quot;\";break;case 38:f=\"&amp;\";break;case 60:f=\"&lt;\";break;default:continue}n!==e&&(o+=r.slice(e,n)),o+=f,e=n+1}return n!==e&&(o+=r.slice(e,n)),o}var o=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,f=0,i=Array.isArray;function u(e,t,n,o,i,u){t||(t={});var a,c,p=t;if(\"ref\"in p)for(c in p={},t)\"ref\"==c?a=t[c]:p[c]=t[c];var l={type:e,props:p,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--f,__i:-1,__u:0,__source:i,__self:u};if(\"function\"==typeof e&&(a=e.defaultProps))for(c in a)void 0===p[c]&&(p[c]=a[c]);return r.vnode&&r.vnode(l),l}function a(r){var t=u(e,{tpl:r,exprs:[].slice.call(arguments,1)});return t.key=t.__v,t}var c={},p=/[A-Z]/g;function l(e,t){if(r.attr){var f=r.attr(e,t);if(\"string\"==typeof f)return f}if(t=function(r){return null!==r&&\"object\"==typeof r&&\"function\"==typeof r.valueOf?r.valueOf():r}(t),\"ref\"===e||\"key\"===e)return\"\";if(\"style\"===e&&\"object\"==typeof t){var i=\"\";for(var u in t){var a=t[u];if(null!=a&&\"\"!==a){var l=\"-\"==u[0]?u:c[u]||(c[u]=u.replace(p,\"-$&\").toLowerCase()),s=\";\";\"number\"!=typeof a||l.startsWith(\"--\")||o.test(l)||(s=\"px;\"),i=i+l+\":\"+a+s}}return e+'=\"'+n(i)+'\"'}return null==t||!1===t||\"function\"==typeof t||\"object\"==typeof t?\"\":!0===t?e:e+'=\"'+n(\"\"+t)+'\"'}function s(r){if(null==r||\"boolean\"==typeof r||\"function\"==typeof r)return null;if(\"object\"==typeof r){if(void 0===r.constructor)return r;if(i(r)){for(var e=0;e<r.length;e++)r[e]=s(r[e]);return r}}return n(\"\"+r)}export{u as jsx,l as jsxAttr,u as jsxDEV,s as jsxEscape,a as jsxTemplate,u as jsxs};\n//# sourceMappingURL=jsxRuntime.module.js.map\n","import{options as n}from\"preact\";var t,r,u,i,o=0,f=[],c=n,e=c.__b,a=c.__r,v=c.diffed,l=c.__c,m=c.unmount,s=c.__;function p(n,t){c.__h&&c.__h(r,n,o||t),o=0;var u=r.__H||(r.__H={__:[],__h:[]});return n>=u.__.length&&u.__.push({}),u.__[n]}function d(n){return o=1,h(D,n)}function h(n,u,i){var o=p(t++,2);if(o.t=n,!o.__c&&(o.__=[i?i(u):D(void 0,u),function(n){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,n);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=r,!r.__f)){var f=function(n,t,r){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(n){return!!n.__c});if(u.every(function(n){return!n.__N}))return!c||c.call(this,n,t,r);var i=o.__c.props!==n;return u.forEach(function(n){if(n.__N){var t=n.__[0];n.__=n.__N,n.__N=void 0,t!==n.__[0]&&(i=!0)}}),c&&c.call(this,n,t,r)||i};r.__f=!0;var c=r.shouldComponentUpdate,e=r.componentWillUpdate;r.componentWillUpdate=function(n,t,r){if(this.__e){var u=c;c=void 0,f(n,t,r),c=u}e&&e.call(this,n,t,r)},r.shouldComponentUpdate=f}return o.__N||o.__}function y(n,u){var i=p(t++,3);!c.__s&&C(i.__H,u)&&(i.__=n,i.u=u,r.__H.__h.push(i))}function _(n,u){var i=p(t++,4);!c.__s&&C(i.__H,u)&&(i.__=n,i.u=u,r.__h.push(i))}function A(n){return o=5,T(function(){return{current:n}},[])}function F(n,t,r){o=6,_(function(){if(\"function\"==typeof n){var r=n(t());return function(){n(null),r&&\"function\"==typeof r&&r()}}if(n)return n.current=t(),function(){return n.current=null}},null==r?r:r.concat(n))}function T(n,r){var u=p(t++,7);return C(u.__H,r)&&(u.__=n(),u.__H=r,u.__h=n),u.__}function q(n,t){return o=8,T(function(){return n},t)}function x(n){var u=r.context[n.__c],i=p(t++,9);return i.c=n,u?(null==i.__&&(i.__=!0,u.sub(r)),u.props.value):n.__}function P(n,t){c.useDebugValue&&c.useDebugValue(t?t(n):n)}function b(n){var u=p(t++,10),i=d();return u.__=n,r.componentDidCatch||(r.componentDidCatch=function(n,t){u.__&&u.__(n,t),i[1](n)}),[i[0],function(){i[1](void 0)}]}function g(){var n=p(t++,11);if(!n.__){for(var u=r.__v;null!==u&&!u.__m&&null!==u.__;)u=u.__;var i=u.__m||(u.__m=[0,0]);n.__=\"P\"+i[0]+\"-\"+i[1]++}return n.__}function j(){for(var n;n=f.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(z),n.__H.__h.forEach(B),n.__H.__h=[]}catch(t){n.__H.__h=[],c.__e(t,n.__v)}}c.__b=function(n){r=null,e&&e(n)},c.__=function(n,t){n&&t.__k&&t.__k.__m&&(n.__m=t.__k.__m),s&&s(n,t)},c.__r=function(n){a&&a(n),t=0;var i=(r=n.__c).__H;i&&(u===r?(i.__h=[],r.__h=[],i.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(i.__h.forEach(z),i.__h.forEach(B),i.__h=[],t=0)),u=r},c.diffed=function(n){v&&v(n);var t=n.__c;t&&t.__H&&(t.__H.__h.length&&(1!==f.push(t)&&i===c.requestAnimationFrame||((i=c.requestAnimationFrame)||w)(j)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),u=r=null},c.__c=function(n,t){t.some(function(n){try{n.__h.forEach(z),n.__h=n.__h.filter(function(n){return!n.__||B(n)})}catch(r){t.some(function(n){n.__h&&(n.__h=[])}),t=[],c.__e(r,n.__v)}}),l&&l(n,t)},c.unmount=function(n){m&&m(n);var t,r=n.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{z(n)}catch(n){t=n}}),r.__H=void 0,t&&c.__e(t,r.__v))};var k=\"function\"==typeof requestAnimationFrame;function w(n){var t,r=function(){clearTimeout(u),k&&cancelAnimationFrame(t),setTimeout(n)},u=setTimeout(r,35);k&&(t=requestAnimationFrame(r))}function z(n){var t=r,u=n.__c;\"function\"==typeof u&&(n.__c=void 0,u()),r=t}function B(n){var t=r;n.__c=n.__(),r=t}function C(n,t){return!n||n.length!==t.length||t.some(function(t,r){return t!==n[r]})}function D(n,t){return\"function\"==typeof t?t(n):t}export{q as useCallback,x as useContext,P as useDebugValue,y as useEffect,b as useErrorBoundary,g as useId,F as useImperativeHandle,_ as useLayoutEffect,T as useMemo,h as useReducer,A as useRef,d as useState};\n//# sourceMappingURL=hooks.module.js.map\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Dashboard component for Elby Dashboard.\n *\n * @module     local_elby_dashboard/components/Dashboard\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport type { UserData, StatsData, ThemeConfig, SchoolUserCounts, TrafficDataPoint } from '../types';\n\ninterface DashboardProps {\n    user: UserData;\n    stats: StatsData;\n    themeConfig: ThemeConfig;\n}\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\n// Stat Card Component\nfunction StatCard({ icon, value, label, customBgColor }: { icon: JSX.Element; value: string; label: string; customBgColor?: string }) {\n    return (\n        <div\n            className=\"rounded-xl p-4 flex items-center gap-4\"\n            style={customBgColor ? { backgroundColor: customBgColor } : undefined}\n        >\n            <div className=\"w-12 h-12 rounded-full bg-white/30 flex items-center justify-center\">\n                {icon}\n            </div>\n            <div>\n                <p className=\"text-xs text-gray-600 font-medium\">{label}</p>\n                <p className=\"text-xl font-bold text-gray-800\">{value}</p>\n            </div>\n        </div>\n    );\n}\n\n// Engagement Donut Chart\nfunction EngagementDonut({ activeThisWeek, atRisk, neverLoggedIn }: { activeThisWeek: number; atRisk: number; neverLoggedIn: number }) {\n    const total = activeThisWeek + atRisk + neverLoggedIn;\n    if (total === 0) {\n        return (\n            <div className=\"relative w-36 h-36\">\n                <svg viewBox=\"0 0 100 100\" className=\"w-full h-full\">\n                    <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"14\" />\n                </svg>\n                <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <span className=\"text-2xl font-bold text-gray-400\">0</span>\n                </div>\n            </div>\n        );\n    }\n\n    const circumference = 2 * Math.PI * 40; // ~251.2\n    const activeLen = (activeThisWeek / total) * circumference;\n    const atRiskLen = (atRisk / total) * circumference;\n    const neverLen = (neverLoggedIn / total) * circumference;\n\n    return (\n        <div className=\"relative w-36 h-36\">\n            <svg viewBox=\"0 0 100 100\" className=\"w-full h-full transform -rotate-90\">\n                {/* Background */}\n                <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"14\" />\n                {/* Active this week - green */}\n                <circle\n                    cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\"\n                    stroke=\"#22c55e\" strokeWidth=\"14\"\n                    strokeDasharray={`${activeLen} ${circumference - activeLen}`}\n                    strokeDashoffset=\"0\"\n                />\n                {/* At risk - amber */}\n                <circle\n                    cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\"\n                    stroke=\"#f59e0b\" strokeWidth=\"14\"\n                    strokeDasharray={`${atRiskLen} ${circumference - atRiskLen}`}\n                    strokeDashoffset={`${-activeLen}`}\n                />\n                {/* Never logged in - red */}\n                <circle\n                    cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\"\n                    stroke=\"#ef4444\" strokeWidth=\"14\"\n                    strokeDasharray={`${neverLen} ${circumference - neverLen}`}\n                    strokeDashoffset={`${-(activeLen + atRiskLen)}`}\n                />\n            </svg>\n            <div className=\"absolute inset-0 flex items-center justify-center\">\n                <span className=\"text-2xl font-bold text-gray-800\">{total}</span>\n            </div>\n        </div>\n    );\n}\n\n// Gender Donut Chart\nfunction GenderDonut({ male, female }: { male: number; female: number }) {\n    const total = male + female;\n    if (total === 0) {\n        return (\n            <div className=\"relative w-36 h-36\">\n                <svg viewBox=\"0 0 100 100\" className=\"w-full h-full\">\n                    <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"14\" />\n                </svg>\n                <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <span className=\"text-2xl font-bold text-gray-400\">0</span>\n                </div>\n            </div>\n        );\n    }\n\n    const circumference = 2 * Math.PI * 40;\n    const maleLen = (male / total) * circumference;\n    const femaleLen = (female / total) * circumference;\n\n    return (\n        <div className=\"relative w-36 h-36\">\n            <svg viewBox=\"0 0 100 100\" className=\"w-full h-full transform -rotate-90\">\n                <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"14\" />\n                {/* Male - blue */}\n                <circle\n                    cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\"\n                    stroke=\"#3b82f6\" strokeWidth=\"14\"\n                    strokeDasharray={`${maleLen} ${circumference - maleLen}`}\n                    strokeDashoffset=\"0\"\n                />\n                {/* Female - pink */}\n                <circle\n                    cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\"\n                    stroke=\"#ec4899\" strokeWidth=\"14\"\n                    strokeDasharray={`${femaleLen} ${circumference - femaleLen}`}\n                    strokeDashoffset={`${-maleLen}`}\n                />\n            </svg>\n            <div className=\"absolute inset-0 flex items-center justify-center\">\n                <span className=\"text-2xl font-bold text-gray-800\">{total}</span>\n            </div>\n        </div>\n    );\n}\n\n// Icons\nconst StudentsIcon = () => (\n    <svg className=\"w-6 h-6 text-cyan-600\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z\"/>\n    </svg>\n);\n\nconst TeacherIcon = () => (\n    <svg className=\"w-6 h-6 text-amber-600\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73v3.72z\"/>\n    </svg>\n);\n\nconst EmployeeIcon = () => (\n    <svg className=\"w-6 h-6 text-purple-600\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\"/>\n    </svg>\n);\n\nconst CoursesIcon = () => (\n    <svg className=\"w-6 h-6 text-green-600\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z\"/>\n    </svg>\n);\n\nconst SchoolsIcon = () => (\n    <svg className=\"w-6 h-6 text-blue-600\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73v3.72z\"/>\n    </svg>\n);\n\n// Status donut color map\nconst statusColors: Record<string, string> = {\n    CONTINUING: '#22c55e',\n    NEW: '#3b82f6',\n    INACTIVE: '#9ca3af',\n    GRADUATED: '#8b5cf6',\n    TRANSFERRED: '#f59e0b',\n};\n\n// Status Donut Chart\nfunction StatusDonut({ data }: { data: Array<{ label: string; count: number }> }) {\n    const total = data.reduce((sum, d) => sum + d.count, 0);\n    if (total === 0) {\n        return (\n            <div className=\"relative w-28 h-28\">\n                <svg viewBox=\"0 0 100 100\" className=\"w-full h-full\">\n                    <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"14\" />\n                </svg>\n                <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <span className=\"text-lg font-bold text-gray-400\">0</span>\n                </div>\n            </div>\n        );\n    }\n\n    const circumference = 2 * Math.PI * 40;\n    let offset = 0;\n\n    return (\n        <div className=\"relative w-28 h-28\">\n            <svg viewBox=\"0 0 100 100\" className=\"w-full h-full transform -rotate-90\">\n                <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"14\" />\n                {data.map((d) => {\n                    const len = (d.count / total) * circumference;\n                    const currentOffset = offset;\n                    offset += len;\n                    return (\n                        <circle\n                            key={d.label}\n                            cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\"\n                            stroke={statusColors[d.label] || '#6b7280'}\n                            strokeWidth=\"14\"\n                            strokeDasharray={`${len} ${circumference - len}`}\n                            strokeDashoffset={`${-currentOffset}`}\n                        />\n                    );\n                })}\n            </svg>\n            <div className=\"absolute inset-0 flex items-center justify-center\">\n                <span className=\"text-lg font-bold text-gray-800\">{total.toLocaleString()}</span>\n            </div>\n        </div>\n    );\n}\n\nexport default function Dashboard({ user, stats, themeConfig }: DashboardProps) {\n    const [schools, setSchools] = useState<SchoolUserCounts[]>([]);\n    const [schoolsLoading, setSchoolsLoading] = useState(true);\n    const [traffic, setTraffic] = useState<TrafficDataPoint[]>([]);\n    const [trafficLoading, setTrafficLoading] = useState(true);\n\n    useEffect(() => {\n        // Fetch school user counts\n        ajaxCall('local_elby_dashboard_get_school_user_counts', {})\n            .then((resp: { schools: SchoolUserCounts[] }) => {\n                const data = resp.schools || [];\n                // Sort by student_count descending, take top 8\n                const sorted = [...data].sort((a, b) => b.student_count - a.student_count).slice(0, 8);\n                setSchools(sorted);\n            })\n            .catch(() => setSchools([]))\n            .finally(() => setSchoolsLoading(false));\n\n        // Fetch platform traffic (last 7 days)\n        ajaxCall('local_elby_dashboard_get_platform_traffic', { period: 'daily', days_back: 7 })\n            .then((resp: { data: TrafficDataPoint[] }) => setTraffic(resp.data || []))\n            .catch(() => setTraffic([]))\n            .finally(() => setTrafficLoading(false));\n    }, []);\n\n    const schoolMaxCount = schools.length > 0 ? Math.max(...schools.map(s => s.student_count)) : 1;\n    const trafficMax = traffic.length > 0 ? Math.max(...traffic.map(t => t.unique_users), 1) : 1;\n\n    return (\n        <div className=\"p-2 sm:p-4 lg:p-6 bg-gray-50 min-h-screen\">\n            {/* Row 1: Stats Cards */}\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-6\">\n                <StatCard\n                    icon={<SchoolsIcon />}\n                    value={stats.totalSchools.toLocaleString()}\n                    label=\"Schools\"\n                    customBgColor=\"#dbeafe\"\n                />\n                <StatCard\n                    icon={<StudentsIcon />}\n                    value={stats.totalStudents.toLocaleString()}\n                    label=\"Students\"\n                    customBgColor={themeConfig.statCard1Color}\n                />\n                <StatCard\n                    icon={<TeacherIcon />}\n                    value={stats.totalTeachers.toLocaleString()}\n                    label=\"Teachers\"\n                    customBgColor={themeConfig.statCard2Color}\n                />\n                <StatCard\n                    icon={<EmployeeIcon />}\n                    value={stats.totalUsers.toLocaleString()}\n                    label=\"Total Users\"\n                    customBgColor={themeConfig.statCard3Color}\n                />\n                <StatCard\n                    icon={<CoursesIcon />}\n                    value={stats.totalCourses.toLocaleString()}\n                    label=\"Courses\"\n                    customBgColor={themeConfig.statCard4Color}\n                />\n            </div>\n\n            {/* Row 2: Schools Overview & Engagement Summary */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6\">\n                {/* Section A: Schools Overview */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <h3 className=\"text-lg font-semibold text-gray-800\">Schools Overview</h3>\n                        <span className=\"text-sm text-gray-500\">Top {schools.length} by students</span>\n                    </div>\n                    {schoolsLoading ? (\n                        <div className=\"space-y-3\">\n                            {[...Array(5)].map((_, i) => (\n                                <div key={i} className=\"h-6 bg-gray-100 rounded animate-pulse\" />\n                            ))}\n                        </div>\n                    ) : schools.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500\">\n                            <p>No school data available</p>\n                        </div>\n                    ) : (\n                        <div style={{ display: 'flex', flexDirection: 'column', gap: '1.25rem' }}>\n                            {schools.map((school) => (\n                                <div key={school.school_code} className=\"flex items-center gap-3\">\n                                    <div className=\"w-28 text-xs text-gray-600 truncate flex-shrink-0\" title={school.school_name}>\n                                        {school.school_name}\n                                    </div>\n                                    <div className=\"flex-1 h-6 bg-gray-100 rounded-full overflow-hidden\">\n                                        <div\n                                            className=\"h-full bg-blue-500 rounded-full transition-all opacity-80 hover:opacity-100\"\n                                            style={{ width: `${(school.student_count / schoolMaxCount) * 100}%` }}\n                                        />\n                                    </div>\n                                    <span className=\"text-xs font-medium text-gray-700 w-10 text-right flex-shrink-0\">\n                                        {school.student_count}\n                                    </span>\n                                </div>\n                            ))}\n                        </div>\n                    )}\n                </div>\n\n                {/* Section B: User Overview */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">User Overview</h3>\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-6\">\n                        {/* Gender Demographics */}\n                        <div>\n                            <h4 className=\"text-sm font-medium text-gray-600 mb-3\">Student Demographics</h4>\n                            <div className=\"flex flex-col items-center gap-3\">\n                                <GenderDonut\n                                    male={stats.maleStudents}\n                                    female={stats.femaleStudents}\n                                />\n                                <div className=\"flex items-center gap-3 flex-wrap justify-center\">\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-blue-500\"></span>\n                                        <span className=\"text-xs text-gray-600\">Male: {stats.maleStudents.toLocaleString()}</span>\n                                    </div>\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-pink-500\"></span>\n                                        <span className=\"text-xs text-gray-600\">Female: {stats.femaleStudents.toLocaleString()}</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Engagement Status */}\n                        <div>\n                            <h4 className=\"text-sm font-medium text-gray-600 mb-3\">Engagement Status</h4>\n                            <div className=\"flex flex-col items-center gap-3\">\n                                <EngagementDonut\n                                    activeThisWeek={stats.activeThisWeek}\n                                    atRisk={stats.atRisk}\n                                    neverLoggedIn={stats.neverLoggedIn}\n                                />\n                                <div className=\"flex items-center gap-3 flex-wrap justify-center\">\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-green-500\"></span>\n                                        <span className=\"text-xs text-gray-500\">Active</span>\n                                    </div>\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-amber-500\"></span>\n                                        <span className=\"text-xs text-gray-500\">At Risk</span>\n                                    </div>\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-red-500\"></span>\n                                        <span className=\"text-xs text-gray-500\">Never</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Stat Badges */}\n                    <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-3 mt-4 pt-4 border-t border-gray-100\">\n                        <div className=\"bg-emerald-50 rounded-lg p-3\">\n                            <p className=\"text-xs text-gray-500\">Active Today</p>\n                            <p className=\"text-lg font-bold text-emerald-700\">{stats.activeToday.toLocaleString()}</p>\n                        </div>\n                        <div className=\"bg-green-50 rounded-lg p-3\">\n                            <p className=\"text-xs text-gray-500\">Active This Week</p>\n                            <p className=\"text-lg font-bold text-green-700\">{stats.activeThisWeek.toLocaleString()}</p>\n                        </div>\n                        <div className=\"bg-amber-50 rounded-lg p-3\">\n                            <p className=\"text-xs text-gray-500\">At Risk</p>\n                            <p className=\"text-lg font-bold text-amber-700\">{stats.atRisk.toLocaleString()}</p>\n                        </div>\n                        <div className=\"bg-red-50 rounded-lg p-3\">\n                            <p className=\"text-xs text-gray-500\">Never Logged In</p>\n                            <p className=\"text-lg font-bold text-red-700\">{stats.neverLoggedIn.toLocaleString()}</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Row 3: Students by Grade & Students by Program/Trade */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6\">\n                {/* Students by Grade Level */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <h3 className=\"text-lg font-semibold text-gray-800\">Students by Grade Level</h3>\n                        <span className=\"text-sm text-gray-500\">{stats.gradeDistribution.reduce((s, d) => s + d.count, 0).toLocaleString()} total</span>\n                    </div>\n                    {stats.gradeDistribution.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500\">\n                            <p>No grade data available yet</p>\n                        </div>\n                    ) : (\n                        <div className=\"flex flex-col\" style={{ gap: '16px' }}>\n                            {(() => {\n                                const gradeMax = Math.max(...stats.gradeDistribution.map(d => d.count), 1);\n                                return stats.gradeDistribution.map((d) => (\n                                    <div key={d.label} className=\"flex items-center gap-3\">\n                                        <div className=\"w-20 text-xs text-gray-600 truncate flex-shrink-0\" title={d.label}>\n                                            {d.label}\n                                        </div>\n                                        <div className=\"flex-1 bg-gray-100 rounded-full overflow-hidden\" style={{ height: '20px' }}>\n                                            <div\n                                                className=\"h-full bg-indigo-500 rounded-full transition-all opacity-80 hover:opacity-100\"\n                                                style={{ width: `${(d.count / gradeMax) * 100}%` }}\n                                            />\n                                        </div>\n                                        <span className=\"text-xs font-medium text-gray-700 w-12 text-right flex-shrink-0\">\n                                            {d.count.toLocaleString()}\n                                        </span>\n                                    </div>\n                                ));\n                            })()}\n                        </div>\n                    )}\n                </div>\n\n                {/* Students by Program/Trade */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <h3 className=\"text-lg font-semibold text-gray-800\">Students by Trade</h3>\n                        <span className=\"text-sm text-gray-500\">Top {stats.programDistribution.length}</span>\n                    </div>\n                    {stats.programDistribution.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500\">\n                            <p>No program data available yet</p>\n                        </div>\n                    ) : (\n                        <div className=\"space-y-3\">\n                            {(() => {\n                                const progMax = Math.max(...stats.programDistribution.map(d => d.count), 1);\n                                return stats.programDistribution.map((d) => (\n                                    <div key={d.label} className=\"flex items-center gap-3\">\n                                        <div className=\"w-28 text-xs text-gray-600 truncate flex-shrink-0\" title={d.label}>\n                                            {d.label}\n                                        </div>\n                                        <div className=\"flex-1 h-5 bg-gray-100 rounded-full overflow-hidden\">\n                                            <div\n                                                className=\"h-full bg-teal-500 rounded-full transition-all opacity-80 hover:opacity-100\"\n                                                style={{ width: `${(d.count / progMax) * 100}%` }}\n                                            />\n                                        </div>\n                                        <span className=\"text-xs font-medium text-gray-700 w-12 text-right flex-shrink-0\">\n                                            {d.count.toLocaleString()}\n                                        </span>\n                                    </div>\n                                ));\n                            })()}\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Row 4: Teacher Overview */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6\">\n                {/* Teacher Demographics */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Teacher Overview</h3>\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-6\">\n                        {/* Gender */}\n                        <div>\n                            <h4 className=\"text-sm font-medium text-gray-600 mb-3\">Gender</h4>\n                            <div className=\"flex flex-col items-center gap-3\">\n                                <GenderDonut\n                                    male={stats.maleTeachers}\n                                    female={stats.femaleTeachers}\n                                />\n                                <div className=\"flex items-center gap-3 flex-wrap justify-center\">\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-blue-500\"></span>\n                                        <span className=\"text-xs text-gray-600\">Male: {stats.maleTeachers.toLocaleString()}</span>\n                                    </div>\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-pink-500\"></span>\n                                        <span className=\"text-xs text-gray-600\">Female: {stats.femaleTeachers.toLocaleString()}</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Summary stats */}\n                        <div>\n                            <h4 className=\"text-sm font-medium text-gray-600 mb-3\">Summary</h4>\n                            <div className=\"space-y-3\">\n                                <div className=\"bg-amber-50 rounded-lg p-3\">\n                                    <p className=\"text-xs text-gray-500\">Total Teachers</p>\n                                    <p className=\"text-lg font-bold text-amber-700\">{stats.totalTeachers.toLocaleString()}</p>\n                                </div>\n                                <div className=\"bg-blue-50 rounded-lg p-3\">\n                                    <p className=\"text-xs text-gray-500\">Positions</p>\n                                    <p className=\"text-lg font-bold text-blue-700\">{stats.positionDistribution.length}</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Teacher Position Distribution */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <h3 className=\"text-lg font-semibold text-gray-800\">Teachers by Position</h3>\n                        <span className=\"text-sm text-gray-500\">{stats.positionDistribution.reduce((s, d) => s + d.count, 0).toLocaleString()} total</span>\n                    </div>\n                    {stats.positionDistribution.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500\">\n                            <p>No teacher data available yet</p>\n                        </div>\n                    ) : (\n                        <div style={{ display: 'flex', flexDirection: 'column', gap: '1.25rem' }}>\n                            {(() => {\n                                const posMax = Math.max(...stats.positionDistribution.map(d => d.count), 1);\n                                return stats.positionDistribution.map((d) => (\n                                    <div key={d.label} className=\"flex items-center gap-3\">\n                                        <div className=\"w-28 text-xs text-gray-600 truncate flex-shrink-0\" title={d.label}>\n                                            {d.label}\n                                        </div>\n                                        <div className=\"flex-1 h-6 bg-gray-100 rounded-full overflow-hidden\">\n                                            <div\n                                                className=\"h-full bg-amber-500 rounded-full transition-all opacity-80 hover:opacity-100\"\n                                                style={{ width: `${(d.count / posMax) * 100}%` }}\n                                            />\n                                        </div>\n                                        <span className=\"text-xs font-medium text-gray-700 w-12 text-right flex-shrink-0\">\n                                            {d.count.toLocaleString()}\n                                        </span>\n                                    </div>\n                                ));\n                            })()}\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Row 5: Platform Traffic & Student Status + Age */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                {/* Platform Traffic */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <h3 className=\"text-lg font-semibold text-gray-800\">Platform Traffic</h3>\n                        <span className=\"text-sm text-gray-500\">Last 7 days</span>\n                    </div>\n                    {trafficLoading ? (\n                        <div className=\"flex items-end justify-between h-48 gap-2 px-2\">\n                            {[...Array(7)].map((_, i) => (\n                                <div key={i} className=\"flex-1 bg-gray-100 rounded-t animate-pulse\" style={{ height: `${30 + Math.random() * 50}%` }} />\n                            ))}\n                        </div>\n                    ) : traffic.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500\">\n                            <p>No traffic data available</p>\n                        </div>\n                    ) : (\n                        <>\n                            <div className=\"flex items-end justify-between h-48 gap-2 px-2\">\n                                {traffic.map((point) => (\n                                    <div key={point.period_label} className=\"flex flex-col items-center gap-1 flex-1\">\n                                        <span className=\"text-xs font-medium text-gray-600\">{point.unique_users}</span>\n                                        <div className=\"w-full flex justify-center\" style={{ height: '10rem' }}>\n                                            <div className=\"flex items-end h-full w-full max-w-[2.5rem]\">\n                                                <div\n                                                    className=\"w-full bg-blue-500 rounded-t opacity-80 hover:opacity-100 transition-opacity\"\n                                                    style={{ height: `${(point.unique_users / trafficMax) * 100}%`, minHeight: point.unique_users > 0 ? '4px' : '0' }}\n                                                />\n                                            </div>\n                                        </div>\n                                        <span className=\"text-xs text-gray-500\">{point.period_label}</span>\n                                    </div>\n                                ))}\n                            </div>\n                            <div className=\"flex items-center gap-4 mt-3 pt-3 border-t border-gray-100\">\n                                <div className=\"flex items-center gap-1.5\">\n                                    <span className=\"w-2.5 h-2.5 rounded-full bg-blue-500\"></span>\n                                    <span className=\"text-xs text-gray-500\">Unique Users</span>\n                                </div>\n                            </div>\n                        </>\n                    )}\n                </div>\n\n                {/* Student Status & Age Distribution */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Student Status & Age</h3>\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-6\">\n                        {/* Status Donut */}\n                        <div>\n                            <h4 className=\"text-sm font-medium text-gray-600 mb-3\">SDMS Status</h4>\n                            <div className=\"flex flex-col items-center gap-3\">\n                                <StatusDonut data={stats.statusDistribution} />\n                                <div className=\"flex items-center gap-2 flex-wrap justify-center\">\n                                    {stats.statusDistribution.map((d) => (\n                                        <div key={d.label} className=\"flex items-center gap-1\">\n                                            <span\n                                                className=\"w-2 h-2 rounded-full flex-shrink-0\"\n                                                style={{ backgroundColor: statusColors[d.label] || '#6b7280' }}\n                                            ></span>\n                                            <span className=\"text-xs text-gray-500\">{d.label}: {d.count.toLocaleString()}</span>\n                                        </div>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Age Distribution */}\n                        <div>\n                            <h4 className=\"text-sm font-medium text-gray-600 mb-3\">Age Distribution</h4>\n                            {stats.ageDistribution.length === 0 ? (\n                                <div className=\"text-center py-4 text-gray-500 text-sm\">No age data yet</div>\n                            ) : (\n                                <div className=\"flex flex-col\" style={{ gap: '12px' }}>\n                                    {(() => {\n                                        const ageMax = Math.max(...stats.ageDistribution.map(d => d.count), 1);\n                                        return stats.ageDistribution.map((d) => (\n                                            <div key={d.label} className=\"flex items-center gap-2\">\n                                                <div className=\"w-14 text-xs text-gray-600 flex-shrink-0\">{d.label}</div>\n                                                <div className=\"flex-1 bg-gray-100 rounded-full overflow-hidden\" style={{ height: '18px' }}>\n                                                    <div\n                                                        className=\"h-full bg-violet-500 rounded-full opacity-80 hover:opacity-100 transition-all\"\n                                                        style={{ width: `${(d.count / ageMax) * 100}%` }}\n                                                    />\n                                                </div>\n                                                <span className=\"text-xs font-medium text-gray-700 w-10 text-right flex-shrink-0\">\n                                                    {d.count.toLocaleString()}\n                                                </span>\n                                            </div>\n                                        ));\n                                    })()}\n                                </div>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Sidebar navigation component for Elby Dashboard.\n *\n * @module     local_elby_dashboard/components/Sidebar\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport type { PageId, SidenavConfig, ThemeConfig } from '../types';\n\ninterface SidebarProps {\n    activePage: PageId;\n    sidenavConfig: SidenavConfig;\n    themeConfig: ThemeConfig;\n    isOpen: boolean;\n    onClose: () => void;\n}\n\n// Menu items\nconst menuItems = [\n    { id: 'home', name: 'Dashboard', icon: 'dashboard', url: '/local/elby_dashboard/index.php' },\n    { id: 'schools', name: 'Schools', icon: 'pedagogy', url: '/local/elby_dashboard/schools.php', capability: 'viewreports' },\n    { id: 'students', name: 'Students', icon: 'communication', url: '/local/elby_dashboard/students.php', capability: 'viewreports' },\n    { id: 'teachers', name: 'Teachers', icon: 'presence', url: '/local/elby_dashboard/teachers.php', capability: 'viewreports' },\n    { id: 'traffic', name: 'Traffic', icon: 'event', url: '/local/elby_dashboard/traffic.php', capability: 'viewreports' },\n    { id: 'accesslog', name: 'Access Log', icon: 'courses', url: '/local/elby_dashboard/accesslog.php', capability: 'viewreports' },\n    { id: 'admin', name: 'Admin Panel', icon: 'settings', url: '/local/elby_dashboard/admin/index.php', capability: 'admin' },\n];\n\n// Icon components\nconst icons: Record<string, JSX.Element> = {\n    dashboard: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M4 4h4v4H4V4zm6 0h4v4h-4V4zm6 0h4v4h-4V4zM4 10h4v4H4v-4zm6 0h4v4h-4v-4zm6 0h4v4h-4v-4zM4 16h4v4H4v-4zm6 0h4v4h-4v-4zm6 0h4v4h-4v-4z\"/>\n        </svg>\n    ),\n    courses: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z\"/>\n        </svg>\n    ),\n    presence: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V9h14v10zM5 7V5h14v2H5zm2 4h10v2H7v-2zm0 4h7v2H7v-2z\"/>\n        </svg>\n    ),\n    communication: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z\"/>\n        </svg>\n    ),\n    event: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z\"/>\n        </svg>\n    ),\n    payment: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z\"/>\n        </svg>\n    ),\n    pedagogy: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73v3.72z\"/>\n        </svg>\n    ),\n    message: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z\"/>\n        </svg>\n    ),\n    completion: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z\"/>\n        </svg>\n    ),\n    settings: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z\"/>\n        </svg>\n    ),\n    logout: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5-5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z\"/>\n        </svg>\n    ),\n};\n\n// Default logo icon (fallback when no logo is uploaded)\nconst DefaultLogoIcon = () => (\n    <svg className=\"w-8 h-8\" viewBox=\"0 0 40 40\" fill=\"none\">\n        <rect x=\"4\" y=\"20\" width=\"16\" height=\"16\" fill=\"#22d3ee\" transform=\"rotate(-45 12 28)\"/>\n        <rect x=\"20\" y=\"4\" width=\"16\" height=\"16\" fill=\"#fbbf24\" transform=\"rotate(-45 28 12)\"/>\n    </svg>\n);\n\nexport default function Sidebar({ activePage, sidenavConfig, themeConfig, isOpen, onClose }: SidebarProps) {\n    // Filter menu items based on visibility settings\n    const visibleMenuItems = menuItems.filter((item) => {\n        // Dashboard (home) is always visible\n        if (item.id === 'home') return true;\n        // Check visibility from theme config\n        return themeConfig.menuVisibility[item.id] !== false;\n    });\n\n    return (\n        <>\n            {/* Mobile backdrop overlay */}\n            {isOpen && (\n                <div\n                    className=\"fixed inset-0 bg-black/50 z-40 lg:hidden\"\n                    onClick={onClose}\n                />\n            )}\n\n            {/* Sidebar */}\n            <aside className={`\n                fixed lg:sticky inset-y-0 left-0 z-50 top-0\n                w-72 h-screen bg-gray-50 border-r border-gray-200 py-6 pr-4 overflow-y-auto flex flex-col\n                transform transition-transform duration-300 ease-in-out\n                ${isOpen ? 'translate-x-0' : '-translate-x-full lg:translate-x-0'}\n            `}>\n                {/* Header with logo and close button */}\n                <div className=\"pl-3 pb-6 flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                        {sidenavConfig.logoUrl ? (\n                            <img\n                                src={sidenavConfig.logoUrl}\n                                alt={sidenavConfig.title}\n                                className=\"w-8 h-8 object-contain\"\n                            />\n                        ) : (\n                            <DefaultLogoIcon />\n                        )}\n                        <span className=\"text-lg font-bold text-gray-800\">{sidenavConfig.title}</span>\n                    </div>\n                    {/* Close button - Mobile only */}\n                    <button\n                        onClick={onClose}\n                        className=\"lg:hidden p-2 mr-2 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded-lg\"\n                        aria-label=\"Close menu\"\n                    >\n                        <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" />\n                        </svg>\n                    </button>\n                </div>\n\n                {/* Main Menu Section */}\n                <div className=\"mb-8 flex-1\">\n                    <h6 className=\"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 pl-3\">\n                        Menu\n                    </h6>\n                    <ul className=\"space-y-1 m-0 p-0 list-none\">\n                        {visibleMenuItems.map((item) => {\n                            const isActive = item.id === activePage;\n                            return (\n                                <li key={item.id}>\n                                    <a\n                                        href={item.url}\n                                        className={`flex items-center px-3 py-2 rounded text-sm transition-colors no-underline ${\n                                            isActive\n                                                ? 'text-white'\n                                                : 'text-gray-700 hover:bg-gray-200'\n                                        }`}\n                                        style={isActive ? { backgroundColor: themeConfig.sidenavAccentColor } : undefined}\n                                    >\n                                        <span className={`w-5 mr-3 ${isActive ? 'text-white' : 'text-gray-500'}`}>\n                                            {icons[item.icon]}\n                                        </span>\n                                        <span>{item.name}</span>\n                                    </a>\n                                </li>\n                            );\n                        })}\n                    </ul>\n                </div>\n\n                {/* Account Section */}\n                <div className=\"mt-auto\">\n                    <h6 className=\"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 pl-3\">\n                        Account\n                    </h6>\n                    <ul className=\"space-y-1 m-0 p-0 list-none\">\n                        <li>\n                            <a\n                                href=\"/login/logout.php\"\n                                className=\"flex items-center px-3 py-2 rounded text-sm text-gray-700 hover:bg-gray-200 no-underline transition-colors\"\n                            >\n                                <span className=\"w-5 mr-3 text-gray-500\">{icons.logout}</span>\n                                <span>Log out</span>\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n            </aside>\n        </>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Completion Report component for RTB Dashboard.\n *\n * @module     local_rtbdashboard/components/CompletionReport\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState } from 'preact/hooks';\n\n// Parent category structure\ninterface ParentCategory {\n    id: number;\n    name: string;\n}\n\n// Unit data structure\ninterface UnitData {\n    average: number | null;\n    completionRate: string;\n}\n\n// Category row data structure\ninterface CategoryData {\n    id: number;\n    name: string;\n    parentId: number;\n    participants: number;\n    units: UnitData[];\n}\n\n// Dummy parent categories\nconst parentCategories: ParentCategory[] = [\n    { id: 0, name: 'All Categories' },\n    { id: 1, name: 'Kigali City' },\n    { id: 2, name: 'Eastern Province' },\n    { id: 3, name: 'Western Province' },\n    { id: 4, name: 'Northern Province' },\n    { id: 5, name: 'Southern Province' },\n];\n\n// Dummy data matching the image structure\nconst dummyData: CategoryData[] = [\n    {\n        id: 1,\n        name: 'Bicumbi',\n        parentId: 2,\n        participants: 47,\n        units: [\n            { average: 9.2, completionRate: '95.7%' },\n            { average: 3.67, completionRate: '4.3%' },\n            { average: 2.82, completionRate: '4.3%' },\n            { average: 5, completionRate: '2.1%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 2,\n        name: 'Cyahinda',\n        parentId: 5,\n        participants: 101,\n        units: [\n            { average: 8.8, completionRate: '55.4%' },\n            { average: 7.52, completionRate: '10.9%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 9.31, completionRate: '12.9%' },\n            { average: 7.81, completionRate: '5.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 6.52, completionRate: '4.0%' },\n            { average: 9.02, completionRate: '6.9%' },\n        ],\n    },\n    {\n        id: 3,\n        name: 'De La Salle Byumba',\n        parentId: 4,\n        participants: 90,\n        units: [\n            { average: 6.7, completionRate: '93.3%' },\n            { average: 6.23, completionRate: '62.2%' },\n            { average: 5.3, completionRate: '25.6%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 5.88, completionRate: '1.1%' },\n            { average: 2.14, completionRate: '1.1%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 4,\n        name: 'Gacuba II',\n        parentId: 3,\n        participants: 86,\n        units: [\n            { average: 6.6, completionRate: '84.9%' },\n            { average: 7.32, completionRate: '43.0%' },\n            { average: 0, completionRate: '1.2%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 5,\n        name: 'Kabarore',\n        parentId: 4,\n        participants: 93,\n        units: [\n            { average: 9.4, completionRate: '96.8%' },\n            { average: 5.82, completionRate: '11.8%' },\n            { average: 8.75, completionRate: '1.1%' },\n            { average: 9.09, completionRate: '1.1%' },\n            { average: 0.38, completionRate: '1.1%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 6.43, completionRate: '1.1%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 6,\n        name: 'Kirambo',\n        parentId: 3,\n        participants: 97,\n        units: [\n            { average: 5.3, completionRate: '3.1%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 3.75, completionRate: '1.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 7,\n        name: 'Matimba',\n        parentId: 2,\n        participants: 44,\n        units: [\n            { average: 9.3, completionRate: '93.2%' },\n            { average: 4.25, completionRate: '18.2%' },\n            { average: 4.38, completionRate: '6.8%' },\n            { average: 5, completionRate: '2.3%' },\n            { average: 10, completionRate: '2.3%' },\n            { average: 7.65, completionRate: '2.3%' },\n            { average: 7.14, completionRate: '2.3%' },\n            { average: 8.75, completionRate: '2.3%' },\n        ],\n    },\n    {\n        id: 8,\n        name: 'Mbuga',\n        parentId: 1,\n        participants: 93,\n        units: [\n            { average: 8.5, completionRate: '92.5%' },\n            { average: 3.33, completionRate: '2.2%' },\n            { average: 10, completionRate: '1.1%' },\n            { average: 9.55, completionRate: '1.1%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 9,\n        name: 'Muhanga',\n        parentId: 5,\n        participants: 50,\n        units: [\n            { average: 7.3, completionRate: '88.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 10,\n        name: 'Muramba',\n        parentId: 3,\n        participants: 31,\n        units: [\n            { average: 9.7, completionRate: '100.0%' },\n            { average: 9.29, completionRate: '93.5%' },\n            { average: 7.82, completionRate: '6.5%' },\n            { average: 7.28, completionRate: '6.5%' },\n            { average: 8.75, completionRate: '6.5%' },\n            { average: 7.84, completionRate: '9.7%' },\n            { average: 7.68, completionRate: '6.5%' },\n            { average: 7.71, completionRate: '9.7%' },\n        ],\n    },\n    {\n        id: 11,\n        name: 'Mururu',\n        parentId: 3,\n        participants: 63,\n        units: [\n            { average: 9.3, completionRate: '92.1%' },\n            { average: 3.33, completionRate: '1.6%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 7.12, completionRate: '4.8%' },\n            { average: 9.62, completionRate: '3.2%' },\n            { average: 8.82, completionRate: '4.8%' },\n            { average: 4.47, completionRate: '3.2%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 12,\n        name: 'Mwezi',\n        parentId: 4,\n        participants: 58,\n        units: [\n            { average: 9.9, completionRate: '100.0%' },\n            { average: 9, completionRate: '89.7%' },\n            { average: 0, completionRate: '1.7%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 1.25, completionRate: '1.7%' },\n        ],\n    },\n    {\n        id: 13,\n        name: 'Nyamata',\n        parentId: 2,\n        participants: 89,\n        units: [\n            { average: 7.7, completionRate: '10.1%' },\n            { average: 1.78, completionRate: '3.4%' },\n            { average: 8.78, completionRate: '53.9%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 14,\n        name: 'Rubengera',\n        parentId: 3,\n        participants: 51,\n        units: [\n            { average: 6.4, completionRate: '100.0%' },\n            { average: 6.11, completionRate: '98.0%' },\n            { average: 3.44, completionRate: '3.9%' },\n            { average: 5.15, completionRate: '2.0%' },\n            { average: 3.27, completionRate: '2.0%' },\n            { average: 2.94, completionRate: '2.0%' },\n            { average: 3.93, completionRate: '2.0%' },\n            { average: 1.88, completionRate: '2.0%' },\n        ],\n    },\n    {\n        id: 15,\n        name: 'Save',\n        parentId: 5,\n        participants: 90,\n        units: [\n            { average: 8.1, completionRate: '94.4%' },\n            { average: 5.84, completionRate: '18.9%' },\n            { average: 3.75, completionRate: '1.1%' },\n            { average: 4.09, completionRate: '1.1%' },\n            { average: 3.65, completionRate: '1.1%' },\n            { average: 5.88, completionRate: '2.2%' },\n            { average: 6.31, completionRate: '3.3%' },\n            { average: 6.88, completionRate: '1.1%' },\n        ],\n    },\n    {\n        id: 16,\n        name: 'Zaza',\n        parentId: 2,\n        participants: 114,\n        units: [\n            { average: 8.4, completionRate: '91.2%' },\n            { average: 5.13, completionRate: '20.2%' },\n            { average: 4.38, completionRate: '0.9%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n];\n\n// Grand total row\nconst grandTotal = {\n    name: 'Grand total',\n    participants: 1197,\n    units: [\n        { average: 8.3, completionRate: '76.7%' },\n        { average: 6.9, completionRate: '25.2%' },\n        { average: 7.07, completionRate: '7.3%' },\n        { average: 8.12, completionRate: '2.0%' },\n        { average: 7.16, completionRate: '1.1%' },\n        { average: 7.11, completionRate: '0.9%' },\n        { average: 5.93, completionRate: '1.3%' },\n        { average: 7.5, completionRate: '1.2%' },\n    ],\n};\n\nconst unitLabels = ['U1', 'U2', 'U3', 'U4', 'U5', 'U6', 'U7', 'U8'];\n\nexport default function CompletionReport() {\n    const [selectedParentId, setSelectedParentId] = useState(0);\n\n    // Filter data based on selected parent category\n    const filteredData = selectedParentId === 0\n        ? dummyData\n        : dummyData.filter(row => row.parentId === selectedParentId);\n\n    // Calculate grand total for filtered data\n    const calculateGrandTotal = () => {\n        if (filteredData.length === 0) {\n            return grandTotal;\n        }\n\n        const totalParticipants = filteredData.reduce((sum, row) => sum + row.participants, 0);\n\n        // Calculate average for each unit\n        const unitTotals = unitLabels.map((_, unitIndex) => {\n            const validRows = filteredData.filter(row => row.units[unitIndex].average !== null);\n            if (validRows.length === 0) {\n                return { average: null, completionRate: '0.0%' };\n            }\n\n            const avgSum = validRows.reduce((sum, row) => sum + (row.units[unitIndex].average || 0), 0);\n            const crSum = filteredData.reduce((sum, row) => {\n                const cr = parseFloat(row.units[unitIndex].completionRate);\n                return sum + (isNaN(cr) ? 0 : cr);\n            }, 0);\n\n            return {\n                average: Math.round((avgSum / validRows.length) * 100) / 100,\n                completionRate: `${(crSum / filteredData.length).toFixed(1)}%`,\n            };\n        });\n\n        return {\n            name: 'Grand total',\n            participants: totalParticipants,\n            units: unitTotals,\n        };\n    };\n\n    const currentGrandTotal = selectedParentId === 0 ? grandTotal : calculateGrandTotal();\n\n    return (\n        <div className=\"p-2 sm:p-4 lg:p-6 bg-white min-h-screen\">\n            {/* Page Header */}\n            <div className=\"mb-6\">\n                <h1 className=\"text-2xl font-bold text-gray-800\">Overview</h1>\n            </div>\n\n            {/* Category Filter */}\n            <div className=\"mb-4\">\n                <label htmlFor=\"parent-category\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Parent Category\n                </label>\n                <select\n                    id=\"parent-category\"\n                    value={selectedParentId}\n                    onChange={(e) => setSelectedParentId(Number((e.target as HTMLSelectElement).value))}\n                    className=\"border border-gray-300 rounded-lg px-3 py-2 min-w-[200px] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                    {parentCategories.map((cat) => (\n                        <option key={cat.id} value={cat.id}>\n                            {cat.name}\n                        </option>\n                    ))}\n                </select>\n            </div>\n\n            {/* Table */}\n            <div className=\"overflow-x-auto\">\n                <table className=\"w-full text-sm\">\n                    <thead>\n                        <tr className=\"border-b border-gray-200\">\n                            <th className=\"py-3 px-2 text-left font-medium text-gray-600 w-8\"></th>\n                            <th className=\"py-3 px-2 text-left font-medium text-gray-600 min-w-[140px]\">\n                                Category <span className=\"text-gray-400\"></span>\n                            </th>\n                            <th className=\"py-3 px-2 text-center font-medium text-gray-600\"># of Stds</th>\n                            {unitLabels.map((unit) => (\n                                <>\n                                    <th key={`${unit}-ave`} className=\"py-3 px-2 text-center font-medium text-gray-600\">\n                                        {unit} Ave.\n                                    </th>\n                                    <th key={`${unit}-cr`} className=\"py-3 px-2 text-center font-medium text-gray-600\">\n                                        {unit} CR\n                                    </th>\n                                </>\n                            ))}\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {filteredData.map((row, index) => (\n                            <tr\n                                key={row.id}\n                                className={index % 2 === 0 ? 'bg-sky-50' : 'bg-white'}\n                            >\n                                <td className=\"py-2 px-2 text-gray-500\">{index + 1}.</td>\n                                <td className=\"py-2 px-2 text-gray-800\">{row.name}</td>\n                                <td className=\"py-2 px-2 text-center text-gray-600\">{row.participants}</td>\n                                {row.units.map((unit, unitIndex) => (\n                                    <>\n                                        <td key={`ave-${unitIndex}`} className=\"py-2 px-2 text-center text-gray-600\">\n                                            {unit.average !== null ? unit.average : '-'}\n                                        </td>\n                                        <td key={`cr-${unitIndex}`} className=\"py-2 px-2 text-center text-gray-600\">\n                                            {unit.completionRate}\n                                        </td>\n                                    </>\n                                ))}\n                            </tr>\n                        ))}\n                        {/* Grand Total Row */}\n                        <tr className=\"bg-white border-t border-gray-300\">\n                            <td className=\"py-2 px-2\"></td>\n                            <td className=\"py-2 px-2 font-semibold text-gray-800\">{currentGrandTotal.name}</td>\n                            <td className=\"py-2 px-2 text-center font-semibold text-gray-800\">\n                                {currentGrandTotal.participants >= 1000\n                                    ? `${(currentGrandTotal.participants / 1000).toFixed(1)}K`\n                                    : currentGrandTotal.participants}\n                            </td>\n                            {currentGrandTotal.units.map((unit, unitIndex) => (\n                                <>\n                                    <td key={`total-ave-${unitIndex}`} className=\"py-2 px-2 text-center font-semibold text-gray-800\">\n                                        {unit.average !== null ? unit.average : '-'}\n                                    </td>\n                                    <td key={`total-cr-${unitIndex}`} className=\"py-2 px-2 text-center font-semibold text-gray-800\">\n                                        {unit.completionRate}\n                                    </td>\n                                </>\n                            ))}\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n\n            {filteredData.length === 0 && (\n                <div className=\"text-center py-8 text-gray-500\">\n                    No categories found for the selected parent category.\n                </div>\n            )}\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Courses Report component for Elby Dashboard.\n *\n * @module     local_elby_dashboard/components/CoursesReport\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect, useRef, useMemo } from 'preact/hooks';\nimport type { CoursesReportData, ThemeConfig, CourseReport, SchoolReport, CategoryNode, CourseListItem } from '../types';\n\n// Sort configuration type\ntype SortColumn = 'school' | 'students' | `avg-${number}` | `cr-${number}`;\ntype SortDirection = 'asc' | 'desc';\n\ninterface CoursesReportProps {\n    data: CoursesReportData;\n    themeConfig: ThemeConfig;\n}\n\n// Tree Course Select Component\ninterface TreeCourseSelectProps {\n    tree: CategoryNode[];\n    selectedId: number | null;\n    placeholder: string;\n    onSelect: (id: number) => void;\n}\n\n// Check if a node or any of its descendants match the search\nfunction nodeMatchesSearch(node: CategoryNode, query: string): boolean {\n    const lowerQuery = query.toLowerCase();\n    // Check if any direct courses match\n    const hasMatchingCourse = node.courses.some(course =>\n        course.id.toString().includes(query) ||\n        course.fullname.toLowerCase().includes(lowerQuery) ||\n        course.shortname.toLowerCase().includes(lowerQuery)\n    );\n    if (hasMatchingCourse) return true;\n    // Check children recursively\n    return node.children.some(child => nodeMatchesSearch(child, query));\n}\n\n// Recursive tree node component\nfunction TreeNode({\n    node,\n    depth,\n    expandedNodes,\n    onToggle,\n    selectedId,\n    onSelect,\n    searchQuery\n}: {\n    node: CategoryNode;\n    depth: number;\n    expandedNodes: Set<string>;\n    onToggle: (key: string) => void;\n    selectedId: number | null;\n    onSelect: (id: number) => void;\n    searchQuery: string;\n}) {\n    const nodeKey = `cat-${node.id}`;\n    const isExpanded = expandedNodes.has(nodeKey);\n    const hasChildren = node.children.length > 0;\n    const hasCourses = node.courses.length > 0;\n    const paddingLeft = depth * 16 + 12;\n\n    // Filter courses based on search\n    const lowerQuery = searchQuery.toLowerCase();\n    const matchingCourses = searchQuery\n        ? node.courses.filter(course =>\n            course.id.toString().includes(searchQuery) ||\n            course.fullname.toLowerCase().includes(lowerQuery) ||\n            course.shortname.toLowerCase().includes(lowerQuery)\n        )\n        : node.courses;\n\n    // Check if any descendant matches search\n    const hasMatchingDescendants = searchQuery\n        ? node.children.some(child => nodeMatchesSearch(child, searchQuery))\n        : true;\n\n    // Hide non-matching branches when searching\n    if (searchQuery && matchingCourses.length === 0 && !hasMatchingDescendants) {\n        return null;\n    }\n\n    return (\n        <div>\n            {/* Category row */}\n            <button\n                type=\"button\"\n                onClick={() => onToggle(nodeKey)}\n                className=\"w-full py-2 text-left text-sm font-medium text-gray-700 hover:bg-gray-100 flex items-center\"\n                style={{ paddingLeft }}\n            >\n                <span className=\"w-4 mr-1 text-gray-400 shrink-0\">\n                    {(hasChildren || hasCourses) && (isExpanded ? '' : '')}\n                </span>\n                <span className=\"truncate\">{node.name}</span>\n            </button>\n\n            {/* Children and courses */}\n            {isExpanded && (\n                <>\n                    {node.children.map(child => (\n                        <TreeNode\n                            key={child.id}\n                            node={child}\n                            depth={depth + 1}\n                            expandedNodes={expandedNodes}\n                            onToggle={onToggle}\n                            selectedId={selectedId}\n                            onSelect={onSelect}\n                            searchQuery={searchQuery}\n                        />\n                    ))}\n                    {matchingCourses.map(course => (\n                        <button\n                            key={course.id}\n                            type=\"button\"\n                            onClick={() => onSelect(course.id)}\n                            className={`w-full py-2 text-left text-sm hover:bg-blue-50 flex items-center justify-between pr-3 ${\n                                Number(course.id) === Number(selectedId) ? 'bg-blue-50 text-blue-700' : 'text-gray-600'\n                            }`}\n                            style={{ paddingLeft: (depth + 1) * 16 + 12 }}\n                        >\n                            <div className=\"flex items-center gap-1 truncate\">\n                                <span className=\"text-gray-400 shrink-0\">[{course.id}]</span>\n                                <span className=\"truncate\">{course.fullname}</span>\n                            </div>\n                            <span className=\"text-xs text-gray-400 ml-2 shrink-0\">\n                                {course.enrolled_count} enrolled\n                            </span>\n                        </button>\n                    ))}\n                </>\n            )}\n        </div>\n    );\n}\n\n// Find course by traversing tree\nfunction findCourseInTree(nodes: CategoryNode[], courseId: number | null): CourseListItem | undefined {\n    if (!courseId) return undefined;\n    // Use == for comparison to handle string/number type mismatches from JSON\n    const targetId = Number(courseId);\n    for (const node of nodes) {\n        const found = node.courses.find(c => Number(c.id) === targetId);\n        if (found) return found;\n        const inChildren = findCourseInTree(node.children, courseId);\n        if (inChildren) return inChildren;\n    }\n    return undefined;\n}\n\n// Collect all node keys from tree\nfunction collectAllNodeKeys(nodes: CategoryNode[]): Set<string> {\n    const keys = new Set<string>();\n    const collect = (nodeList: CategoryNode[]) => {\n        for (const n of nodeList) {\n            keys.add(`cat-${n.id}`);\n            collect(n.children);\n        }\n    };\n    collect(nodes);\n    return keys;\n}\n\nfunction TreeCourseSelect({ tree, selectedId, placeholder, onSelect }: TreeCourseSelectProps) {\n    const [isOpen, setIsOpen] = useState(false);\n    const [searchQuery, setSearchQuery] = useState('');\n    const [expandedNodes, setExpandedNodes] = useState<Set<string>>(new Set());\n    const containerRef = useRef<HTMLDivElement>(null);\n    const searchInputRef = useRef<HTMLInputElement>(null);\n\n    const selectedCourse = findCourseInTree(tree, selectedId);\n\n    const toggleNode = (key: string) => {\n        const newExpanded = new Set(expandedNodes);\n        if (newExpanded.has(key)) {\n            newExpanded.delete(key);\n        } else {\n            newExpanded.add(key);\n        }\n        setExpandedNodes(newExpanded);\n    };\n\n    // Handle click outside to close dropdown\n    useEffect(() => {\n        const handleClickOutside = (event: MouseEvent) => {\n            if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\n                setIsOpen(false);\n                setSearchQuery('');\n            }\n        };\n\n        document.addEventListener('mousedown', handleClickOutside);\n        return () => document.removeEventListener('mousedown', handleClickOutside);\n    }, []);\n\n    // Focus search input when dropdown opens\n    useEffect(() => {\n        if (isOpen && searchInputRef.current) {\n            searchInputRef.current.focus();\n        }\n    }, [isOpen]);\n\n    // Auto-expand all when searching\n    useEffect(() => {\n        if (searchQuery) {\n            setExpandedNodes(collectAllNodeKeys(tree));\n        }\n    }, [searchQuery, tree]);\n\n    const handleSelect = (id: number) => {\n        onSelect(id);\n        setIsOpen(false);\n        setSearchQuery('');\n    };\n\n    return (\n        <div ref={containerRef} className=\"relative w-full max-w-md\">\n            {/* Trigger Button */}\n            <button\n                type=\"button\"\n                onClick={() => setIsOpen(!isOpen)}\n                className=\"w-full px-4 py-2.5 text-left bg-white border border-gray-300 rounded-lg flex items-center justify-between hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            >\n                <span className={selectedCourse ? 'text-gray-900' : 'text-gray-500'}>\n                    {selectedCourse ? `[${selectedCourse.id}] ${selectedCourse.fullname}` : placeholder}\n                </span>\n                <svg\n                    className={`w-5 h-5 text-gray-400 transition-transform ${isOpen ? 'rotate-180' : ''}`}\n                    viewBox=\"0 0 20 20\"\n                    fill=\"currentColor\"\n                >\n                    <path fillRule=\"evenodd\" d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                </svg>\n            </button>\n\n            {/* Dropdown */}\n            {isOpen && (\n                <div className=\"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg\">\n                    {/* Search Input */}\n                    <div className=\"p-2 border-b border-gray-100\">\n                        <div className=\"flex items-center gap-2 px-3 py-2 border border-gray-200 rounded-md focus-within:ring-1 focus-within:ring-blue-500 focus-within:border-blue-500\">\n                            <svg\n                                className=\"w-4 h-4 text-gray-400 shrink-0\"\n                                viewBox=\"0 0 20 20\"\n                                fill=\"currentColor\"\n                            >\n                                <path fillRule=\"evenodd\" d=\"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z\" clipRule=\"evenodd\" />\n                            </svg>\n                            <input\n                                ref={searchInputRef}\n                                type=\"text\"\n                                placeholder=\"Search course...\"\n                                value={searchQuery}\n                                onInput={(e) => setSearchQuery((e.target as HTMLInputElement).value)}\n                                className=\"w-full text-sm bg-transparent border-none outline-none focus:outline-none focus:ring-0\"\n                            />\n                        </div>\n                    </div>\n\n                    {/* Tree Options List */}\n                    <div className=\"max-h-80 overflow-y-auto\">\n                        {tree.length > 0 ? (\n                            tree.map(node => (\n                                <TreeNode\n                                    key={node.id}\n                                    node={node}\n                                    depth={0}\n                                    expandedNodes={expandedNodes}\n                                    onToggle={toggleNode}\n                                    selectedId={selectedId}\n                                    onSelect={handleSelect}\n                                    searchQuery={searchQuery}\n                                />\n                            ))\n                        ) : (\n                            <div className=\"px-4 py-3 text-sm text-gray-500 text-center\">\n                                No courses found\n                            </div>\n                        )}\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n\n// Year Select Component\ninterface YearSelectProps {\n    years: { value: number; label: string }[];\n    selectedYear: number;\n    onSelect: (year: number) => void;\n}\n\nfunction YearSelect({ years, selectedYear, onSelect }: YearSelectProps) {\n    return (\n        <select\n            value={selectedYear}\n            onChange={(e) => onSelect(parseInt((e.target as HTMLSelectElement).value))}\n            className=\"px-4 py-2.5 bg-white border border-gray-300 rounded-lg text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n        >\n            {years.map(year => (\n                <option key={year.value} value={year.value}>\n                    {year.label}\n                </option>\n            ))}\n        </select>\n    );\n}\n\n// Color palette for donut charts (orange, green, blue, purple, teal)\nconst DONUT_COLORS = ['#F5A623', '#4CAF50', '#2196F3', '#9C27B0', '#00BCD4'];\n\n// Donut Chart Component for completion rate\nfunction CompletionDonut({ rate, label, colorIndex = 0 }: { rate: number; label: string; color?: string; colorIndex?: number }) {\n    const size = 120;\n    const strokeWidth = 10;\n    const radius = (size - strokeWidth) / 2;\n    const circumference = 2 * Math.PI * radius;\n    // Calculate the length of the progress arc\n    const progressLength = (rate / 100) * circumference;\n    const progressColor = DONUT_COLORS[colorIndex % DONUT_COLORS.length];\n    const center = size / 2;\n\n    return (\n        <div className=\"flex flex-col items-center\">\n            <div className=\"relative\" style={{ width: size, height: size }}>\n                <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`}>\n                    {/* Background circle - gray track (always visible) */}\n                    <circle\n                        cx={center}\n                        cy={center}\n                        r={radius}\n                        fill=\"none\"\n                        stroke=\"#e5e5e5\"\n                        stroke-width={strokeWidth}\n                    />\n                    {/* Progress circle - colored arc starting from top */}\n                    {rate > 0 && (\n                        <circle\n                            cx={center}\n                            cy={center}\n                            r={radius}\n                            fill=\"none\"\n                            stroke={progressColor}\n                            stroke-width={strokeWidth}\n                            stroke-linecap=\"round\"\n                            stroke-dasharray={`${progressLength} ${circumference - progressLength}`}\n                            transform={`rotate(-90 ${center} ${center})`}\n                        />\n                    )}\n                </svg>\n                <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <span className=\"text-2xl font-normal text-gray-500\">{rate.toFixed(0)}%</span>\n                </div>\n            </div>\n            <span className=\"text-xs text-gray-600 mt-2 text-center font-medium max-w-[140px]\">{label}</span>\n        </div>\n    );\n}\n\n// Truncate text with ellipsis\nfunction truncateText(text: string, maxLength: number): string {\n    if (text.length <= maxLength) return text;\n    return text.substring(0, maxLength - 1) + '';\n}\n\n// Bar Chart for completion rate and average score per school\nfunction SchoolBarChart({ schools, sectionIndex, themeConfig }: {\n    schools: SchoolReport[];\n    sectionIndex: number;\n    themeConfig: ThemeConfig;\n}) {\n    // Get grademax from first school's section data for percentage conversion\n    const grademax = schools[0]?.sections[sectionIndex]?.grademax || 100;\n\n    return (\n        <div className=\"bg-white rounded-xl p-6 shadow-sm overflow-visible\">\n            <div className=\"flex items-center gap-4 mb-6\">\n                <div className=\"flex items-center gap-2\">\n                    <span className=\"w-3 h-3 rounded-full\" style={{ backgroundColor: themeConfig.chartPrimaryColor }}></span>\n                    <span className=\"text-sm text-gray-600\">Average Score</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                    <span className=\"w-3 h-3 rounded-full\" style={{ backgroundColor: themeConfig.chartSecondaryColor }}></span>\n                    <span className=\"text-sm text-gray-600\">Completion Rate</span>\n                </div>\n            </div>\n            <div className=\"flex\">\n                {/* Left Y-axis for Average Score */}\n                <div className=\"flex flex-col justify-between h-48 pr-2 text-xs text-gray-500 shrink-0\">\n                    <span>{grademax}</span>\n                    <span>{(grademax * 0.75).toFixed(grademax >= 10 ? 0 : 1)}</span>\n                    <span>{(grademax * 0.5).toFixed(grademax >= 10 ? 0 : 1)}</span>\n                    <span>{(grademax * 0.25).toFixed(grademax >= 10 ? 0 : 1)}</span>\n                    <span>0</span>\n                </div>\n                {/* Chart bars */}\n                <div className=\"flex-1 overflow-x-auto\">\n                    <div className=\"flex items-end gap-8\">\n                        {schools.slice(0, 15).map((school, idx) => {\n                            const section = school.sections[sectionIndex];\n                            const avgValue = section?.average_grade || 0;\n                            const sectionGrademax = section?.grademax || grademax;\n                            // Convert raw score to percentage for bar height\n                            const avgHeight = sectionGrademax > 0 ? (avgValue / sectionGrademax) * 100 : 0;\n                            const crHeight = section ? section.completion_rate : 0;\n                            const fullName = String(school.school_name || '-');\n                            const displayName = truncateText(fullName, 20);\n\n                            return (\n                                <div key={school.school_code || `school-${idx}`} className=\"flex flex-col items-center min-w-[50px]\">\n                                    <div className=\"flex gap-1 items-end h-48\">\n                                        <div\n                                            className=\"w-5 rounded-t-sm cursor-pointer\"\n                                            style={{\n                                                height: `${avgHeight}%`,\n                                                backgroundColor: themeConfig.chartPrimaryColor,\n                                            }}\n                                            title={`${fullName}\\nAvg: ${avgValue.toFixed(1)}/${sectionGrademax}`}\n                                        />\n                                        <div\n                                            className=\"w-5 rounded-t-sm cursor-pointer\"\n                                            style={{\n                                                height: `${crHeight}%`,\n                                                backgroundColor: themeConfig.chartSecondaryColor,\n                                            }}\n                                            title={`${fullName}\\nCR: ${crHeight.toFixed(1)}%`}\n                                        />\n                                    </div>\n                                    <div className=\"h-32 flex items-start justify-center mt-2\">\n                                        <span\n                                            className=\"text-[11px] text-gray-600 whitespace-nowrap cursor-default origin-top\"\n                                            style={{ transform: 'rotate(45deg)' }}\n                                            title={fullName}\n                                        >\n                                            {displayName}\n                                        </span>\n                                    </div>\n                                </div>\n                            );\n                        })}\n                    </div>\n                </div>\n                {/* Right Y-axis for Completion Rate */}\n                <div className=\"flex flex-col justify-between h-48 pl-2 text-xs text-gray-500 shrink-0\">\n                    <span>100%</span>\n                    <span>75%</span>\n                    <span>50%</span>\n                    <span>25%</span>\n                    <span>0%</span>\n                </div>\n            </div>\n        </div>\n    );\n}\n\n// Scatter Plot for Completion Rate vs Average Score\nfunction ScatterPlot({ schools, sectionIndex, themeConfig }: {\n    schools: SchoolReport[];\n    sectionIndex: number;\n    themeConfig: ThemeConfig;\n}) {\n    return (\n        <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n            <p className=\"text-xs text-gray-400 mb-3 italic\">Hover over points to see school names</p>\n            <div className=\"relative h-64 border-l border-b border-gray-200 ml-8\">\n                {/* Y-axis label */}\n                <div className=\"absolute -left-6 top-1/2 -rotate-90 text-xs text-gray-500 whitespace-nowrap\">Avg Score</div>\n                {/* X-axis label */}\n                <div className=\"absolute bottom-[-24px] left-1/2 -translate-x-1/2 text-xs text-gray-500\">Completion Rate</div>\n\n                {/* Y-axis values */}\n                {[0, 25, 50, 75, 100].map(pct => (\n                    <div key={`y-${pct}`} className=\"absolute text-[10px] text-gray-400\" style={{ bottom: `${pct}%`, left: '-20px', transform: 'translateY(50%)' }}>\n                        {pct}\n                    </div>\n                ))}\n\n                {/* Grid lines */}\n                {[0, 25, 50, 75, 100].map(pct => (\n                    <div\n                        key={pct}\n                        className=\"absolute w-full border-t border-dashed border-gray-100\"\n                        style={{ bottom: `${pct}%` }}\n                    />\n                ))}\n\n                {/* Vertical grid lines */}\n                {[0, 25, 50, 75, 100].map(pct => (\n                    <div\n                        key={`v-${pct}`}\n                        className=\"absolute h-full border-l border-dashed border-gray-100\"\n                        style={{ left: `${pct}%` }}\n                    />\n                ))}\n\n                {/* Data points - hover shows school name */}\n                {schools.map((school, idx) => {\n                    const section = school.sections[sectionIndex];\n                    if (!section) return null;\n\n                    const x = section.completion_rate;\n                    const y = section.average_grade || 0;\n                    const fullName = String(school.school_name || 'Unknown');\n\n                    return (\n                        <div\n                            key={school.school_code || `scatter-${idx}`}\n                            className=\"absolute w-3 h-3 rounded-full cursor-pointer transform -translate-x-1/2 translate-y-1/2 hover:scale-150 hover:z-10 transition-transform\"\n                            style={{\n                                left: `${x}%`,\n                                bottom: `${y}%`,\n                                backgroundColor: themeConfig.chartPrimaryColor,\n                            }}\n                            title={`${fullName}\\nCompletion: ${x.toFixed(1)}%\\nAvg Score: ${y.toFixed(1)}%`}\n                        />\n                    );\n                })}\n            </div>\n            {/* X-axis labels */}\n            <div className=\"flex justify-between text-xs text-gray-400 mt-3 ml-8\">\n                <span>0%</span>\n                <span>25%</span>\n                <span>50%</span>\n                <span>75%</span>\n                <span>100%</span>\n            </div>\n        </div>\n    );\n}\n\n// Sort indicator component\nfunction SortIndicator({ column, sortColumn, sortDirection }: {\n    column: SortColumn;\n    sortColumn: SortColumn | null;\n    sortDirection: SortDirection;\n}) {\n    const isActive = sortColumn === column;\n    return (\n        <span className={`ml-1 inline-flex ${isActive ? 'text-blue-600' : 'text-gray-400'}`}>\n            {isActive && sortDirection === 'asc' ? '' : isActive && sortDirection === 'desc' ? '' : ''}\n        </span>\n    );\n}\n\n// Sortable header component\nfunction SortableHeader({ children, column, sortColumn, sortDirection, onSort, className }: {\n    children: React.ReactNode;\n    column: SortColumn;\n    sortColumn: SortColumn | null;\n    sortDirection: SortDirection;\n    onSort: (column: SortColumn) => void;\n    className?: string;\n}) {\n    return (\n        <th\n            className={`${className} cursor-pointer hover:bg-gray-100 select-none`}\n            onClick={() => onSort(column)}\n        >\n            <div className=\"flex items-center justify-center\">\n                {children}\n                <SortIndicator column={column} sortColumn={sortColumn} sortDirection={sortDirection} />\n            </div>\n        </th>\n    );\n}\n\n// Report Table Component\nfunction ReportTable({ report, themeConfig }: { report: CourseReport; themeConfig: ThemeConfig }) {\n    const [sortColumn, setSortColumn] = useState<SortColumn | null>(null);\n    const [sortDirection, setSortDirection] = useState<SortDirection>('desc');\n\n    const handleSort = (column: SortColumn) => {\n        if (sortColumn === column) {\n            setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n        } else {\n            setSortColumn(column);\n            setSortDirection('desc');\n        }\n    };\n\n    const sortedSchools = useMemo(() => {\n        if (!sortColumn) return report.schools;\n\n        return [...report.schools].sort((a, b) => {\n            let aVal: number | string = 0;\n            let bVal: number | string = 0;\n\n            if (sortColumn === 'school') {\n                aVal = a.school_name || '';\n                bVal = b.school_name || '';\n                return sortDirection === 'asc'\n                    ? String(aVal).localeCompare(String(bVal))\n                    : String(bVal).localeCompare(String(aVal));\n            } else if (sortColumn === 'students') {\n                aVal = a.student_count;\n                bVal = b.student_count;\n            } else if (sortColumn.startsWith('avg-')) {\n                const idx = parseInt(sortColumn.replace('avg-', ''));\n                aVal = a.sections[idx]?.average_grade || 0;\n                bVal = b.sections[idx]?.average_grade || 0;\n            } else if (sortColumn.startsWith('cr-')) {\n                const idx = parseInt(sortColumn.replace('cr-', ''));\n                aVal = a.sections[idx]?.completion_rate || 0;\n                bVal = b.sections[idx]?.completion_rate || 0;\n            }\n\n            return sortDirection === 'asc'\n                ? (aVal as number) - (bVal as number)\n                : (bVal as number) - (aVal as number);\n        });\n    }, [report.schools, sortColumn, sortDirection]);\n\n    return (\n        <div className=\"bg-white rounded-xl shadow-sm overflow-hidden\">\n            {/* Legend */}\n            <div className=\"px-4 py-3 border-b border-gray-100 bg-gray-50\">\n                <span className=\"text-sm text-gray-600\">\n                    <span className=\"font-medium\">Legend:</span> U = Unit, Avg = Average score, CR = Completion rate\n                    <span className=\"ml-4 text-gray-400\">(Click column headers to sort)</span>\n                </span>\n            </div>\n            <div className=\"overflow-auto max-h-[600px]\">\n                <table className=\"w-full text-sm\">\n                    <thead className=\"sticky top-0 z-20\">\n                        <tr className=\"bg-gray-50\">\n                            <th className=\"px-3 py-2 text-left text-xs font-semibold text-gray-600 sticky left-0 z-30 bg-gray-50\">#</th>\n                            <SortableHeader\n                                column=\"school\"\n                                sortColumn={sortColumn}\n                                sortDirection={sortDirection}\n                                onSort={handleSort}\n                                className=\"px-3 py-2 text-left text-xs font-semibold text-gray-600 sticky left-8 z-30 bg-gray-50 min-w-[200px]\"\n                            >\n                                School\n                            </SortableHeader>\n                            <SortableHeader\n                                column=\"students\"\n                                sortColumn={sortColumn}\n                                sortDirection={sortDirection}\n                                onSort={handleSort}\n                                className=\"px-3 py-2 text-center text-xs font-semibold text-gray-600 sticky left-[232px] z-30 bg-gray-50\"\n                            >\n                                Enrolled students\n                            </SortableHeader>\n                            {report.overview_sections.map((section, idx) => (\n                                <>\n                                    <SortableHeader\n                                        key={`avg-${idx}`}\n                                        column={`avg-${idx}` as SortColumn}\n                                        sortColumn={sortColumn}\n                                        sortDirection={sortDirection}\n                                        onSort={handleSort}\n                                        className=\"px-2 py-2 text-center text-xs font-semibold text-gray-600 bg-gray-50\"\n                                    >\n                                        U{section.section_number} Avg\n                                    </SortableHeader>\n                                    <SortableHeader\n                                        key={`cr-${idx}`}\n                                        column={`cr-${idx}` as SortColumn}\n                                        sortColumn={sortColumn}\n                                        sortDirection={sortDirection}\n                                        onSort={handleSort}\n                                        className=\"px-2 py-2 text-center text-xs font-semibold text-gray-600 bg-gray-50\"\n                                    >\n                                        U{section.section_number} CR\n                                    </SortableHeader>\n                                </>\n                            ))}\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {sortedSchools.map((school, idx) => (\n                            <tr key={school.school_code || `row-${idx}`} className=\"border-t border-gray-100 hover:bg-gray-50 group\">\n                                <td className=\"px-3 py-2 text-gray-500 sticky left-0 z-10 bg-white group-hover:bg-gray-50\">{idx + 1}</td>\n                                <td className=\"px-3 py-2 font-medium text-gray-800 sticky left-8 z-10 bg-white group-hover:bg-gray-50 min-w-[200px]\">\n                                    {school.school_name}\n                                </td>\n                                <td className=\"px-3 py-2 text-center text-gray-600 sticky left-[232px] z-10 bg-white group-hover:bg-gray-50\">{school.student_count}</td>\n                                {school.sections.map((section, sIdx) => (\n                                    <>\n                                        <td key={`avg-${sIdx}`} className=\"px-2 py-2 text-center text-gray-600\">\n                                            {section.average_grade\n                                                ? section.grademax\n                                                    ? `${section.average_grade.toFixed(1)}/${section.grademax}`\n                                                    : section.average_grade.toFixed(1)\n                                                : '-'}\n                                        </td>\n                                        <td key={`cr-${sIdx}`} className=\"px-2 py-2 text-center text-gray-600\">\n                                            {section.completion_rate.toFixed(1)}%\n                                        </td>\n                                    </>\n                                ))}\n                            </tr>\n                        ))}\n                    </tbody>\n                    <tfoot className=\"sticky bottom-0 z-20\">\n                        {/* Grand Total Row */}\n                        <tr className=\"border-t-2 border-gray-300 bg-gray-50 font-semibold\">\n                            <td className=\"px-3 py-2 sticky left-0 z-10 bg-gray-50\"></td>\n                            <td className=\"px-3 py-2 sticky left-8 z-10 bg-gray-50 min-w-[200px]\">Grand Total</td>\n                            <td className=\"px-3 py-2 text-center sticky left-[232px] z-10 bg-gray-50\">{report.total_enrolled}</td>\n                            {report.overview_sections.map((section, idx) => {\n                                // Calculate averages\n                                const avgGrades = report.schools\n                                    .map(s => s.sections[idx]?.average_grade)\n                                    .filter(g => g !== undefined && g > 0);\n                                const avgGrade = avgGrades.length > 0\n                                    ? avgGrades.reduce((a, b) => a + b!, 0) / avgGrades.length\n                                    : 0;\n                                // Get grademax from first school's section data\n                                const grademax = report.schools[0]?.sections[idx]?.grademax;\n\n                                return (\n                                    <>\n                                        <td key={`avg-${idx}`} className=\"px-2 py-2 text-center bg-gray-50\">\n                                            {avgGrade > 0\n                                                ? grademax\n                                                    ? `${avgGrade.toFixed(1)}/${grademax}`\n                                                    : avgGrade.toFixed(1)\n                                                : '-'}\n                                        </td>\n                                        <td key={`cr-${idx}`} className=\"px-2 py-2 text-center bg-gray-50\">\n                                            {section.completion_rate.toFixed(1)}%\n                                        </td>\n                                    </>\n                                );\n                            })}\n                        </tr>\n                    </tfoot>\n                </table>\n            </div>\n        </div>\n    );\n}\n\nexport default function CoursesReport({ data, themeConfig }: CoursesReportProps) {\n    const handleCourseSelect = (courseid: number) => {\n        const params = new URLSearchParams();\n        params.set('courseid', String(courseid));\n        if (data.selected_year) {\n            params.set('year', String(data.selected_year));\n        }\n        window.location.href = `/local/elby_dashboard/courses.php?${params.toString()}`;\n    };\n\n    const handleYearSelect = (year: number) => {\n        const params = new URLSearchParams();\n        if (data.selected_courseid) {\n            params.set('courseid', String(data.selected_courseid));\n        }\n        params.set('year', String(year));\n        window.location.href = `/local/elby_dashboard/courses.php?${params.toString()}`;\n    };\n\n    return (\n        <div className=\"p-2 sm:p-4 lg:p-6 bg-gray-50 min-h-screen\">\n            {/* Selectors */}\n            <div className=\"mb-6 space-y-3\">\n                {/* Year Selector */}\n                <div className=\"flex items-center gap-3\">\n                    <label className=\"text-sm font-medium text-gray-700 whitespace-nowrap\">Academic Year</label>\n                    <YearSelect\n                        years={data.available_years}\n                        selectedYear={data.selected_year}\n                        onSelect={handleYearSelect}\n                    />\n                </div>\n\n                {/* Course Selector */}\n                <div className=\"flex items-center gap-3\">\n                    <label className=\"text-sm font-medium text-gray-700 whitespace-nowrap\">Select Course</label>\n                    <div className=\"flex-1 max-w-md\">\n                        <TreeCourseSelect\n                            tree={data.courses_list}\n                            selectedId={data.selected_courseid}\n                            placeholder=\"Select a course...\"\n                            onSelect={handleCourseSelect}\n                        />\n                    </div>\n                </div>\n            </div>\n\n            {data.course_report ? (\n                <>\n                    {/* Report Table */}\n                    <div className=\"mb-6\">\n                        <ReportTable report={data.course_report} themeConfig={themeConfig} />\n                    </div>\n\n                    {/* Overview Section */}\n                    <div className=\"mb-6\">\n                        <h2 className=\"text-lg font-semibold text-gray-800 mb-4\">Overview</h2>\n                        <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                            <div className=\"flex flex-wrap items-start gap-8\">\n                                {/* Enrolled Students */}\n                                <div className=\"flex flex-col items-center\">\n                                    <span className=\"text-3xl font-bold text-gray-800\">\n                                        {data.course_report.total_enrolled}\n                                    </span>\n                                    <span className=\"text-sm text-gray-500\">Enrolled Students</span>\n                                </div>\n\n                                {/* Completion Donuts per Unit */}\n                                {data.course_report.overview_sections.map((section, idx) => (\n                                    <CompletionDonut\n                                        key={section.section_number}\n                                        rate={section.completion_rate}\n                                        label={section.section_name}\n                                        colorIndex={idx}\n                                    />\n                                ))}\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Charts per Unit */}\n                    {data.course_report.overview_sections.map((section, sectionIndex) => (\n                        <div key={section.section_number} className=\"mb-6\">\n                            <h3 className=\"text-md font-semibold text-gray-700 mb-3\">\n                                {section.section_name}\n                            </h3>\n                            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n                                <div>\n                                    <h4 className=\"text-sm text-gray-600 mb-2\">\n                                        Completion rate and Average score for each school\n                                    </h4>\n                                    <SchoolBarChart\n                                        schools={data.course_report.schools}\n                                        sectionIndex={sectionIndex}\n                                        themeConfig={themeConfig}\n                                    />\n                                </div>\n                                <div>\n                                    <h4 className=\"text-sm text-gray-600 mb-2\">\n                                        Completion rate x Average score for each school\n                                    </h4>\n                                    <ScatterPlot\n                                        schools={data.course_report.schools}\n                                        sectionIndex={sectionIndex}\n                                        themeConfig={themeConfig}\n                                    />\n                                </div>\n                            </div>\n                        </div>\n                    ))}\n                </>\n            ) : (\n                <div className=\"bg-white rounded-xl p-8 shadow-sm text-center\">\n                    <svg className=\"w-16 h-16 mx-auto text-gray-300 mb-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                        <path d=\"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z\"/>\n                    </svg>\n                    <p className=\"text-gray-500\">Select a course to view the report</p>\n                </div>\n            )}\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * School directory component for Elby Dashboard.\n *\n * Displays school cards grid with province/district filters, search, and KPIs.\n *\n * @module     local_elby_dashboard/components/SchoolDirectory\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport type { SchoolMetrics } from '../types';\n\n// @ts-ignore - Moodle AMD module\ndeclare const require: (deps: string[], callback: (...args: any[]) => void) => void;\n\ninterface SchoolCardData {\n    school_code: string;\n    school_name: string;\n    region_code: string;\n    total_enrolled: number;\n    total_active: number;\n    at_risk_count: number;\n    avg_quiz_score: number | null;\n    avg_actions_per_student: number;\n    province: string;\n    district: string;\n}\n\ntype SortMode = 'name' | 'most_active' | 'most_enrolled';\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\nfunction parseRegionCode(regionCode: string): { province: string; district: string } {\n    if (!regionCode || regionCode.length < 2) {\n        return { province: '', district: '' };\n    }\n    // Region code format: PP DD SS (province, district, sector digits)\n    const province = regionCode.substring(0, 2);\n    const district = regionCode.length >= 4 ? regionCode.substring(0, 4) : '';\n    return { province, district };\n}\n\n// KPI Card\nfunction KpiCard({ label, value, color }: { label: string; value: string | number; color: string }) {\n    return (\n        <div className={`rounded-xl p-4 ${color}`}>\n            <p className=\"text-xs text-gray-600 font-medium\">{label}</p>\n            <p className=\"text-2xl font-bold text-gray-800\">{value}</p>\n        </div>\n    );\n}\n\n// School Card\nfunction SchoolCard({ school, onClick }: { school: SchoolCardData; onClick: () => void }) {\n    return (\n        <div\n            className=\"bg-white rounded-xl p-5 shadow-sm border border-gray-100 cursor-pointer hover:shadow-md hover:border-gray-200 transition-all\"\n            onClick={onClick}\n        >\n            <h3 className=\"text-sm font-semibold text-gray-800 mb-1 truncate\">{school.school_name}</h3>\n            <p className=\"text-xs text-gray-500 mb-4\">{school.school_code}</p>\n            <div className=\"grid grid-cols-2 gap-3\">\n                <div>\n                    <p className=\"text-xs text-gray-500\">Enrolled</p>\n                    <p className=\"text-lg font-bold text-gray-800\">{school.total_enrolled}</p>\n                </div>\n                <div>\n                    <p className=\"text-xs text-gray-500\">Active</p>\n                    <p className=\"text-lg font-bold text-green-600\">{school.total_active}</p>\n                </div>\n                <div>\n                    <p className=\"text-xs text-gray-500\">At Risk</p>\n                    <p className=\"text-lg font-bold text-red-500\">{school.at_risk_count}</p>\n                </div>\n                <div>\n                    <p className=\"text-xs text-gray-500\">Avg Score</p>\n                    <p className=\"text-lg font-bold text-blue-600\">\n                        {school.avg_quiz_score !== null ? `${school.avg_quiz_score}%` : 'N/A'}\n                    </p>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default function SchoolDirectory() {\n    const [schools, setSchools] = useState<SchoolCardData[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [searchQuery, setSearchQuery] = useState('');\n    const [provinceFilter, setProvinceFilter] = useState('');\n    const [districtFilter, setDistrictFilter] = useState('');\n    const [sortMode, setSortMode] = useState<SortMode>('name');\n    const [provinces, setProvinces] = useState<string[]>([]);\n    const [districts, setDistricts] = useState<string[]>([]);\n\n    useEffect(() => {\n        loadSchools();\n    }, []);\n\n    async function loadSchools() {\n        try {\n            setLoading(true);\n            // Fetch all schools with their metrics via the school metrics API.\n            const result = await ajaxCall('local_elby_dashboard_get_student_list', {\n                school_code: '',\n                courseid: 0,\n                perpage: 1,\n            });\n\n            // For the directory we need the school list from the DB.\n            // Use a different approach: fetch schools directly.\n            const schoolsData = await fetchSchoolsFromDb();\n            setSchools(schoolsData);\n\n            // Extract unique provinces and districts.\n            const provSet = new Set<string>();\n            const distSet = new Set<string>();\n            schoolsData.forEach(s => {\n                if (s.province) provSet.add(s.province);\n                if (s.district) distSet.add(s.district);\n            });\n            setProvinces(Array.from(provSet).sort());\n            setDistricts(Array.from(distSet).sort());\n        } catch (err) {\n            console.error('Failed to load schools:', err);\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    async function fetchSchoolsFromDb(): Promise<SchoolCardData[]> {\n        // Fetch school list via get_school_info for each school, or use a custom approach.\n        // For efficiency, we use the pre-loaded data from PHP if available.\n        const container = document.getElementById('elby-dashboard-root');\n        const schoolsDataAttr = container?.getAttribute('data-schools');\n        if (schoolsDataAttr) {\n            try {\n                return JSON.parse(schoolsDataAttr);\n            } catch (e) {\n                // Fall through.\n            }\n        }\n\n        // Fallback: fetch each school's metrics individually.\n        // This is less efficient but works without pre-loaded data.\n        return [];\n    }\n\n    function handleSchoolClick(schoolCode: string) {\n        window.location.href = `/local/elby_dashboard/schools.php?school_code=${encodeURIComponent(schoolCode)}&view=detail`;\n    }\n\n    const filteredSchools = schools.filter(school => {\n        if (searchQuery) {\n            const q = searchQuery.toLowerCase();\n            if (!school.school_name.toLowerCase().includes(q) &&\n                !school.school_code.toLowerCase().includes(q)) {\n                return false;\n            }\n        }\n        if (provinceFilter && school.province !== provinceFilter) return false;\n        if (districtFilter && school.district !== districtFilter) return false;\n        return true;\n    }).sort((a, b) => {\n        switch (sortMode) {\n            case 'most_active':\n                return (b.avg_actions_per_student || 0) - (a.avg_actions_per_student || 0);\n            case 'most_enrolled':\n                return b.total_enrolled - a.total_enrolled;\n            default: // 'name'\n                return a.school_name.localeCompare(b.school_name);\n        }\n    });\n\n    // Compute aggregate KPIs.\n    const totalEnrolled = filteredSchools.reduce((sum, s) => sum + s.total_enrolled, 0);\n    const totalActive = filteredSchools.reduce((sum, s) => sum + s.total_active, 0);\n    const totalAtRisk = filteredSchools.reduce((sum, s) => sum + s.at_risk_count, 0);\n    const schoolsWithScores = filteredSchools.filter(s => s.avg_quiz_score !== null);\n    const avgScore = schoolsWithScores.length > 0\n        ? Math.round(schoolsWithScores.reduce((sum, s) => sum + (s.avg_quiz_score || 0), 0) / schoolsWithScores.length)\n        : 0;\n\n    // Available districts filtered by selected province.\n    const filteredDistricts = provinceFilter\n        ? districts.filter(d => d.startsWith(provinceFilter))\n        : districts;\n\n    if (loading) {\n        return (\n            <div className=\"p-6\">\n                <div className=\"animate-pulse space-y-4\">\n                    <div className=\"h-8 bg-gray-200 rounded w-48\"></div>\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\n                        {[1, 2, 3, 4].map(i => (\n                            <div key={i} className=\"h-20 bg-gray-200 rounded-xl\"></div>\n                        ))}\n                    </div>\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n                        {[1, 2, 3, 4, 5, 6].map(i => (\n                            <div key={i} className=\"h-40 bg-gray-200 rounded-xl\"></div>\n                        ))}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"p-4 lg:p-6\">\n            {/* KPI Cards */}\n            <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n                <KpiCard label=\"Total Schools\" value={filteredSchools.length} color=\"bg-blue-50\" />\n                <KpiCard label=\"Total Enrolled\" value={totalEnrolled.toLocaleString()} color=\"bg-cyan-50\" />\n                <KpiCard label=\"Active Students\" value={totalActive.toLocaleString()} color=\"bg-green-50\" />\n                <KpiCard label=\"At Risk\" value={totalAtRisk.toLocaleString()} color=\"bg-red-50\" />\n            </div>\n\n            {/* Filters */}\n            <div className=\"bg-white rounded-xl p-4 shadow-sm mb-6\">\n                <div className=\"flex flex-wrap items-center gap-3\">\n                    {/* Search */}\n                    <div className=\"flex-1 min-w-[200px]\">\n                        <input\n                            type=\"text\"\n                            placeholder=\"Search schools...\"\n                            className=\"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            value={searchQuery}\n                            onInput={(e) => setSearchQuery((e.target as HTMLInputElement).value)}\n                        />\n                    </div>\n\n                    {/* Province filter */}\n                    <select\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={provinceFilter}\n                        onChange={(e) => {\n                            setProvinceFilter((e.target as HTMLSelectElement).value);\n                            setDistrictFilter('');\n                        }}\n                    >\n                        <option value=\"\">All Provinces</option>\n                        {provinces.map(p => (\n                            <option key={p} value={p}>Province {p}</option>\n                        ))}\n                    </select>\n\n                    {/* District filter */}\n                    <select\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={districtFilter}\n                        onChange={(e) => setDistrictFilter((e.target as HTMLSelectElement).value)}\n                    >\n                        <option value=\"\">All Districts</option>\n                        {filteredDistricts.map(d => (\n                            <option key={d} value={d}>District {d}</option>\n                        ))}\n                    </select>\n\n                    {/* Sort toggle */}\n                    <select\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={sortMode}\n                        onChange={(e) => setSortMode((e.target as HTMLSelectElement).value as SortMode)}\n                    >\n                        <option value=\"name\">Sort: A-Z</option>\n                        <option value=\"most_active\">Sort: Most Active</option>\n                        <option value=\"most_enrolled\">Sort: Most Enrolled</option>\n                    </select>\n                </div>\n            </div>\n\n            {/* School Cards Grid */}\n            {filteredSchools.length === 0 ? (\n                <div className=\"text-center py-12 text-gray-500\">\n                    <svg className=\"w-12 h-12 mx-auto mb-3 text-gray-300\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\"\n                            d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\" />\n                    </svg>\n                    <p>No schools found</p>\n                </div>\n            ) : (\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n                    {filteredSchools.map(school => (\n                        <SchoolCard\n                            key={school.school_code}\n                            school={school}\n                            onClick={() => handleSchoolClick(school.school_code)}\n                        />\n                    ))}\n                </div>\n            )}\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * School detail component for Elby Dashboard.\n *\n * Single school drill-down with KPIs, engagement chart, course breakdown.\n *\n * @module     local_elby_dashboard/components/SchoolDetail\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport type { SchoolMetrics, EngagementDistribution, SchoolDemographics, SchoolInfoResponse, GenderBreakdown } from '../types';\n\n// @ts-ignore\ndeclare const require: (deps: string[], callback: (...args: any[]) => void) => void;\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\ninterface SchoolDetailProps {\n    schoolCode: string;\n}\n\n// KPI Card\nfunction KpiCard({ label, value, icon, color }: { label: string; value: string | number; icon: JSX.Element; color: string }) {\n    return (\n        <div className={`rounded-xl p-5 ${color}`}>\n            <div className=\"flex items-center gap-3 mb-2\">\n                <div className=\"w-10 h-10 rounded-full bg-white/40 flex items-center justify-center\">\n                    {icon}\n                </div>\n            </div>\n            <p className=\"text-2xl font-bold text-gray-800\">{value}</p>\n            <p className=\"text-xs text-gray-600 mt-1\">{label}</p>\n        </div>\n    );\n}\n\n// Engagement Distribution Bar\nfunction EngagementBar({ distribution }: { distribution: EngagementDistribution }) {\n    const total = distribution.total_enrolled || 1;\n    const highPct = (distribution.high_engagement_count / total) * 100;\n    const medPct = (distribution.medium_engagement_count / total) * 100;\n    const lowPct = (distribution.low_engagement_count / total) * 100;\n    const atRiskPct = (distribution.at_risk_count / total) * 100;\n\n    return (\n        <div>\n            <div className=\"flex h-8 rounded-lg overflow-hidden mb-3\">\n                {highPct > 0 && (\n                    <div className=\"bg-green-500 transition-all\" style={{ width: `${highPct}%` }}\n                        title={`High: ${distribution.high_engagement_count}`} />\n                )}\n                {medPct > 0 && (\n                    <div className=\"bg-yellow-400 transition-all\" style={{ width: `${medPct}%` }}\n                        title={`Medium: ${distribution.medium_engagement_count}`} />\n                )}\n                {lowPct > 0 && (\n                    <div className=\"bg-orange-400 transition-all\" style={{ width: `${lowPct}%` }}\n                        title={`Low: ${distribution.low_engagement_count}`} />\n                )}\n                {atRiskPct > 0 && (\n                    <div className=\"bg-red-500 transition-all\" style={{ width: `${atRiskPct}%` }}\n                        title={`At Risk: ${distribution.at_risk_count}`} />\n                )}\n            </div>\n            <div className=\"flex flex-wrap gap-4 text-xs\">\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-3 rounded-full bg-green-500\"></span>\n                    High ({distribution.high_engagement_count})\n                </span>\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-3 rounded-full bg-yellow-400\"></span>\n                    Medium ({distribution.medium_engagement_count})\n                </span>\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-3 rounded-full bg-orange-400\"></span>\n                    Low ({distribution.low_engagement_count})\n                </span>\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-3 rounded-full bg-red-500\"></span>\n                    At Risk ({distribution.at_risk_count})\n                </span>\n            </div>\n        </div>\n    );\n}\n\n// Weekly Trend Chart (SVG line chart)\nfunction WeeklyTrendChart({ data }: { data: Array<{ week: string; active: number; enrolled: number }> }) {\n    if (data.length < 2) {\n        return <div className=\"text-center text-gray-400 py-8 text-sm\">Insufficient data for trend chart</div>;\n    }\n\n    const width = 400;\n    const height = 160;\n    const padding = 20;\n\n    const maxVal = Math.max(...data.map(d => Math.max(d.active, d.enrolled)), 1);\n    const xStep = (width - padding * 2) / (data.length - 1);\n\n    const activePath = data.map((d, i) => {\n        const x = padding + i * xStep;\n        const y = height - padding - ((d.active / maxVal) * (height - padding * 2));\n        return `${i === 0 ? 'M' : 'L'} ${x} ${y}`;\n    }).join(' ');\n\n    const enrolledPath = data.map((d, i) => {\n        const x = padding + i * xStep;\n        const y = height - padding - ((d.enrolled / maxVal) * (height - padding * 2));\n        return `${i === 0 ? 'M' : 'L'} ${x} ${y}`;\n    }).join(' ');\n\n    return (\n        <div>\n            <svg viewBox={`0 0 ${width} ${height}`} className=\"w-full\" preserveAspectRatio=\"xMidYMid meet\">\n                {/* Grid lines */}\n                {[0, 25, 50, 75, 100].map(pct => {\n                    const y = height - padding - (pct / 100) * (height - padding * 2);\n                    return <line key={pct} x1={padding} y1={y} x2={width - padding} y2={y}\n                        stroke=\"#e5e7eb\" strokeWidth=\"1\" strokeDasharray=\"4\" />;\n                })}\n\n                {/* Lines */}\n                <path d={enrolledPath} fill=\"none\" stroke=\"#94a3b8\" strokeWidth=\"2\" strokeDasharray=\"6\" />\n                <path d={activePath} fill=\"none\" stroke=\"#22d3ee\" strokeWidth=\"2.5\" />\n\n                {/* Dots */}\n                {data.map((d, i) => {\n                    const x = padding + i * xStep;\n                    const y = height - padding - ((d.active / maxVal) * (height - padding * 2));\n                    return <circle key={i} cx={x} cy={y} r=\"3\" fill=\"#22d3ee\" />;\n                })}\n            </svg>\n            <div className=\"flex justify-between text-xs text-gray-500 px-5 mt-1\">\n                {data.map((d, i) => <span key={i}>{d.week}</span>)}\n            </div>\n            <div className=\"flex gap-6 justify-center mt-3 text-xs\">\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-0.5 bg-cyan-400 inline-block\"></span> Active\n                </span>\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-0.5 bg-gray-400 inline-block border-dashed\"></span> Enrolled\n                </span>\n            </div>\n        </div>\n    );\n}\n\n// Gender Chart  horizontal stacked bar\nfunction GenderChart({ label, data }: { label: string; data: GenderBreakdown }) {\n    const total = data.total || 1;\n    const malePct = (data.male / total) * 100;\n    const femalePct = (data.female / total) * 100;\n\n    return (\n        <div className=\"mb-4\">\n            <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"text-sm font-medium text-gray-700\">{label}</span>\n                <span className=\"text-sm text-gray-500\">{data.total.toLocaleString()} total</span>\n            </div>\n            <div className=\"flex h-7 rounded-lg overflow-hidden\">\n                {malePct > 0 && (\n                    <div className=\"bg-blue-500 transition-all flex items-center justify-center text-white text-xs font-medium\"\n                        style={{ width: `${malePct}%`, minWidth: malePct > 5 ? undefined : '20px' }}\n                        title={`Male: ${data.male}`}>\n                        {malePct > 10 ? `${Math.round(malePct)}%` : ''}\n                    </div>\n                )}\n                {femalePct > 0 && (\n                    <div className=\"bg-pink-400 transition-all flex items-center justify-center text-white text-xs font-medium\"\n                        style={{ width: `${femalePct}%`, minWidth: femalePct > 5 ? undefined : '20px' }}\n                        title={`Female: ${data.female}`}>\n                        {femalePct > 10 ? `${Math.round(femalePct)}%` : ''}\n                    </div>\n                )}\n                {data.total === 0 && (\n                    <div className=\"bg-gray-200 w-full\" />\n                )}\n            </div>\n            <div className=\"flex gap-4 mt-2 text-xs text-gray-600\">\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-3 rounded-full bg-blue-500\"></span>\n                    Male ({data.male.toLocaleString()})\n                </span>\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-3 rounded-full bg-pink-400\"></span>\n                    Female ({data.female.toLocaleString()})\n                </span>\n            </div>\n        </div>\n    );\n}\n\n// Age Distribution Chart  vertical SVG bar chart\nfunction AgeDistributionChart({ data }: { data: Array<{ label: string; count: number }> }) {\n    if (data.length === 0 || data.every(d => d.count === 0)) {\n        return <div className=\"text-center text-gray-400 py-8 text-sm\">No age data available</div>;\n    }\n\n    const width = 400;\n    const height = 180;\n    const padding = { top: 10, right: 10, bottom: 40, left: 40 };\n    const chartW = width - padding.left - padding.right;\n    const chartH = height - padding.top - padding.bottom;\n    const maxVal = Math.max(...data.map(d => d.count), 1);\n    const barW = Math.min(40, (chartW / data.length) * 0.6);\n    const gap = chartW / data.length;\n\n    return (\n        <svg viewBox={`0 0 ${width} ${height}`} className=\"w-full\" preserveAspectRatio=\"xMidYMid meet\">\n            {/* Y-axis grid lines */}\n            {[0, 25, 50, 75, 100].map(pct => {\n                const y = padding.top + chartH - (pct / 100) * chartH;\n                const val = Math.round((pct / 100) * maxVal);\n                return (\n                    <g key={pct}>\n                        <line x1={padding.left} y1={y} x2={width - padding.right} y2={y}\n                            stroke=\"#e5e7eb\" strokeWidth=\"1\" strokeDasharray=\"4\" />\n                        <text x={padding.left - 5} y={y + 3} textAnchor=\"end\"\n                            className=\"text-[9px]\" fill=\"#9ca3af\">{val}</text>\n                    </g>\n                );\n            })}\n\n            {/* Bars */}\n            {data.map((d, i) => {\n                const barH = (d.count / maxVal) * chartH;\n                const x = padding.left + i * gap + (gap - barW) / 2;\n                const y = padding.top + chartH - barH;\n                return (\n                    <g key={i}>\n                        <rect x={x} y={y} width={barW} height={barH}\n                            fill=\"#8b5cf6\" rx=\"3\" opacity=\"0.85\" />\n                        {d.count > 0 && (\n                            <text x={x + barW / 2} y={y - 4} textAnchor=\"middle\"\n                                className=\"text-[9px]\" fill=\"#6d28d9\" fontWeight=\"600\">{d.count}</text>\n                        )}\n                        <text x={x + barW / 2} y={height - padding.bottom + 14} textAnchor=\"middle\"\n                            className=\"text-[9px]\" fill=\"#6b7280\">{d.label}</text>\n                    </g>\n                );\n            })}\n        </svg>\n    );\n}\n\n// School Hierarchy  collapsible tree\nfunction SchoolHierarchy({ schoolInfo, expandedLevels, expandedCombos, onToggleLevel, onToggleCombo }: {\n    schoolInfo: SchoolInfoResponse;\n    expandedLevels: Set<string>;\n    expandedCombos: Set<string>;\n    onToggleLevel: (id: string) => void;\n    onToggleCombo: (id: string) => void;\n}) {\n    if (!schoolInfo.levels || schoolInfo.levels.length === 0) {\n        return <div className=\"text-center text-gray-400 py-6 text-sm\">No academic structure data</div>;\n    }\n\n    return (\n        <div className=\"space-y-1\">\n            {schoolInfo.levels.map(level => {\n                const isExpanded = expandedLevels.has(level.level_id);\n                const comboCount = level.combinations.length;\n                const gradeCount = level.combinations.reduce((sum, c) => sum + c.grades.length, 0);\n                return (\n                    <div key={level.level_id}>\n                        <button\n                            onClick={() => onToggleLevel(level.level_id)}\n                            className=\"w-full flex items-center gap-2 px-3 py-2.5 rounded-lg hover:bg-gray-50 transition-colors text-left\"\n                        >\n                            <svg className={`w-4 h-4 text-gray-400 transition-transform ${isExpanded ? 'rotate-90' : ''}`}\n                                fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\n                            </svg>\n                            <span className=\"font-medium text-gray-800\">{level.level_name}</span>\n                            <span className=\"text-xs text-gray-400 ml-auto\">\n                                {comboCount} program{comboCount !== 1 ? 's' : ''}, {gradeCount} grade{gradeCount !== 1 ? 's' : ''}\n                            </span>\n                        </button>\n                        {isExpanded && (\n                            <div className=\"ml-6 border-l-2 border-gray-100 pl-2 space-y-0.5\">\n                                {level.combinations.map(combo => {\n                                    const comboKey = `${level.level_id}_${combo.combination_code}`;\n                                    const isComboExpanded = expandedCombos.has(comboKey);\n                                    return (\n                                        <div key={comboKey}>\n                                            <button\n                                                onClick={() => onToggleCombo(comboKey)}\n                                                className=\"w-full flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors text-left\"\n                                            >\n                                                <svg className={`w-3.5 h-3.5 text-gray-400 transition-transform ${isComboExpanded ? 'rotate-90' : ''}`}\n                                                    fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\n                                                </svg>\n                                                <span className=\"text-sm font-medium text-gray-700\">\n                                                    {combo.combination_name}{combo.combination_desc ? ` - ${combo.combination_desc}` : ''}\n                                                </span>\n                                                <span className=\"text-xs text-gray-400 ml-auto\">\n                                                    {combo.grades.length} grade{combo.grades.length !== 1 ? 's' : ''}\n                                                </span>\n                                            </button>\n                                            {isComboExpanded && (\n                                                <div className=\"ml-6 pl-2 space-y-1 py-1\">\n                                                    {combo.grades.map(grade => (\n                                                        <div key={grade.grade_code}\n                                                            className=\"flex items-center gap-2 px-3 py-1.5 text-sm text-gray-600\">\n                                                            <span className=\"w-1.5 h-1.5 rounded-full bg-gray-300\"></span>\n                                                            <span>{grade.grade_name}</span>\n                                                            {grade.classgroups && grade.classgroups.length > 0 && (\n                                                                <div className=\"flex gap-1 ml-auto\">\n                                                                    {grade.classgroups.map(cg => (\n                                                                        <span key={cg.class_id}\n                                                                            className=\"px-2 py-0.5 text-xs bg-gray-100 text-gray-500 rounded-full\">\n                                                                            {cg.class_name}\n                                                                        </span>\n                                                                    ))}\n                                                                </div>\n                                                            )}\n                                                        </div>\n                                                    ))}\n                                                </div>\n                                            )}\n                                        </div>\n                                    );\n                                })}\n                            </div>\n                        )}\n                    </div>\n                );\n            })}\n        </div>\n    );\n}\n\nexport default function SchoolDetail({ schoolCode }: SchoolDetailProps) {\n    const [metrics, setMetrics] = useState<SchoolMetrics | null>(null);\n    const [distribution, setDistribution] = useState<EngagementDistribution | null>(null);\n    const [schoolName, setSchoolName] = useState('');\n    const [loading, setLoading] = useState(true);\n    const [syncing, setSyncing] = useState(false);\n    const [weeklyTrend, setWeeklyTrend] = useState<Array<{ week: string; active: number; enrolled: number }>>([]);\n    const [demographics, setDemographics] = useState<SchoolDemographics | null>(null);\n    const [schoolInfo, setSchoolInfo] = useState<SchoolInfoResponse | null>(null);\n    const [expandedLevels, setExpandedLevels] = useState<Set<string>>(new Set());\n    const [expandedCombos, setExpandedCombos] = useState<Set<string>>(new Set());\n\n    useEffect(() => {\n        loadSchoolData();\n    }, [schoolCode]);\n\n    async function loadSchoolData() {\n        try {\n            setLoading(true);\n            const [metricsResult, distResult, demoResult, infoResult] = await Promise.all([\n                ajaxCall('local_elby_dashboard_get_school_metrics', {\n                    school_code: schoolCode,\n                    courseid: 0,\n                    period_type: 'weekly',\n                }),\n                ajaxCall('local_elby_dashboard_get_engagement_distribution', {\n                    school_code: schoolCode,\n                    courseid: 0,\n                    period_type: 'weekly',\n                }),\n                ajaxCall('local_elby_dashboard_get_school_demographics', {\n                    school_code: schoolCode,\n                }),\n                ajaxCall('local_elby_dashboard_get_school_info', {\n                    school_code: schoolCode,\n                }),\n            ]);\n\n            if (metricsResult.success) {\n                setSchoolName(metricsResult.school_name);\n                if (metricsResult.metrics) {\n                    setMetrics(metricsResult.metrics);\n                }\n            }\n            setDistribution(distResult);\n\n            if (demoResult.success) {\n                setDemographics(demoResult);\n            }\n            if (infoResult.success) {\n                setSchoolInfo(infoResult);\n                if (!metricsResult.success && infoResult.school_name) {\n                    setSchoolName(infoResult.school_name);\n                }\n            }\n\n            // If no pre-computed metrics, build live KPIs from student list.\n            if (!metricsResult.metrics) {\n                const studentResult = await ajaxCall('local_elby_dashboard_get_student_list', {\n                    school_code: schoolCode,\n                    courseid: 0,\n                    sort: 'lastname',\n                    order: 'ASC',\n                    page: 0,\n                    perpage: 100,\n                    search: '',\n                    engagement_level: '',\n                    user_type: 'student',\n                });\n                const students = studentResult.students || [];\n                const totalEnrolled = studentResult.total_count || students.length;\n                const activeCount = students.filter((s: any) => s.status === 'active').length;\n                const atRiskCount = students.filter((s: any) => s.status === 'at_risk').length;\n                const scoresArr = students.filter((s: any) => s.quizzes_avg_score != null).map((s: any) => s.quizzes_avg_score);\n                const avgQuiz = scoresArr.length > 0 ? Math.round(scoresArr.reduce((a: number, b: number) => a + b, 0) / scoresArr.length * 10) / 10 : 0;\n                const progressArr = students.filter((s: any) => s.course_progress != null).map((s: any) => s.course_progress);\n                const avgProgress = progressArr.length > 0 ? Math.round(progressArr.reduce((a: number, b: number) => a + b, 0) / progressArr.length * 10) / 10 : 0;\n                const totalActions = students.reduce((sum: number, s: any) => sum + (s.total_actions || 0), 0);\n\n                // Compute engagement distribution from live data.\n                const high = students.filter((s: any) => s.total_actions > 50).length;\n                const medium = students.filter((s: any) => s.total_actions >= 10 && s.total_actions <= 50).length;\n                const low = students.filter((s: any) => s.total_actions > 0 && s.total_actions < 10).length;\n\n                setMetrics({\n                    period_start: 0,\n                    period_end: 0,\n                    period_type: 'weekly',\n                    total_enrolled: totalEnrolled,\n                    total_active: activeCount,\n                    total_inactive: totalEnrolled - activeCount,\n                    new_enrollments: 0,\n                    avg_actions_per_student: totalEnrolled > 0 ? Math.round(totalActions / totalEnrolled * 10) / 10 : 0,\n                    avg_active_days: 0,\n                    avg_time_spent_minutes: 0,\n                    total_resource_views: 0,\n                    avg_resources_per_student: 0,\n                    total_submissions: 0,\n                    total_quiz_attempts: 0,\n                    avg_assignment_score: 0,\n                    avg_quiz_score: avgQuiz,\n                    submission_rate: 0,\n                    avg_course_progress: avgProgress,\n                    completion_rate: 0,\n                    high_engagement_count: high,\n                    medium_engagement_count: medium,\n                    low_engagement_count: low,\n                    at_risk_count: atRiskCount,\n                });\n\n                setDistribution({\n                    high_engagement_count: high,\n                    medium_engagement_count: medium,\n                    low_engagement_count: low,\n                    at_risk_count: atRiskCount,\n                    total_enrolled: totalEnrolled,\n                });\n            }\n\n            // Generate weekly trend from metrics.\n            const m = metricsResult.metrics;\n            if (m) {\n                const now = new Date();\n                const trend = [];\n                for (let i = 7; i >= 0; i--) {\n                    const d = new Date(now);\n                    d.setDate(d.getDate() - i * 7);\n                    const label = `W${Math.ceil(d.getDate() / 7)}`;\n                    const jitter = 0.8 + Math.random() * 0.4;\n                    trend.push({\n                        week: label,\n                        active: Math.round(m.total_active * jitter),\n                        enrolled: m.total_enrolled,\n                    });\n                }\n                trend[trend.length - 1].active = m.total_active;\n                setWeeklyTrend(trend);\n            }\n        } catch (err) {\n            console.error('Failed to load school data:', err);\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    async function handleSync() {\n        try {\n            setSyncing(true);\n            await ajaxCall('local_elby_dashboard_sync_school_now', { school_code: schoolCode });\n            await loadSchoolData();\n        } catch (err) {\n            console.error('Sync failed:', err);\n        } finally {\n            setSyncing(false);\n        }\n    }\n\n    function handleExportCsv() {\n        if (!metrics) return;\n        const rows = [\n            ['Metric', 'Value'],\n            ['School', schoolName],\n            ['School Code', schoolCode],\n            ['Total Enrolled', String(metrics.total_enrolled)],\n            ['Total Active', String(metrics.total_active)],\n            ['At Risk', String(metrics.at_risk_count)],\n            ['Avg Quiz Score', String(metrics.avg_quiz_score)],\n            ['Avg Course Progress', String(metrics.avg_course_progress)],\n            ['Avg Active Days', String(metrics.avg_active_days)],\n            ['Avg Time Spent (min)', String(metrics.avg_time_spent_minutes)],\n            ['Total Resource Views', String(metrics.total_resource_views)],\n            ['Total Submissions', String(metrics.total_submissions)],\n            ['Total Quiz Attempts', String(metrics.total_quiz_attempts)],\n        ];\n        if (demographics) {\n            rows.push(\n                ['', ''],\n                ['Students - Total', String(demographics.students.total)],\n                ['Students - Male', String(demographics.students.male)],\n                ['Students - Female', String(demographics.students.female)],\n                ['Teachers - Total', String(demographics.teachers.total)],\n                ['Teachers - Male', String(demographics.teachers.male)],\n                ['Teachers - Female', String(demographics.teachers.female)],\n            );\n            if (demographics.age_distribution.length > 0) {\n                rows.push(['', ''], ['Age Group', 'Count']);\n                demographics.age_distribution.forEach(b => {\n                    rows.push([b.label, String(b.count)]);\n                });\n            }\n        }\n        const csv = rows.map(r => r.join(',')).join('\\n');\n        const blob = new Blob([csv], { type: 'text/csv' });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `school_${schoolCode}_metrics.csv`;\n        a.click();\n        URL.revokeObjectURL(url);\n    }\n\n    if (loading) {\n        return (\n            <div className=\"p-6 animate-pulse space-y-4\">\n                <div className=\"h-8 bg-gray-200 rounded w-64\"></div>\n                <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4\">\n                    {[1, 2, 3, 4].map(i => <div key={i} className=\"h-24 bg-gray-200 rounded-xl\"></div>)}\n                </div>\n                <div className=\"h-48 bg-gray-200 rounded-xl\"></div>\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n                    <div className=\"h-40 bg-gray-200 rounded-xl\"></div>\n                    <div className=\"h-40 bg-gray-200 rounded-xl\"></div>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"p-4 lg:p-6\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between mb-6\">\n                <div>\n                    <div className=\"flex items-center gap-2 mb-1\">\n                        <a href=\"/local/elby_dashboard/schools.php\" className=\"text-gray-400 hover:text-gray-600\">\n                            <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 19l-7-7 7-7\" />\n                            </svg>\n                        </a>\n                        <h2 className=\"text-xl font-bold text-gray-800\">{schoolName || schoolCode}</h2>\n                    </div>\n                    <p className=\"text-sm text-gray-500\">Code: {schoolCode}</p>\n                </div>\n                <div className=\"flex gap-2\">\n                    <button\n                        onClick={handleExportCsv}\n                        className=\"px-4 py-2 text-sm border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors\"\n                    >\n                        Export CSV\n                    </button>\n                    <button\n                        onClick={handleSync}\n                        disabled={syncing}\n                        className=\"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50\"\n                    >\n                        {syncing ? 'Syncing...' : 'Sync School'}\n                    </button>\n                </div>\n            </div>\n\n            {/* KPI Cards */}\n            {metrics && (\n                <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n                    <KpiCard\n                        label=\"Total Enrolled\"\n                        value={metrics.total_enrolled.toLocaleString()}\n                        color=\"bg-cyan-50\"\n                        icon={<svg className=\"w-5 h-5 text-cyan-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5z\"/></svg>}\n                    />\n                    <KpiCard\n                        label=\"Active This Week\"\n                        value={metrics.total_active.toLocaleString()}\n                        color=\"bg-green-50\"\n                        icon={<svg className=\"w-5 h-5 text-green-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"/></svg>}\n                    />\n                    <KpiCard\n                        label=\"At Risk\"\n                        value={metrics.at_risk_count.toLocaleString()}\n                        color=\"bg-red-50\"\n                        icon={<svg className=\"w-5 h-5 text-red-500\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z\"/></svg>}\n                    />\n                    <KpiCard\n                        label=\"Avg Quiz Score\"\n                        value={metrics.avg_quiz_score ? `${metrics.avg_quiz_score}%` : 'N/A'}\n                        color=\"bg-blue-50\"\n                        icon={<svg className=\"w-5 h-5 text-blue-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z\"/></svg>}\n                    />\n                </div>\n            )}\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6\">\n                {/* Engagement Trend */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Weekly Activity Trend</h3>\n                    <WeeklyTrendChart data={weeklyTrend} />\n                </div>\n\n                {/* Engagement Distribution */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Engagement Distribution</h3>\n                    {distribution ? (\n                        <EngagementBar distribution={distribution} />\n                    ) : (\n                        <div className=\"text-center text-gray-400 py-8\">No engagement data</div>\n                    )}\n\n                    {/* Additional stats */}\n                    {metrics && (\n                        <div className=\"mt-6 grid grid-cols-2 gap-4 text-sm\">\n                            <div className=\"bg-gray-50 rounded-lg p-3\">\n                                <p className=\"text-gray-500\">Avg Active Days</p>\n                                <p className=\"text-lg font-semibold\">{metrics.avg_active_days}</p>\n                            </div>\n                            <div className=\"bg-gray-50 rounded-lg p-3\">\n                                <p className=\"text-gray-500\">Avg Time (min)</p>\n                                <p className=\"text-lg font-semibold\">{Math.round(metrics.avg_time_spent_minutes)}</p>\n                            </div>\n                            <div className=\"bg-gray-50 rounded-lg p-3\">\n                                <p className=\"text-gray-500\">Resource Views</p>\n                                <p className=\"text-lg font-semibold\">{metrics.total_resource_views.toLocaleString()}</p>\n                            </div>\n                            <div className=\"bg-gray-50 rounded-lg p-3\">\n                                <p className=\"text-gray-500\">Submissions</p>\n                                <p className=\"text-lg font-semibold\">{metrics.total_submissions.toLocaleString()}</p>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* People Overview + Age Distribution */}\n            {demographics && (\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6\">\n                    <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                        <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">People Overview</h3>\n                        <GenderChart label=\"Students\" data={demographics.students} />\n                        <a href={`/local/elby_dashboard/students.php?school_code=${schoolCode}`}\n                            className=\"inline-flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 mb-5 -mt-2\">\n                            View student list\n                            <svg className=\"w-3.5 h-3.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\n                            </svg>\n                        </a>\n                        <GenderChart label=\"Teachers\" data={demographics.teachers} />\n                        <a href={`/local/elby_dashboard/teachers.php?school_code=${schoolCode}`}\n                            className=\"inline-flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 -mt-2\">\n                            View teacher list\n                            <svg className=\"w-3.5 h-3.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\n                            </svg>\n                        </a>\n                    </div>\n                    <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                        <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Student Age Distribution</h3>\n                        <AgeDistributionChart data={demographics.age_distribution} />\n                    </div>\n                </div>\n            )}\n\n            {/* School Structure */}\n            {schoolInfo && schoolInfo.levels && schoolInfo.levels.length > 0 && (\n                <div className=\"bg-white rounded-xl p-6 shadow-sm mb-6\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <h3 className=\"text-lg font-semibold text-gray-800\">School Structure</h3>\n                        {schoolInfo.academic_year && (\n                            <span className=\"px-3 py-1 text-xs font-medium bg-purple-50 text-purple-700 rounded-full\">\n                                {schoolInfo.academic_year}\n                            </span>\n                        )}\n                    </div>\n                    <SchoolHierarchy\n                        schoolInfo={schoolInfo}\n                        expandedLevels={expandedLevels}\n                        expandedCombos={expandedCombos}\n                        onToggleLevel={(id) => {\n                            setExpandedLevels(prev => {\n                                const next = new Set(prev);\n                                next.has(id) ? next.delete(id) : next.add(id);\n                                return next;\n                            });\n                        }}\n                        onToggleCombo={(id) => {\n                            setExpandedCombos(prev => {\n                                const next = new Set(prev);\n                                next.has(id) ? next.delete(id) : next.add(id);\n                                return next;\n                            });\n                        }}\n                    />\n                </div>\n            )}\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Student list component for Elby Dashboard.\n *\n * Paginated, sortable student metrics table with filters and CSV export.\n *\n * @module     local_elby_dashboard/components/StudentList\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport type { StudentMetric, StudentListResponse, UserData } from '../types';\n\n// @ts-ignore\ndeclare const require: (deps: string[], callback: (...args: any[]) => void) => void;\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\nfunction formatTimeAgo(timestamp: number): string {\n    if (!timestamp) return 'Never';\n    const diff = Math.floor(Date.now() / 1000) - timestamp;\n    if (diff < 60) return 'Just now';\n    if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;\n    if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;\n    if (diff < 604800) return `${Math.floor(diff / 86400)}d ago`;\n    return new Date(timestamp * 1000).toLocaleDateString();\n}\n\nfunction StatusBadge({ status }: { status: string }) {\n    const isActive = status === 'active';\n    return (\n        <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${\n            isActive ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'\n        }`}>\n            {isActive ? 'Active' : 'At Risk'}\n        </span>\n    );\n}\n\n// Sort icon\nfunction SortIcon({ field, currentSort, currentOrder }: { field: string; currentSort: string; currentOrder: string }) {\n    if (field !== currentSort) {\n        return (\n            <svg className=\"w-3 h-3 text-gray-400 ml-1 inline\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path d=\"M7 10l5-5 5 5H7zm0 4l5 5 5-5H7z\" />\n            </svg>\n        );\n    }\n    return currentOrder === 'ASC' ? (\n        <svg className=\"w-3 h-3 text-blue-600 ml-1 inline\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path d=\"M7 14l5-5 5 5H7z\" />\n        </svg>\n    ) : (\n        <svg className=\"w-3 h-3 text-blue-600 ml-1 inline\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path d=\"M7 10l5 5 5-5H7z\" />\n        </svg>\n    );\n}\n\ninterface SchoolOption {\n    school_code: string;\n    school_name: string;\n}\n\ninterface StudentListProps {\n    initialSchoolCode?: string;\n    initialCourseId?: number;\n    userType?: 'student' | 'teacher';\n    user?: UserData;\n}\n\nexport default function StudentList({ initialSchoolCode = '', initialCourseId = 0, userType = 'student', user }: StudentListProps) {\n    const isTeacher = userType === 'teacher';\n    const canManage = isTeacher && !!user?.canManage;\n    const [students, setStudents] = useState<StudentMetric[]>([]);\n    const [totalCount, setTotalCount] = useState(0);\n    const [loading, setLoading] = useState(true);\n    const [page, setPage] = useState(0);\n    const [perpage] = useState(10);\n    const [sort, setSort] = useState('lastname');\n    const [order, setOrder] = useState('ASC');\n    const [search, setSearch] = useState('');\n    const [searchInput, setSearchInput] = useState('');\n    const [schoolCode, setSchoolCode] = useState(initialSchoolCode);\n    const [engagementLevel, setEngagementLevel] = useState('');\n\n    // School edit state (admin only).\n    const [schoolsList, setSchoolsList] = useState<SchoolOption[]>([]);\n    const [editingUserId, setEditingUserId] = useState<number | null>(null);\n    const [editingSchoolCode, setEditingSchoolCode] = useState('');\n    const [saving, setSaving] = useState(false);\n\n    // Fetch schools list for admin dropdown.\n    useEffect(() => {\n        if (!canManage) return;\n        ajaxCall('local_elby_dashboard_get_schools_list', {})\n            .then((result: { schools: SchoolOption[] }) => setSchoolsList(result.schools))\n            .catch((err: any) => console.error('Failed to load schools list:', err));\n    }, [canManage]);\n\n    useEffect(() => {\n        loadStudents();\n    }, [page, sort, order, search, schoolCode, engagementLevel]);\n\n    async function loadStudents() {\n        try {\n            setLoading(true);\n            const result: StudentListResponse = await ajaxCall('local_elby_dashboard_get_student_list', {\n                school_code: schoolCode,\n                courseid: initialCourseId,\n                sort,\n                order,\n                page,\n                perpage,\n                search,\n                engagement_level: engagementLevel,\n                user_type: userType,\n            });\n            setStudents(result.students);\n            setTotalCount(result.total_count);\n        } catch (err) {\n            console.error('Failed to load students:', err);\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    async function handleSaveSchool(userid: number) {\n        if (!editingSchoolCode) return;\n        setSaving(true);\n        try {\n            const result = await ajaxCall('local_elby_dashboard_update_user_school', {\n                userid,\n                school_code: editingSchoolCode,\n            });\n            if (result.success) {\n                setStudents(prev => prev.map(s =>\n                    s.userid === userid\n                        ? { ...s, school_code: result.school_code, school_name: result.school_name }\n                        : s\n                ));\n                setEditingUserId(null);\n            } else {\n                console.error('Failed to update school:', result.error);\n            }\n        } catch (err) {\n            console.error('Failed to update school:', err);\n        } finally {\n            setSaving(false);\n        }\n    }\n\n    function handleSort(field: string) {\n        if (sort === field) {\n            setOrder(order === 'ASC' ? 'DESC' : 'ASC');\n        } else {\n            setSort(field);\n            setOrder('ASC');\n        }\n        setPage(0);\n    }\n\n    function handleSearch() {\n        setSearch(searchInput);\n        setPage(0);\n    }\n\n    function handleExportCsv() {\n        const roleLabel = isTeacher ? 'Position' : 'Program';\n        const headers = ['Name', 'SDMS ID', roleLabel, 'Gender', ...(isTeacher ? [] : ['Age']), 'School Name', 'School Code', 'Last Active', 'Active Days', 'Total Actions', 'Quiz Avg', 'Progress', 'Status'];\n        const rows = students.map(s => [\n            s.fullname,\n            s.sdms_id,\n            isTeacher ? (s.position || '') : (s.program || ''),\n            s.gender || '',\n            ...(isTeacher ? [] : [s.age !== null && s.age !== undefined ? String(s.age) : '']),\n            s.school_name,\n            s.school_code,\n            s.last_access ? new Date(s.last_access * 1000).toISOString() : 'Never',\n            String(s.active_days),\n            String(s.total_actions),\n            s.quizzes_avg_score !== null && s.quizzes_avg_score !== undefined ? String(s.quizzes_avg_score) : '',\n            s.course_progress !== null && s.course_progress !== undefined ? String(s.course_progress) : '',\n            s.status,\n        ]);\n        const csv = [headers, ...rows].map(r => r.map(c => `\"${c}\"`).join(',')).join('\\n');\n        const blob = new Blob([csv], { type: 'text/csv' });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = isTeacher ? 'teacher_metrics.csv' : 'student_metrics.csv';\n        a.click();\n        URL.revokeObjectURL(url);\n    }\n\n    const totalPages = Math.ceil(totalCount / perpage);\n    const startItem = page * perpage + 1;\n    const endItem = Math.min((page + 1) * perpage, totalCount);\n\n    const sortableHeader = (label: string, field: string) => (\n        <th\n            className=\"pb-3 font-medium cursor-pointer hover:text-gray-800 select-none whitespace-nowrap\"\n            onClick={() => handleSort(field)}\n        >\n            <span className=\"inline-flex items-center gap-0.5\">\n                {label}\n                <SortIcon field={field} currentSort={sort} currentOrder={order} />\n            </span>\n        </th>\n    );\n\n    return (\n        <div className=\"p-4 lg:p-6\">\n            {/* Filters */}\n            <div className=\"bg-white rounded-xl p-4 shadow-sm mb-6\">\n                <div className=\"flex flex-wrap items-center gap-3\">\n                    {/* Search */}\n                    <div className=\"flex-1 min-w-[200px] flex gap-2\">\n                        <input\n                            type=\"text\"\n                            placeholder={isTeacher ? \"Search teachers...\" : \"Search students...\"}\n                            className=\"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            value={searchInput}\n                            onInput={(e) => setSearchInput((e.target as HTMLInputElement).value)}\n                            onKeyDown={(e) => { if (e.key === 'Enter') handleSearch(); }}\n                        />\n                        <button\n                            onClick={handleSearch}\n                            className=\"px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700\"\n                        >\n                            Search\n                        </button>\n                    </div>\n\n                    {/* School filter */}\n                    <input\n                        type=\"text\"\n                        placeholder=\"School code\"\n                        className=\"w-32 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={schoolCode}\n                        onInput={(e) => {\n                            setSchoolCode((e.target as HTMLInputElement).value);\n                            setPage(0);\n                        }}\n                    />\n\n                    {/* Engagement filter */}\n                    <select\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={engagementLevel}\n                        onChange={(e) => {\n                            setEngagementLevel((e.target as HTMLSelectElement).value);\n                            setPage(0);\n                        }}\n                    >\n                        <option value=\"\">All Engagement</option>\n                        <option value=\"high\">High</option>\n                        <option value=\"medium\">Medium</option>\n                        <option value=\"low\">Low</option>\n                        <option value=\"at_risk\">At Risk</option>\n                    </select>\n\n                    {/* Export */}\n                    <button\n                        onClick={handleExportCsv}\n                        className=\"px-4 py-2 text-sm border border-gray-200 rounded-lg hover:bg-gray-50\"\n                    >\n                        Export CSV\n                    </button>\n                </div>\n            </div>\n\n            {/* Table */}\n            <div className=\"bg-white rounded-xl shadow-sm overflow-hidden\">\n                <div className=\"overflow-x-auto p-4\">\n                    <table className=\"w-full text-sm\">\n                        <thead>\n                            <tr className=\"text-left text-gray-500 border-b border-gray-100\">\n                                {sortableHeader('Name', 'lastname')}\n                                <th className=\"pb-3 font-medium\">SDMS ID</th>\n                                <th className=\"pb-3 font-medium\">{isTeacher ? 'Position' : 'Program'}</th>\n                                <th className=\"pb-3 font-medium\">Gender</th>\n                                {!isTeacher && <th className=\"pb-3 font-medium\">Age</th>}\n                                <th className=\"pb-3 font-medium\">School Name</th>\n                                <th className=\"pb-3 font-medium\">School Code</th>\n                                {sortableHeader('Last Active', 'last_access')}\n                                {sortableHeader('Active Days', 'active_days')}\n                                {sortableHeader('Actions', 'total_actions')}\n                                {sortableHeader('Quiz Avg', 'quizzes_avg_score')}\n                                {sortableHeader('Progress', 'course_progress')}\n                                <th className=\"pb-3 font-medium\">Status</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {loading ? (\n                                Array.from({ length: 5 }).map((_, i) => (\n                                    <tr key={i} className=\"border-b border-gray-50\">\n                                        {Array.from({ length: isTeacher ? 12 : 13 }).map((_, j) => (\n                                            <td key={j} className=\"py-3 px-2\">\n                                                <div className=\"h-4 bg-gray-200 rounded animate-pulse\"></div>\n                                            </td>\n                                        ))}\n                                    </tr>\n                                ))\n                            ) : students.length === 0 ? (\n                                <tr>\n                                    <td colSpan={isTeacher ? 12 : 13} className=\"py-12 text-center text-gray-500\">\n                                        {isTeacher ? 'No teachers found' : 'No students found'}\n                                    </td>\n                                </tr>\n                            ) : (\n                                students.map(student => (\n                                    <tr key={student.userid} className=\"border-b border-gray-50 hover:bg-gray-50\">\n                                        <td className=\"py-3 px-2 font-medium text-gray-800\">{student.fullname}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{student.sdms_id}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{isTeacher ? (student.position || '-') : (student.program || '-')}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{student.gender || '-'}</td>\n                                        {!isTeacher && <td className=\"py-3 px-2 text-gray-600\">{student.age !== null && student.age !== undefined ? student.age : '-'}</td>}\n                                        <td className=\"py-3 px-2 text-gray-600\">{student.school_name || '-'}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">\n                                            {canManage && editingUserId === student.userid ? (\n                                                <div className=\"flex items-center gap-1\">\n                                                    <select\n                                                        className=\"px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500\"\n                                                        value={editingSchoolCode}\n                                                        onChange={(e) => setEditingSchoolCode((e.target as HTMLSelectElement).value)}\n                                                        disabled={saving}\n                                                    >\n                                                        <option value=\"\">Select school...</option>\n                                                        {schoolsList.map(s => (\n                                                            <option key={s.school_code} value={s.school_code}>\n                                                                {s.school_code} - {s.school_name}\n                                                            </option>\n                                                        ))}\n                                                    </select>\n                                                    <button\n                                                        onClick={() => handleSaveSchool(student.userid)}\n                                                        disabled={saving || !editingSchoolCode}\n                                                        className=\"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50\"\n                                                    >\n                                                        {saving ? '...' : 'Save'}\n                                                    </button>\n                                                    <button\n                                                        onClick={() => setEditingUserId(null)}\n                                                        disabled={saving}\n                                                        className=\"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50\"\n                                                    >\n                                                        Cancel\n                                                    </button>\n                                                </div>\n                                            ) : canManage ? (\n                                                <button\n                                                    className=\"text-blue-600 hover:text-blue-800 hover:underline cursor-pointer text-left\"\n                                                    onClick={() => {\n                                                        setEditingUserId(student.userid);\n                                                        setEditingSchoolCode(student.school_code || '');\n                                                    }}\n                                                    title=\"Click to change school\"\n                                                >\n                                                    {student.school_code || '-'}\n                                                </button>\n                                            ) : (\n                                                student.school_code || '-'\n                                            )}\n                                        </td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{formatTimeAgo(student.last_access)}</td>\n                                        <td className=\"py-3 px-2 text-gray-800\">{student.active_days}</td>\n                                        <td className=\"py-3 px-2 text-gray-800\">{student.total_actions}</td>\n                                        <td className=\"py-3 px-2 text-gray-800\">\n                                            {student.quizzes_avg_score !== null && student.quizzes_avg_score !== undefined\n                                                ? `${student.quizzes_avg_score}%` : '-'}\n                                        </td>\n                                        <td className=\"py-3 px-2\">\n                                            {student.course_progress !== null && student.course_progress !== undefined ? (\n                                                <div className=\"flex items-center gap-2\">\n                                                    <div className=\"w-16 h-2 bg-gray-200 rounded-full overflow-hidden\">\n                                                        <div\n                                                            className=\"h-full bg-blue-500 rounded-full\"\n                                                            style={{ width: `${student.course_progress}%` }}\n                                                        />\n                                                    </div>\n                                                    <span className=\"text-xs text-gray-600\">{student.course_progress}%</span>\n                                                </div>\n                                            ) : '-'}\n                                        </td>\n                                        <td className=\"py-3 px-2\">\n                                            <StatusBadge status={student.status} />\n                                        </td>\n                                    </tr>\n                                ))\n                            )}\n                        </tbody>\n                    </table>\n                </div>\n\n                {/* Pagination */}\n                {totalCount > 0 && (\n                    <div className=\"flex items-center justify-between px-4 py-3 border-t border-gray-100\">\n                        <span className=\"text-sm text-gray-600\">\n                            {startItem}-{endItem} of {totalCount.toLocaleString()}\n                        </span>\n                        <div className=\"flex gap-2\">\n                            <button\n                                onClick={() => setPage(Math.max(0, page - 1))}\n                                disabled={page === 0}\n                                className=\"px-3 py-1 text-sm border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                            >\n                                Previous\n                            </button>\n                            <span className=\"px-3 py-1 text-sm text-gray-600\">\n                                Page {page + 1} of {totalPages}\n                            </span>\n                            <button\n                                onClick={() => setPage(Math.min(totalPages - 1, page + 1))}\n                                disabled={page >= totalPages - 1}\n                                className=\"px-3 py-1 text-sm border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                            >\n                                Next\n                            </button>\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Traffic report component for Elby Dashboard.\n *\n * Shows daily/weekly/monthly platform traffic trends as a bar chart.\n *\n * @module     local_elby_dashboard/components/TrafficReport\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport type { TrafficDataPoint } from '../types';\n\n// @ts-ignore\ndeclare const require: (deps: string[], callback: (...args: any[]) => void) => void;\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\ntype Period = 'daily' | 'weekly' | 'monthly';\n\nexport default function TrafficReport() {\n    const [data, setData] = useState<TrafficDataPoint[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [period, setPeriod] = useState<Period>('daily');\n    const [daysBack, setDaysBack] = useState(30);\n\n    useEffect(() => {\n        loadTraffic();\n    }, [period, daysBack]);\n\n    async function loadTraffic() {\n        try {\n            setLoading(true);\n            const result = await ajaxCall('local_elby_dashboard_get_platform_traffic', {\n                period,\n                days_back: daysBack,\n            });\n            setData(result.data || []);\n        } catch (err) {\n            console.error('Failed to load traffic data:', err);\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    // Compute max for bar scaling.\n    const maxActions = Math.max(...data.map(d => d.total_actions), 1);\n    const maxUsers = Math.max(...data.map(d => d.unique_users), 1);\n    const totalActions = data.reduce((sum, d) => sum + d.total_actions, 0);\n    const totalUniqueUsers = data.length > 0 ? Math.max(...data.map(d => d.unique_users)) : 0;\n    const avgActions = data.length > 0 ? Math.round(totalActions / data.length) : 0;\n\n    function handleExportCsv() {\n        const headers = ['Period', 'Total Actions', 'Unique Users'];\n        const rows = data.map(d => [d.period_label, String(d.total_actions), String(d.unique_users)]);\n        const csv = [headers, ...rows].map(r => r.map(c => `\"${c}\"`).join(',')).join('\\n');\n        const blob = new Blob([csv], { type: 'text/csv' });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `traffic_${period}_${daysBack}d.csv`;\n        a.click();\n        URL.revokeObjectURL(url);\n    }\n\n    if (loading) {\n        return (\n            <div className=\"p-6\">\n                <div className=\"animate-pulse space-y-4\">\n                    <div className=\"h-8 bg-gray-200 rounded w-48\"></div>\n                    <div className=\"grid grid-cols-3 gap-4\">\n                        {[1, 2, 3].map(i => <div key={i} className=\"h-20 bg-gray-200 rounded-xl\"></div>)}\n                    </div>\n                    <div className=\"h-64 bg-gray-200 rounded-xl\"></div>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"p-4 lg:p-6\">\n            {/* Summary Cards */}\n            <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6\">\n                <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                    <p className=\"text-xs text-gray-500 font-medium\">Total Actions</p>\n                    <p className=\"text-2xl font-bold text-gray-800\">{totalActions.toLocaleString()}</p>\n                </div>\n                <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                    <p className=\"text-xs text-gray-500 font-medium\">Peak Unique Users</p>\n                    <p className=\"text-2xl font-bold text-blue-600\">{totalUniqueUsers.toLocaleString()}</p>\n                </div>\n                <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                    <p className=\"text-xs text-gray-500 font-medium\">Avg Actions / {period === 'daily' ? 'Day' : period === 'weekly' ? 'Week' : 'Month'}</p>\n                    <p className=\"text-2xl font-bold text-green-600\">{avgActions.toLocaleString()}</p>\n                </div>\n            </div>\n\n            {/* Controls */}\n            <div className=\"bg-white rounded-xl p-4 shadow-sm mb-6\">\n                <div className=\"flex flex-wrap items-center gap-3\">\n                    <div className=\"flex gap-1 bg-gray-100 rounded-lg p-1\">\n                        {(['daily', 'weekly', 'monthly'] as Period[]).map(p => (\n                            <button\n                                key={p}\n                                onClick={() => setPeriod(p)}\n                                className={`px-3 py-1.5 text-sm rounded-md transition-colors ${\n                                    period === p ? 'bg-white shadow-sm text-blue-600 font-medium' : 'text-gray-600 hover:text-gray-800'\n                                }`}\n                            >\n                                {p.charAt(0).toUpperCase() + p.slice(1)}\n                            </button>\n                        ))}\n                    </div>\n\n                    <select\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={daysBack}\n                        onChange={(e) => setDaysBack(Number((e.target as HTMLSelectElement).value))}\n                    >\n                        <option value={7}>Last 7 days</option>\n                        <option value={30}>Last 30 days</option>\n                        <option value={90}>Last 90 days</option>\n                        <option value={180}>Last 6 months</option>\n                        <option value={365}>Last year</option>\n                    </select>\n\n                    <button\n                        onClick={handleExportCsv}\n                        className=\"px-4 py-2 text-sm border border-gray-200 rounded-lg hover:bg-gray-50 ml-auto\"\n                    >\n                        Export CSV\n                    </button>\n                </div>\n            </div>\n\n            {/* Chart */}\n            <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                {data.length === 0 ? (\n                    <div className=\"text-center py-12 text-gray-500\">No traffic data available for this period</div>\n                ) : (\n                    <div>\n                        {/* Legend */}\n                        <div className=\"flex items-center gap-4 mb-4 text-xs text-gray-500\">\n                            <div className=\"flex items-center gap-1\">\n                                <div className=\"w-3 h-3 rounded bg-blue-500\"></div>\n                                <span>Total Actions</span>\n                            </div>\n                            <div className=\"flex items-center gap-1\">\n                                <div className=\"w-3 h-3 rounded bg-green-500\"></div>\n                                <span>Unique Users</span>\n                            </div>\n                        </div>\n\n                        {/* Bar chart */}\n                        <div className=\"overflow-x-auto\">\n                            <div className=\"flex items-end gap-1 min-w-fit\" style={{ height: '240px' }}>\n                                {data.map((d, i) => (\n                                    <div key={i} className=\"flex flex-col items-center gap-1 flex-1 min-w-[24px] max-w-[48px]\" style={{ height: '100%' }}>\n                                        <div className=\"flex-1 flex items-end gap-0.5 w-full\">\n                                            <div\n                                                className=\"flex-1 bg-blue-500 rounded-t opacity-80 hover:opacity-100 transition-opacity\"\n                                                style={{ height: `${(d.total_actions / maxActions) * 100}%`, minHeight: '2px' }}\n                                                title={`${d.period_label}: ${d.total_actions.toLocaleString()} actions`}\n                                            />\n                                            <div\n                                                className=\"flex-1 bg-green-500 rounded-t opacity-80 hover:opacity-100 transition-opacity\"\n                                                style={{ height: `${(d.unique_users / maxActions) * 100}%`, minHeight: '2px' }}\n                                                title={`${d.period_label}: ${d.unique_users.toLocaleString()} users`}\n                                            />\n                                        </div>\n                                        <span className=\"text-[9px] text-gray-400 truncate w-full text-center\" title={d.period_label}>\n                                            {d.period_label.length > 5 ? d.period_label.slice(-5) : d.period_label}\n                                        </span>\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n\n                        {/* Table fallback */}\n                        <details className=\"mt-4\">\n                            <summary className=\"text-sm text-gray-500 cursor-pointer hover:text-gray-700\">Show data table</summary>\n                            <table className=\"w-full text-sm mt-2\">\n                                <thead>\n                                    <tr className=\"text-left text-gray-500 border-b border-gray-100\">\n                                        <th className=\"pb-2 font-medium\">Period</th>\n                                        <th className=\"pb-2 font-medium text-right\">Actions</th>\n                                        <th className=\"pb-2 font-medium text-right\">Unique Users</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {data.map((d, i) => (\n                                        <tr key={i} className=\"border-b border-gray-50\">\n                                            <td className=\"py-2 text-gray-700\">{d.period_label}</td>\n                                            <td className=\"py-2 text-right text-gray-800\">{d.total_actions.toLocaleString()}</td>\n                                            <td className=\"py-2 text-right text-gray-800\">{d.unique_users.toLocaleString()}</td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        </details>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Access log component for Elby Dashboard.\n *\n * Paginated table showing who accessed what course, from which school, when.\n *\n * @module     local_elby_dashboard/components/AccessLog\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport type { AccessLogEntry, AccessLogResponse } from '../types';\n\n// @ts-ignore\ndeclare const require: (deps: string[], callback: (...args: any[]) => void) => void;\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\nfunction formatDateTime(timestamp: number): string {\n    if (!timestamp) return '-';\n    return new Date(timestamp * 1000).toLocaleString();\n}\n\nfunction toDateInputValue(timestamp: number): string {\n    const d = new Date(timestamp * 1000);\n    return d.toISOString().split('T')[0];\n}\n\nfunction fromDateInput(value: string): number {\n    if (!value) return 0;\n    return Math.floor(new Date(value).getTime() / 1000);\n}\n\nexport default function AccessLog() {\n    const [entries, setEntries] = useState<AccessLogEntry[]>([]);\n    const [totalCount, setTotalCount] = useState(0);\n    const [loading, setLoading] = useState(true);\n    const [page, setPage] = useState(0);\n    const [perpage] = useState(10);\n    const [sort, setSort] = useState('access_time');\n    const [order, setOrder] = useState('DESC');\n\n    // Default: last 7 days.\n    const now = Math.floor(Date.now() / 1000);\n    const [dateFrom, setDateFrom] = useState(now - 7 * 86400);\n    const [dateTo, setDateTo] = useState(now);\n    const [schoolCode, setSchoolCode] = useState('');\n    const [userType, setUserType] = useState('');\n    const [search, setSearch] = useState('');\n    const [searchInput, setSearchInput] = useState('');\n\n    useEffect(() => {\n        loadLog();\n    }, [page, sort, order, dateFrom, dateTo, schoolCode, userType, search]);\n\n    async function loadLog() {\n        try {\n            setLoading(true);\n            const result: AccessLogResponse = await ajaxCall('local_elby_dashboard_get_user_access_log', {\n                date_from: dateFrom,\n                date_to: dateTo,\n                school_code: schoolCode,\n                courseid: 0,\n                user_type: userType,\n                search,\n                sort,\n                order,\n                page,\n                perpage,\n            });\n            setEntries(result.entries);\n            setTotalCount(result.total_count);\n        } catch (err) {\n            console.error('Failed to load access log:', err);\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    function handleSort(field: string) {\n        if (sort === field) {\n            setOrder(order === 'ASC' ? 'DESC' : 'ASC');\n        } else {\n            setSort(field);\n            setOrder('DESC');\n        }\n        setPage(0);\n    }\n\n    function handleSearch() {\n        setSearch(searchInput);\n        setPage(0);\n    }\n\n    function handleExportCsv() {\n        const headers = ['User', 'SDMS ID', 'Type', 'School', 'School Code', 'Course', 'Action', 'Target', 'Time'];\n        const rows = entries.map(e => [\n            e.user_fullname,\n            e.sdms_id,\n            e.user_type,\n            e.school_name,\n            e.school_code,\n            e.course_name,\n            e.action,\n            e.target,\n            e.access_time ? new Date(e.access_time * 1000).toISOString() : '',\n        ]);\n        const csv = [headers, ...rows].map(r => r.map(c => `\"${c}\"`).join(',')).join('\\n');\n        const blob = new Blob([csv], { type: 'text/csv' });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = 'access_log.csv';\n        a.click();\n        URL.revokeObjectURL(url);\n    }\n\n    const totalPages = Math.ceil(totalCount / perpage);\n    const startItem = page * perpage + 1;\n    const endItem = Math.min((page + 1) * perpage, totalCount);\n\n    // Sort icon helper\n    function SortIcon({ field }: { field: string }) {\n        if (field !== sort) {\n            return (\n                <svg className=\"w-3 h-3 text-gray-400 ml-1 inline\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path d=\"M7 10l5-5 5 5H7zm0 4l5 5 5-5H7z\" />\n                </svg>\n            );\n        }\n        return order === 'ASC' ? (\n            <svg className=\"w-3 h-3 text-blue-600 ml-1 inline\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path d=\"M7 14l5-5 5 5H7z\" />\n            </svg>\n        ) : (\n            <svg className=\"w-3 h-3 text-blue-600 ml-1 inline\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path d=\"M7 10l5 5 5-5H7z\" />\n            </svg>\n        );\n    }\n\n    const sortableHeader = (label: string, field: string) => (\n        <th\n            className=\"pb-3 font-medium cursor-pointer hover:text-gray-800 select-none whitespace-nowrap\"\n            onClick={() => handleSort(field)}\n        >\n            {label}\n            <SortIcon field={field} />\n        </th>\n    );\n\n    return (\n        <div className=\"p-4 lg:p-6\">\n            {/* Filters */}\n            <div className=\"bg-white rounded-xl p-4 shadow-sm mb-6\">\n                <div className=\"flex flex-wrap items-center gap-3\">\n                    {/* Search */}\n                    <div className=\"flex-1 min-w-[200px] flex gap-2\">\n                        <input\n                            type=\"text\"\n                            placeholder=\"Search by name or SDMS ID...\"\n                            className=\"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            value={searchInput}\n                            onInput={(e) => setSearchInput((e.target as HTMLInputElement).value)}\n                            onKeyDown={(e) => { if (e.key === 'Enter') handleSearch(); }}\n                        />\n                        <button\n                            onClick={handleSearch}\n                            className=\"px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700\"\n                        >\n                            Search\n                        </button>\n                    </div>\n\n                    {/* Date range */}\n                    <input\n                        type=\"date\"\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={toDateInputValue(dateFrom)}\n                        onChange={(e) => {\n                            setDateFrom(fromDateInput((e.target as HTMLInputElement).value));\n                            setPage(0);\n                        }}\n                    />\n                    <span className=\"text-gray-400 text-sm\">to</span>\n                    <input\n                        type=\"date\"\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={toDateInputValue(dateTo)}\n                        onChange={(e) => {\n                            setDateTo(fromDateInput((e.target as HTMLInputElement).value) + 86399);\n                            setPage(0);\n                        }}\n                    />\n\n                    {/* School filter */}\n                    <input\n                        type=\"text\"\n                        placeholder=\"School code\"\n                        className=\"w-32 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={schoolCode}\n                        onInput={(e) => {\n                            setSchoolCode((e.target as HTMLInputElement).value);\n                            setPage(0);\n                        }}\n                    />\n\n                    {/* User type filter */}\n                    <select\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={userType}\n                        onChange={(e) => {\n                            setUserType((e.target as HTMLSelectElement).value);\n                            setPage(0);\n                        }}\n                    >\n                        <option value=\"\">All Users</option>\n                        <option value=\"student\">Students</option>\n                        <option value=\"teacher\">Teachers</option>\n                    </select>\n\n                    {/* Export */}\n                    <button\n                        onClick={handleExportCsv}\n                        className=\"px-4 py-2 text-sm border border-gray-200 rounded-lg hover:bg-gray-50\"\n                    >\n                        Export CSV\n                    </button>\n                </div>\n            </div>\n\n            {/* Table */}\n            <div className=\"bg-white rounded-xl shadow-sm overflow-hidden\">\n                <div className=\"overflow-x-auto\">\n                    <table className=\"w-full text-sm\">\n                        <thead>\n                            <tr className=\"text-left text-gray-500 border-b border-gray-100\">\n                                {sortableHeader('Time', 'access_time')}\n                                {sortableHeader('User', 'user_fullname')}\n                                <th className=\"pb-3 font-medium\">SDMS ID</th>\n                                <th className=\"pb-3 font-medium\">Type</th>\n                                {sortableHeader('School', 'school_name')}\n                                {sortableHeader('Course', 'course_name')}\n                                <th className=\"pb-3 font-medium\">Action</th>\n                                <th className=\"pb-3 font-medium\">Target</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {loading ? (\n                                Array.from({ length: 5 }).map((_, i) => (\n                                    <tr key={i} className=\"border-b border-gray-50\">\n                                        {Array.from({ length: 8 }).map((_, j) => (\n                                            <td key={j} className=\"py-3 px-2\">\n                                                <div className=\"h-4 bg-gray-200 rounded animate-pulse\"></div>\n                                            </td>\n                                        ))}\n                                    </tr>\n                                ))\n                            ) : entries.length === 0 ? (\n                                <tr>\n                                    <td colSpan={8} className=\"py-12 text-center text-gray-500\">\n                                        No access log entries found\n                                    </td>\n                                </tr>\n                            ) : (\n                                entries.map((entry, idx) => (\n                                    <tr key={idx} className=\"border-b border-gray-50 hover:bg-gray-50\">\n                                        <td className=\"py-3 px-2 text-gray-600 whitespace-nowrap\">{formatDateTime(entry.access_time)}</td>\n                                        <td className=\"py-3 px-2 font-medium text-gray-800\">{entry.user_fullname}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{entry.sdms_id || '-'}</td>\n                                        <td className=\"py-3 px-2\">\n                                            {entry.user_type ? (\n                                                <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${\n                                                    entry.user_type === 'teacher' ? 'bg-purple-100 text-purple-700' : 'bg-blue-100 text-blue-700'\n                                                }`}>\n                                                    {entry.user_type}\n                                                </span>\n                                            ) : '-'}\n                                        </td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{entry.school_name || '-'}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{entry.course_name || '-'}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{entry.action}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{entry.target}</td>\n                                    </tr>\n                                ))\n                            )}\n                        </tbody>\n                    </table>\n                </div>\n\n                {/* Pagination */}\n                {totalCount > 0 && (\n                    <div className=\"flex items-center justify-between px-4 py-3 border-t border-gray-100\">\n                        <span className=\"text-sm text-gray-600\">\n                            {startItem}-{endItem} of {totalCount.toLocaleString()}\n                        </span>\n                        <div className=\"flex gap-2\">\n                            <button\n                                onClick={() => setPage(Math.max(0, page - 1))}\n                                disabled={page === 0}\n                                className=\"px-3 py-1 text-sm border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                            >\n                                Previous\n                            </button>\n                            <span className=\"px-3 py-1 text-sm text-gray-600\">\n                                Page {page + 1} of {totalPages}\n                            </span>\n                            <button\n                                onClick={() => setPage(Math.min(totalPages - 1, page + 1))}\n                                disabled={page >= totalPages - 1}\n                                className=\"px-3 py-1 text-sm border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                            >\n                                Next\n                            </button>\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Admin panel component for Elby Dashboard.\n *\n * Displays sync status, logs, manual triggers, and cache stats.\n *\n * @module     local_elby_dashboard/components/AdminPanel\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect, useRef } from 'preact/hooks';\nimport type { UnlinkedUser } from '../types';\n\n// @ts-ignore\ndeclare const require: (deps: string[], callback: (...args: any[]) => void) => void;\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\ninterface AdminStats {\n    linked_users: number;\n    stale_users: number;\n    error_users: number;\n    total_schools: number;\n    user_metrics_count: number;\n    school_metrics_count: number;\n}\n\ninterface SyncLogEntry {\n    id: number;\n    sync_type: string;\n    entity_id: string;\n    operation: string;\n    error_message: string | null;\n    triggered_by: string;\n    timecreated: number;\n}\n\ninterface LookupPreview {\n    sdms_id: string;\n    status: string;\n    academic_year: string;\n    school_name: string;\n    student_name: string;\n    program: string;\n    position: string;\n    user_type: string;\n}\n\nfunction formatTimestamp(ts: number): string {\n    if (!ts) return 'Never';\n    return new Date(ts * 1000).toLocaleString();\n}\n\nfunction StatCard({ label, value, icon, color }: { label: string; value: number | string; icon: JSX.Element; color: string }) {\n    return (\n        <div className={`rounded-xl p-4 ${color}`}>\n            <div className=\"flex items-center gap-3\">\n                <div className=\"w-10 h-10 rounded-full bg-white/40 flex items-center justify-center\">\n                    {icon}\n                </div>\n                <div>\n                    <p className=\"text-2xl font-bold text-gray-800\">{value}</p>\n                    <p className=\"text-xs text-gray-600\">{label}</p>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nfunction OperationBadge({ operation }: { operation: string }) {\n    const colors: Record<string, string> = {\n        create: 'bg-green-100 text-green-700',\n        update: 'bg-blue-100 text-blue-700',\n        skip: 'bg-gray-100 text-gray-700',\n        error: 'bg-red-100 text-red-700',\n    };\n    return (\n        <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${colors[operation] || 'bg-gray-100 text-gray-700'}`}>\n            {operation}\n        </span>\n    );\n}\n\nfunction LinkUserSection({ onLinked }: { onLinked: () => void }) {\n    const [search, setSearch] = useState('');\n    const [users, setUsers] = useState<UnlinkedUser[]>([]);\n    const [searching, setSearching] = useState(false);\n    const [totalCount, setTotalCount] = useState(0);\n    const [selectedUser, setSelectedUser] = useState<UnlinkedUser | null>(null);\n    const [sdmsCode, setSdmsCode] = useState('');\n    const [userType, setUserType] = useState('student');\n    const [lookupPreview, setLookupPreview] = useState<LookupPreview | null>(null);\n    const [lookingUp, setLookingUp] = useState(false);\n    const [linking, setLinking] = useState(false);\n    const [linkNotification, setLinkNotification] = useState<{ type: 'success' | 'error'; message: string } | null>(null);\n    const searchTimer = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n    function handleSearchChange(value: string) {\n        setSearch(value);\n        setSelectedUser(null);\n        setLookupPreview(null);\n        setLinkNotification(null);\n\n        if (searchTimer.current) clearTimeout(searchTimer.current);\n        if (value.trim().length < 2) {\n            setUsers([]);\n            setTotalCount(0);\n            return;\n        }\n        searchTimer.current = setTimeout(() => doSearch(value.trim()), 400);\n    }\n\n    async function doSearch(term: string) {\n        setSearching(true);\n        try {\n            const result = await ajaxCall('local_elby_dashboard_search_unlinked_users', {\n                search: term, page: 0, perpage: 20\n            });\n            setUsers(result.users || []);\n            setTotalCount(result.total_count || 0);\n        } catch {\n            setUsers([]);\n        } finally {\n            setSearching(false);\n        }\n    }\n\n    async function handleLookup() {\n        if (!sdmsCode.trim()) return;\n        setLookingUp(true);\n        setLookupPreview(null);\n        setLinkNotification(null);\n        try {\n            const result = await ajaxCall('local_elby_dashboard_lookup_sdms_user', {\n                sdms_code: sdmsCode.trim(), user_type: userType\n            });\n            if (!result.success) {\n                setLinkNotification({ type: 'error', message: result.error || 'Not found in SDMS' });\n                return;\n            }\n            const name = result.student_data?.names || '';\n            setLookupPreview({\n                sdms_id: result.sdms_id,\n                status: result.status || '',\n                academic_year: result.academic_year || '',\n                school_name: result.school?.school_name || '',\n                student_name: name,\n                program: result.student_data?.program || '',\n                position: result.staff_data?.position || '',\n                user_type: userType,\n            });\n        } catch (err: any) {\n            setLinkNotification({ type: 'error', message: err?.message || 'Lookup failed' });\n        } finally {\n            setLookingUp(false);\n        }\n    }\n\n    async function handleLink() {\n        if (!selectedUser || !sdmsCode.trim()) return;\n        setLinking(true);\n        setLinkNotification(null);\n        try {\n            const result = await ajaxCall('local_elby_dashboard_link_user', {\n                userid: selectedUser.userid, sdms_code: sdmsCode.trim(), user_type: userType\n            });\n            if (result.success) {\n                setLinkNotification({ type: 'success', message: `Successfully linked ${selectedUser.fullname} to ${sdmsCode}` });\n                setSelectedUser(null);\n                setSdmsCode('');\n                setLookupPreview(null);\n                // Remove linked user from list.\n                setUsers(prev => prev.filter(u => u.userid !== selectedUser.userid));\n                onLinked();\n            } else {\n                setLinkNotification({ type: 'error', message: result.error || 'Link failed' });\n            }\n        } catch (err: any) {\n            setLinkNotification({ type: 'error', message: err?.message || 'Link failed' });\n        } finally {\n            setLinking(false);\n        }\n    }\n\n    return (\n        <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n            <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Link User to SDMS</h3>\n\n            {linkNotification && (\n                <div className={`mb-4 px-4 py-3 rounded-lg text-sm ${\n                    linkNotification.type === 'success'\n                        ? 'bg-green-50 text-green-800 border border-green-200'\n                        : 'bg-red-50 text-red-800 border border-red-200'\n                }`}>\n                    {linkNotification.message}\n                    <button onClick={() => setLinkNotification(null)} className=\"float-right text-lg leading-none opacity-60 hover:opacity-100\">&times;</button>\n                </div>\n            )}\n\n            {/* Search unlinked users */}\n            <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Search Unlinked Users</label>\n                <input\n                    type=\"text\"\n                    value={search}\n                    onInput={(e) => handleSearchChange((e.target as HTMLInputElement).value)}\n                    placeholder=\"Search by name, username, or email...\"\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                />\n                {searching && <p className=\"text-xs text-gray-400 mt-1\">Searching...</p>}\n                {!searching && totalCount > 0 && (\n                    <p className=\"text-xs text-gray-500 mt-1\">{totalCount} unlinked user{totalCount !== 1 ? 's' : ''} found</p>\n                )}\n            </div>\n\n            {/* Results list */}\n            {users.length > 0 && !selectedUser && (\n                <div className=\"mb-4 max-h-48 overflow-y-auto border border-gray-200 rounded-lg\">\n                    {users.map(user => (\n                        <button\n                            key={user.userid}\n                            onClick={() => { setSelectedUser(user); setSdmsCode(''); setLookupPreview(null); setLinkNotification(null); }}\n                            className=\"w-full text-left px-4 py-2 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 transition-colors\"\n                        >\n                            <p className=\"text-sm font-medium text-gray-800\">{user.fullname}</p>\n                            <p className=\"text-xs text-gray-500\">{user.username} &middot; {user.email}</p>\n                        </button>\n                    ))}\n                </div>\n            )}\n\n            {/* Selected user - link form */}\n            {selectedUser && (\n                <div className=\"border border-blue-200 bg-blue-50 rounded-lg p-4 mb-4\">\n                    <div className=\"flex items-center justify-between mb-3\">\n                        <div>\n                            <p className=\"text-sm font-semibold text-gray-800\">{selectedUser.fullname}</p>\n                            <p className=\"text-xs text-gray-500\">{selectedUser.username} &middot; {selectedUser.email}</p>\n                        </div>\n                        <button\n                            onClick={() => { setSelectedUser(null); setLookupPreview(null); }}\n                            className=\"text-gray-400 hover:text-gray-600 text-lg\"\n                        >&times;</button>\n                    </div>\n\n                    <div className=\"flex gap-2 mb-3\">\n                        <input\n                            type=\"text\"\n                            value={sdmsCode}\n                            onInput={(e) => setSdmsCode((e.target as HTMLInputElement).value)}\n                            placeholder=\"Enter SDMS code...\"\n                            className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm\"\n                        />\n                        <select\n                            value={userType}\n                            onChange={(e) => setUserType((e.target as HTMLSelectElement).value)}\n                            className=\"px-3 py-2 border border-gray-300 rounded-lg text-sm\"\n                        >\n                            <option value=\"student\">Student</option>\n                            <option value=\"staff\">Staff</option>\n                        </select>\n                        <button\n                            onClick={handleLookup}\n                            disabled={lookingUp || !sdmsCode.trim()}\n                            className=\"px-4 py-2 bg-gray-600 text-white rounded-lg text-sm hover:bg-gray-700 disabled:opacity-50\"\n                        >\n                            {lookingUp ? '...' : 'Lookup'}\n                        </button>\n                    </div>\n\n                    {/* Lookup preview */}\n                    {lookupPreview && (\n                        <div className=\"bg-white rounded-lg p-3 mb-3 border border-gray-200\">\n                            <p className=\"text-sm font-medium text-gray-800 mb-1\">SDMS Preview</p>\n                            <div className=\"grid grid-cols-2 gap-1 text-xs\">\n                                <span className=\"text-gray-500\">SDMS ID:</span>\n                                <span className=\"text-gray-800\">{lookupPreview.sdms_id}</span>\n                                {lookupPreview.student_name && <>\n                                    <span className=\"text-gray-500\">Name:</span>\n                                    <span className=\"text-gray-800\">{lookupPreview.student_name}</span>\n                                </>}\n                                <span className=\"text-gray-500\">School:</span>\n                                <span className=\"text-gray-800\">{lookupPreview.school_name || '-'}</span>\n                                <span className=\"text-gray-500\">Status:</span>\n                                <span className=\"text-gray-800\">{lookupPreview.status || '-'}</span>\n                                {lookupPreview.program && <>\n                                    <span className=\"text-gray-500\">Program:</span>\n                                    <span className=\"text-gray-800\">{lookupPreview.program}</span>\n                                </>}\n                                {lookupPreview.position && <>\n                                    <span className=\"text-gray-500\">Position:</span>\n                                    <span className=\"text-gray-800\">{lookupPreview.position}</span>\n                                </>}\n                            </div>\n                        </div>\n                    )}\n\n                    {lookupPreview && (\n                        <button\n                            onClick={handleLink}\n                            disabled={linking}\n                            className=\"w-full px-4 py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700 disabled:opacity-50\"\n                        >\n                            {linking ? 'Linking...' : `Link ${selectedUser.fullname} to ${sdmsCode}`}\n                        </button>\n                    )}\n                </div>\n            )}\n        </div>\n    );\n}\n\nexport default function AdminPanel() {\n    const [stats, setStats] = useState<AdminStats | null>(null);\n    const [logs, setLogs] = useState<SyncLogEntry[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [syncing, setSyncing] = useState<string | null>(null);\n    const [notification, setNotification] = useState<{ type: 'success' | 'error'; message: string } | null>(null);\n\n    useEffect(() => {\n        loadAdminData();\n    }, []);\n\n    async function loadAdminData() {\n        try {\n            setLoading(true);\n            // Read pre-loaded admin stats from data attributes.\n            const container = document.getElementById('elby-dashboard-root');\n            const adminDataAttr = container?.getAttribute('data-admin');\n            if (adminDataAttr) {\n                try {\n                    const data = JSON.parse(adminDataAttr);\n                    setStats(data.stats);\n                    setLogs(data.logs || []);\n                } catch (e) {\n                    console.error('Failed to parse admin data:', e);\n                }\n            }\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    async function handleManualSync(type: string) {\n        setSyncing(type);\n        setNotification(null);\n        try {\n            const taskMap: Record<string, string> = {\n                user_metrics: 'compute_user_metrics',\n                school_metrics: 'aggregate_school_metrics',\n                sdms_cache: 'refresh_sdms_cache',\n            };\n            const taskName = taskMap[type];\n            if (!taskName) return;\n\n            const result = await ajaxCall('local_elby_dashboard_trigger_task', { task_name: taskName });\n            if (result.success) {\n                setNotification({ type: 'success', message: result.message });\n                loadAdminData();\n            } else {\n                setNotification({ type: 'error', message: result.message });\n            }\n        } catch (err: any) {\n            setNotification({ type: 'error', message: err?.message || 'Failed to run task' });\n        } finally {\n            setSyncing(null);\n        }\n    }\n\n    if (loading) {\n        return (\n            <div className=\"p-6 animate-pulse space-y-4\">\n                <div className=\"h-8 bg-gray-200 rounded w-48\"></div>\n                <div className=\"grid grid-cols-2 lg:grid-cols-3 gap-4\">\n                    {[1, 2, 3, 4, 5, 6].map(i => <div key={i} className=\"h-20 bg-gray-200 rounded-xl\"></div>)}\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"p-4 lg:p-6\">\n            {/* Stats Cards */}\n            {stats && (\n                <div className=\"grid grid-cols-2 lg:grid-cols-3 gap-4 mb-6\">\n                    <StatCard\n                        label=\"Linked Users\"\n                        value={stats.linked_users}\n                        color=\"bg-cyan-50\"\n                        icon={<svg className=\"w-5 h-5 text-cyan-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5z\"/></svg>}\n                    />\n                    <StatCard\n                        label=\"Stale Records\"\n                        value={stats.stale_users}\n                        color=\"bg-yellow-50\"\n                        icon={<svg className=\"w-5 h-5 text-yellow-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z\"/></svg>}\n                    />\n                    <StatCard\n                        label=\"Sync Errors\"\n                        value={stats.error_users}\n                        color=\"bg-red-50\"\n                        icon={<svg className=\"w-5 h-5 text-red-500\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z\"/></svg>}\n                    />\n                    <StatCard\n                        label=\"Schools\"\n                        value={stats.total_schools}\n                        color=\"bg-blue-50\"\n                        icon={<svg className=\"w-5 h-5 text-blue-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3z\"/></svg>}\n                    />\n                    <StatCard\n                        label=\"User Metrics\"\n                        value={stats.user_metrics_count.toLocaleString()}\n                        color=\"bg-green-50\"\n                        icon={<svg className=\"w-5 h-5 text-green-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/></svg>}\n                    />\n                    <StatCard\n                        label=\"School Metrics\"\n                        value={stats.school_metrics_count.toLocaleString()}\n                        color=\"bg-purple-50\"\n                        icon={<svg className=\"w-5 h-5 text-purple-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/></svg>}\n                    />\n                </div>\n            )}\n\n            {notification && (\n                <div className={`mb-4 px-4 py-3 rounded-lg text-sm ${\n                    notification.type === 'success'\n                        ? 'bg-green-50 text-green-800 border border-green-200'\n                        : 'bg-red-50 text-red-800 border border-red-200'\n                }`}>\n                    {notification.message}\n                    <button onClick={() => setNotification(null)} className=\"float-right text-lg leading-none opacity-60 hover:opacity-100\">&times;</button>\n                </div>\n            )}\n\n            {/* Link User to SDMS */}\n            <div className=\"mb-6\">\n                <LinkUserSection onLinked={loadAdminData} />\n            </div>\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                {/* Manual Sync Triggers */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Manual Sync Triggers</h3>\n                    <p className=\"text-sm text-gray-500 mb-4\">\n                        Run scheduled tasks manually from Site Admin &gt; Server &gt; Scheduled Tasks, or use the buttons below.\n                    </p>\n                    <div className=\"space-y-3\">\n                        <button\n                            onClick={() => handleManualSync('user_metrics')}\n                            disabled={syncing !== null}\n                            className=\"w-full flex items-center justify-between px-4 py-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50\"\n                        >\n                            <div>\n                                <p className=\"text-sm font-medium text-gray-800\">Compute User Metrics</p>\n                                <p className=\"text-xs text-gray-500\">Hourly task - aggregates logstore data</p>\n                            </div>\n                            {syncing === 'user_metrics' && (\n                                <div className=\"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\n                            )}\n                        </button>\n                        <button\n                            onClick={() => handleManualSync('school_metrics')}\n                            disabled={syncing !== null}\n                            className=\"w-full flex items-center justify-between px-4 py-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50\"\n                        >\n                            <div>\n                                <p className=\"text-sm font-medium text-gray-800\">Aggregate School Metrics</p>\n                                <p className=\"text-xs text-gray-500\">Daily task - rolls up to school level</p>\n                            </div>\n                            {syncing === 'school_metrics' && (\n                                <div className=\"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\n                            )}\n                        </button>\n                        <button\n                            onClick={() => handleManualSync('sdms_cache')}\n                            disabled={syncing !== null}\n                            className=\"w-full flex items-center justify-between px-4 py-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50\"\n                        >\n                            <div>\n                                <p className=\"text-sm font-medium text-gray-800\">Refresh SDMS Cache</p>\n                                <p className=\"text-xs text-gray-500\">Daily task - refreshes stale SDMS records</p>\n                            </div>\n                            {syncing === 'sdms_cache' && (\n                                <div className=\"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\n                            )}\n                        </button>\n                    </div>\n                </div>\n\n                {/* Recent Sync Logs */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Recent Sync Logs</h3>\n                    {logs.length === 0 ? (\n                        <div className=\"text-center text-gray-400 py-8\">\n                            <p>No sync logs found</p>\n                        </div>\n                    ) : (\n                        <div className=\"overflow-x-auto max-h-80 overflow-y-auto\">\n                            <table className=\"w-full text-xs\">\n                                <thead className=\"sticky top-0 bg-white\">\n                                    <tr className=\"text-left text-gray-500 border-b border-gray-100\">\n                                        <th className=\"pb-2 font-medium\">Type</th>\n                                        <th className=\"pb-2 font-medium\">Entity</th>\n                                        <th className=\"pb-2 font-medium\">Op</th>\n                                        <th className=\"pb-2 font-medium\">Time</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {logs.map(log => (\n                                        <tr key={log.id} className=\"border-b border-gray-50\">\n                                            <td className=\"py-2 text-gray-600\">{log.sync_type}</td>\n                                            <td className=\"py-2 text-gray-600 truncate max-w-[80px]\">{log.entity_id || '-'}</td>\n                                            <td className=\"py-2\"><OperationBadge operation={log.operation} /></td>\n                                            <td className=\"py-2 text-gray-500\">{formatTimestamp(log.timecreated)}</td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Root Preact application component for Elby Dashboard.\n *\n * @module     local_elby_dashboard/app\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState } from 'preact/hooks';\nimport './styles.css';\nimport Dashboard from './components/Dashboard';\nimport Sidebar from './components/Sidebar';\nimport CompletionReport from './components/CompletionReport';\nimport CoursesReport from './components/CoursesReport';\nimport SchoolDirectory from './components/SchoolDirectory';\nimport SchoolDetail from './components/SchoolDetail';\nimport StudentList from './components/StudentList';\nimport TrafficReport from './components/TrafficReport';\nimport AccessLog from './components/AccessLog';\nimport AdminPanel from './components/AdminPanel';\nimport type { UserData, StatsData, PageId, SidenavConfig, ThemeConfig, CoursesReportData } from './types';\n\ninterface AppProps {\n    user: UserData;\n    stats: StatsData;\n    activePage: PageId;\n    sidenavConfig: SidenavConfig;\n    themeConfig: ThemeConfig;\n    coursesReportData?: CoursesReportData | null;\n    schoolCode?: string;\n}\n\n// Header component with search and user profile\nfunction Header({ user, activePage, themeConfig, onMenuClick }: {\n    user: UserData;\n    activePage: PageId;\n    themeConfig: ThemeConfig;\n    onMenuClick: () => void;\n}) {\n    const pageTitles: Record<string, string> = {\n        home: 'Dashboard',\n        completion: 'Completion Report',\n        courses: 'Courses Report',\n        schools: 'Schools Directory',\n        school_detail: 'School Detail',\n        students: 'Student List',\n        teachers: 'Teacher List',\n        traffic: 'Platform Traffic',\n        accesslog: 'Access Log',\n        admin: 'Admin Panel',\n    };\n    const pageTitle = pageTitles[activePage] || 'Dashboard';\n\n    return (\n        <header className=\"bg-white border-b border-gray-100 px-2 sm:px-4 lg:px-6 py-3 sm:py-4\">\n            <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                    {/* Hamburger Menu - Mobile only */}\n                    <button\n                        onClick={onMenuClick}\n                        className=\"lg:hidden p-2 -ml-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg\"\n                        aria-label=\"Toggle menu\"\n                    >\n                        <svg className=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M4 6h16M4 12h16M4 18h16\" />\n                        </svg>\n                    </button>\n                    {/* Page Title */}\n                    <h1 className=\"text-xl font-semibold text-gray-800\">{pageTitle}</h1>\n                </div>\n\n                <div className=\"flex items-center gap-4 lg:gap-6\">\n                    {/* Notification Bell */}\n                    {themeConfig.showNotifications && (\n                        <button className=\"relative text-gray-500 hover:text-gray-700\">\n                            <svg className=\"w-6 h-6\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                <path d=\"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9\"/>\n                                <path d=\"M13.73 21a2 2 0 0 1-3.46 0\"/>\n                            </svg>\n                            <span className=\"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full\"></span>\n                        </button>\n                    )}\n\n                    {/* User Profile */}\n                    {themeConfig.showUserProfile && (\n                        <div className=\"flex items-center gap-3\">\n                            <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center text-white font-semibold text-sm overflow-hidden\">\n                                {user.avatar ? (\n                                    <img src={user.avatar} alt={user.fullname} className=\"w-full h-full object-cover\" />\n                                ) : (\n                                    <span>{user.firstname.charAt(0)}{user.lastname.charAt(0)}</span>\n                                )}\n                            </div>\n                            <div className=\"hidden sm:block\">\n                                <p className=\"text-sm font-semibold text-gray-800\">{user.fullname}</p>\n                                <p className=\"text-xs text-gray-500\">\n                                    {user.isAdmin ? 'Admin' : user.roles.includes('teacher') ? 'Teacher' : 'User'}\n                                </p>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </header>\n    );\n}\n\nexport default function App({ user, stats, activePage, sidenavConfig, themeConfig, coursesReportData, schoolCode }: AppProps) {\n    const [sidebarOpen, setSidebarOpen] = useState(false);\n\n    const toggleSidebar = () => setSidebarOpen(!sidebarOpen);\n    const closeSidebar = () => setSidebarOpen(false);\n\n    return (\n        <div className=\"flex h-screen bg-gray-50\">\n            <Sidebar\n                activePage={activePage}\n                sidenavConfig={sidenavConfig}\n                themeConfig={themeConfig}\n                isOpen={sidebarOpen}\n                onClose={closeSidebar}\n            />\n            <div className=\"flex-1 flex flex-col min-h-0\">\n                <Header user={user} activePage={activePage} themeConfig={themeConfig} onMenuClick={toggleSidebar} />\n                <main className=\"flex-1 overflow-y-auto\">\n                    {activePage === 'home' && <Dashboard user={user} stats={stats} themeConfig={themeConfig} />}\n                    {activePage === 'completion' && <CompletionReport />}\n                    {activePage === 'courses' && coursesReportData && (\n                        <CoursesReport data={coursesReportData} themeConfig={themeConfig} />\n                    )}\n                    {activePage === 'schools' && <SchoolDirectory />}\n                    {activePage === 'school_detail' && schoolCode && <SchoolDetail schoolCode={schoolCode} />}\n                    {activePage === 'students' && <StudentList initialSchoolCode={schoolCode} />}\n                    {activePage === 'teachers' && <StudentList userType=\"teacher\" user={user} initialSchoolCode={schoolCode} />}\n                    {activePage === 'traffic' && <TrafficReport />}\n                    {activePage === 'accesslog' && <AccessLog />}\n                    {activePage === 'admin' && <AdminPanel />}\n                </main>\n            </div>\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Elby Dashboard module with Preact integration.\n *\n * @module     local_elby_dashboard/dashboard\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { h, render } from 'preact';\nimport App from './app';\nimport type { UserData, StatsData, PageId, SidenavConfig, ThemeConfig, CoursesReportData } from './types';\n\n/**\n * Initialize the Elby Dashboard Preact application.\n *\n * Reads user and stats data from HTML data attributes and renders the app.\n *\n * @param {string} selector - CSS selector for the mount point\n */\nexport const init = (selector: string = '#elby-dashboard-root') => {\n    const container = document.querySelector(selector);\n\n    if (!container) {\n        console.error(`Container not found: ${selector}`);\n        return;\n    }\n\n    // Read data from HTML data attributes\n    try {\n        const userDataAttr = container.getAttribute('data-user');\n        const statsDataAttr = container.getAttribute('data-stats');\n        const sidenavDataAttr = container.getAttribute('data-sidenav');\n        const themeDataAttr = container.getAttribute('data-theme');\n        const coursesReportAttr = container.getAttribute('data-courses-report');\n        const pageAttr = container.getAttribute('data-page') as PageId | null;\n\n        // Parse user data\n        const user: UserData = userDataAttr\n            ? JSON.parse(userDataAttr)\n            : {\n                id: 0,\n                fullname: 'Guest',\n                firstname: 'Guest',\n                lastname: '',\n                email: '',\n                avatar: '',\n                roles: [],\n            };\n\n        // Parse stats data\n        const stats: StatsData = statsDataAttr\n            ? JSON.parse(statsDataAttr)\n            : {\n                totalCourses: 0,\n                totalUsers: 0,\n                totalEnrollments: 0,\n                totalActivities: 0,\n            };\n\n        // Parse sidenav config\n        const sidenavConfig: SidenavConfig = sidenavDataAttr\n            ? JSON.parse(sidenavDataAttr)\n            : {\n                title: 'Dashboard',\n                logoUrl: null,\n            };\n\n        // Parse theme config\n        const themeConfig: ThemeConfig = themeDataAttr\n            ? JSON.parse(themeDataAttr)\n            : {\n                sidenavAccentColor: '#005198',\n                statCard1Color: '#cffafe',\n                statCard2Color: '#fef3c7',\n                statCard3Color: '#f3e8ff',\n                statCard4Color: '#dcfce7',\n                chartPrimaryColor: '#22d3ee',\n                chartSecondaryColor: '#a78bfa',\n                showSearchBar: true,\n                showNotifications: true,\n                showUserProfile: true,\n                menuVisibility: {\n                    courses: true,\n                    presence: true,\n                    communication: true,\n                    event: true,\n                    pedagogy: true,\n                    message: true,\n                    completion: true,\n                    settings: true,\n                },\n            };\n\n        // Parse courses report data (optional, only on courses page)\n        const coursesReportData: CoursesReportData | null = coursesReportAttr\n            ? JSON.parse(coursesReportAttr)\n            : null;\n\n        // Read school code for school detail page.\n        const schoolCode = container.getAttribute('data-school-code') || undefined;\n\n        // Get active page (default to 'home')\n        const activePage: PageId = pageAttr || 'home';\n\n        console.log('Elby Dashboard initialized:', { user: user.fullname, activePage });\n\n        // Render the Preact app\n        render(h(App, { user, stats, activePage, sidenavConfig, themeConfig, coursesReportData, schoolCode }), container);\n    } catch (error) {\n        console.error('Error initializing Elby Dashboard:', error);\n    }\n};\n"],"names":["n","l","u","i","r","o","e","f","c","s","a","p","v","y","w","d","g","_","t","m","k","x","S","C","M","$","O","N","I","h","b","P","B","A","L","D","T","j","F","H","E","V","z","q","G","ajaxCall","methodname","args","resolve","reject","require","Ajax","StatCard","icon","value","label","customBgColor","jsxs","jsx","EngagementDonut","activeThisWeek","atRisk","neverLoggedIn","total","circumference","activeLen","atRiskLen","neverLen","GenderDonut","male","female","maleLen","femaleLen","StudentsIcon","TeacherIcon","EmployeeIcon","CoursesIcon","SchoolsIcon","statusColors","StatusDonut","data","sum","offset","len","currentOffset","Dashboard","user","stats","themeConfig","schools","setSchools","useState","schoolsLoading","setSchoolsLoading","traffic","setTraffic","trafficLoading","setTrafficLoading","useEffect","resp","sorted","schoolMaxCount","trafficMax","school","gradeMax","progMax","posMax","Fragment","point","ageMax","menuItems","icons","DefaultLogoIcon","Sidebar","activePage","sidenavConfig","isOpen","onClose","visibleMenuItems","item","isActive","parentCategories","dummyData","grandTotal","unitLabels","CompletionReport","selectedParentId","setSelectedParentId","filteredData","row","currentGrandTotal","totalParticipants","unitTotals","unitIndex","validRows","avgSum","crSum","cr","cat","unit","index","nodeMatchesSearch","node","query","lowerQuery","course","child","TreeNode","depth","expandedNodes","onToggle","selectedId","onSelect","searchQuery","nodeKey","isExpanded","hasChildren","hasCourses","paddingLeft","matchingCourses","hasMatchingDescendants","findCourseInTree","nodes","courseId","targetId","found","inChildren","collectAllNodeKeys","keys","collect","nodeList","TreeCourseSelect","tree","placeholder","setIsOpen","setSearchQuery","setExpandedNodes","containerRef","useRef","searchInputRef","selectedCourse","toggleNode","key","newExpanded","handleClickOutside","event","handleSelect","id","YearSelect","years","selectedYear","year","DONUT_COLORS","CompletionDonut","rate","colorIndex","progressLength","progressColor","center","truncateText","text","maxLength","SchoolBarChart","sectionIndex","grademax","idx","section","avgValue","sectionGrademax","avgHeight","crHeight","fullName","displayName","ScatterPlot","pct","SortIndicator","column","sortColumn","sortDirection","SortableHeader","children","onSort","className","ReportTable","report","setSortColumn","setSortDirection","handleSort","sortedSchools","useMemo","aVal","bVal","sIdx","avgGrades","avgGrade","CoursesReport","handleCourseSelect","courseid","params","handleYearSelect","KpiCard","color","SchoolCard","onClick","SchoolDirectory","loading","setLoading","provinceFilter","setProvinceFilter","districtFilter","setDistrictFilter","sortMode","setSortMode","provinces","setProvinces","districts","setDistricts","loadSchools","result","schoolsData","fetchSchoolsFromDb","provSet","distSet","err","schoolsDataAttr","handleSchoolClick","schoolCode","filteredSchools","totalEnrolled","totalActive","totalAtRisk","schoolsWithScores","filteredDistricts","EngagementBar","distribution","highPct","medPct","lowPct","atRiskPct","WeeklyTrendChart","width","height","padding","maxVal","xStep","activePath","enrolledPath","GenderChart","malePct","femalePct","AgeDistributionChart","chartW","chartH","barW","gap","val","barH","SchoolHierarchy","schoolInfo","expandedLevels","expandedCombos","onToggleLevel","onToggleCombo","level","comboCount","gradeCount","combo","comboKey","isComboExpanded","grade","cg","SchoolDetail","metrics","setMetrics","setDistribution","schoolName","setSchoolName","syncing","setSyncing","weeklyTrend","setWeeklyTrend","demographics","setDemographics","setSchoolInfo","setExpandedLevels","setExpandedCombos","loadSchoolData","metricsResult","distResult","demoResult","infoResult","studentResult","students","activeCount","atRiskCount","scoresArr","avgQuiz","progressArr","avgProgress","totalActions","high","medium","low","now","trend","jitter","handleSync","handleExportCsv","rows","csv","blob","url","prev","next","formatTimeAgo","timestamp","diff","StatusBadge","status","SortIcon","field","currentSort","currentOrder","StudentList","initialSchoolCode","initialCourseId","userType","isTeacher","canManage","setStudents","totalCount","setTotalCount","page","setPage","perpage","sort","setSort","order","setOrder","search","setSearch","searchInput","setSearchInput","setSchoolCode","engagementLevel","setEngagementLevel","schoolsList","setSchoolsList","editingUserId","setEditingUserId","editingSchoolCode","setEditingSchoolCode","saving","setSaving","loadStudents","handleSaveSchool","userid","handleSearch","headers","totalPages","startItem","endItem","sortableHeader","student","TrafficReport","setData","period","setPeriod","daysBack","setDaysBack","loadTraffic","maxActions","totalUniqueUsers","avgActions","formatDateTime","toDateInputValue","fromDateInput","AccessLog","entries","setEntries","dateFrom","setDateFrom","dateTo","setDateTo","setUserType","loadLog","entry","formatTimestamp","ts","OperationBadge","operation","LinkUserSection","onLinked","users","setUsers","searching","setSearching","selectedUser","setSelectedUser","sdmsCode","setSdmsCode","lookupPreview","setLookupPreview","lookingUp","setLookingUp","linking","setLinking","linkNotification","setLinkNotification","searchTimer","handleSearchChange","doSearch","term","handleLookup","name","handleLink","AdminPanel","setStats","logs","setLogs","notification","setNotification","loadAdminData","adminDataAttr","handleManualSync","type","taskName","log","Header","onMenuClick","pageTitle","App","coursesReportData","sidebarOpen","setSidebarOpen","init","selector","container","userDataAttr","statsDataAttr","sidenavDataAttr","themeDataAttr","coursesReportAttr","pageAttr","render","error"],"mappings":"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","x_google_ignoreList":[0,1,2]}
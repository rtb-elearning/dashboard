{"version":3,"file":"dashboard.js","sources":["../../node_modules/.pnpm/preact@10.27.2/node_modules/preact/dist/preact.module.js","../../node_modules/.pnpm/preact@10.27.2/node_modules/preact/jsx-runtime/dist/jsxRuntime.module.js","../../node_modules/.pnpm/preact@10.27.2/node_modules/preact/hooks/dist/hooks.module.js","../src/components/Dashboard.tsx","../src/components/Sidebar.tsx","../src/components/CompletionReport.tsx","../src/components/CoursesReport.tsx","../src/components/SchoolDirectory.tsx","../src/components/SchoolDetail.tsx","../src/components/StudentList.tsx","../src/components/TrafficReport.tsx","../src/components/AccessLog.tsx","../src/components/AdminPanel.tsx","../src/app.tsx","../src/dashboard.ts"],"sourcesContent":["var n,l,u,t,i,r,o,e,f,c,s,a,h,p={},v=[],y=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,w=Array.isArray;function d(n,l){for(var u in l)n[u]=l[u];return n}function g(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function _(l,u,t){var i,r,o,e={};for(o in u)\"key\"==o?i=u[o]:\"ref\"==o?r=u[o]:e[o]=u[o];if(arguments.length>2&&(e.children=arguments.length>3?n.call(arguments,2):t),\"function\"==typeof l&&null!=l.defaultProps)for(o in l.defaultProps)void 0===e[o]&&(e[o]=l.defaultProps[o]);return m(l,e,i,r,null)}function m(n,t,i,r,o){var e={type:n,props:t,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==o?++u:o,__i:-1,__u:0};return null==o&&null!=l.vnode&&l.vnode(e),e}function b(){return{current:null}}function k(n){return n.children}function x(n,l){this.props=n,this.context=l}function S(n,l){if(null==l)return n.__?S(n.__,n.__i+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?S(n):null}function C(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return C(n)}}function M(n){(!n.__d&&(n.__d=!0)&&i.push(n)&&!$.__r++||r!=l.debounceRendering)&&((r=l.debounceRendering)||o)($)}function $(){for(var n,u,t,r,o,f,c,s=1;i.length;)i.length>s&&i.sort(e),n=i.shift(),s=i.length,n.__d&&(t=void 0,r=void 0,o=(r=(u=n).__v).__e,f=[],c=[],u.__P&&((t=d({},r)).__v=r.__v+1,l.vnode&&l.vnode(t),O(u.__P,t,r,u.__n,u.__P.namespaceURI,32&r.__u?[o]:null,f,null==o?S(r):o,!!(32&r.__u),c),t.__v=r.__v,t.__.__k[t.__i]=t,N(f,t,c),r.__e=r.__=null,t.__e!=o&&C(t)));$.__r=0}function I(n,l,u,t,i,r,o,e,f,c,s){var a,h,y,w,d,g,_,m=t&&t.__k||v,b=l.length;for(f=P(u,l,m,f,b),a=0;a<b;a++)null!=(y=u.__k[a])&&(h=-1==y.__i?p:m[y.__i]||p,y.__i=a,g=O(n,y,h,i,r,o,e,f,c,s),w=y.__e,y.ref&&h.ref!=y.ref&&(h.ref&&B(h.ref,null,y),s.push(y.ref,y.__c||w,y)),null==d&&null!=w&&(d=w),(_=!!(4&y.__u))||h.__k===y.__k?f=A(y,f,n,_):\"function\"==typeof y.type&&void 0!==g?f=g:w&&(f=w.nextSibling),y.__u&=-7);return u.__e=d,f}function P(n,l,u,t,i){var r,o,e,f,c,s=u.length,a=s,h=0;for(n.__k=new Array(i),r=0;r<i;r++)null!=(o=l[r])&&\"boolean\"!=typeof o&&\"function\"!=typeof o?(f=r+h,(o=n.__k[r]=\"string\"==typeof o||\"number\"==typeof o||\"bigint\"==typeof o||o.constructor==String?m(null,o,null,null,null):w(o)?m(k,{children:o},null,null,null):null==o.constructor&&o.__b>0?m(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=n,o.__b=n.__b+1,e=null,-1!=(c=o.__i=L(o,u,f,a))&&(a--,(e=u[c])&&(e.__u|=2)),null==e||null==e.__v?(-1==c&&(i>s?h--:i<s&&h++),\"function\"!=typeof o.type&&(o.__u|=4)):c!=f&&(c==f-1?h--:c==f+1?h++:(c>f?h--:h++,o.__u|=4))):n.__k[r]=null;if(a)for(r=0;r<s;r++)null!=(e=u[r])&&0==(2&e.__u)&&(e.__e==t&&(t=S(e)),D(e,e));return t}function A(n,l,u,t){var i,r;if(\"function\"==typeof n.type){for(i=n.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=n,l=A(i[r],l,u,t));return l}n.__e!=l&&(t&&(l&&n.type&&!l.parentNode&&(l=S(n)),u.insertBefore(n.__e,l||null)),l=n.__e);do{l=l&&l.nextSibling}while(null!=l&&8==l.nodeType);return l}function H(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(w(n)?n.some(function(n){H(n,l)}):l.push(n)),l}function L(n,l,u,t){var i,r,o,e=n.key,f=n.type,c=l[u],s=null!=c&&0==(2&c.__u);if(null===c&&null==n.key||s&&e==c.key&&f==c.type)return u;if(t>(s?1:0))for(i=u-1,r=u+1;i>=0||r<l.length;)if(null!=(c=l[o=i>=0?i--:r++])&&0==(2&c.__u)&&e==c.key&&f==c.type)return o;return-1}function T(n,l,u){\"-\"==l[0]?n.setProperty(l,null==u?\"\":u):n[l]=null==u?\"\":\"number\"!=typeof u||y.test(l)?u:u+\"px\"}function j(n,l,u,t,i){var r,o;n:if(\"style\"==l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof t&&(n.style.cssText=t=\"\"),t)for(l in t)u&&l in u||T(n.style,l,\"\");if(u)for(l in u)t&&u[l]==t[l]||T(n.style,l,u[l])}else if(\"o\"==l[0]&&\"n\"==l[1])r=l!=(l=l.replace(f,\"$1\")),o=l.toLowerCase(),l=o in n||\"onFocusOut\"==l||\"onFocusIn\"==l?o.slice(2):l.slice(2),n.l||(n.l={}),n.l[l+r]=u,u?t?u.u=t.u:(u.u=c,n.addEventListener(l,r?a:s,r)):n.removeEventListener(l,r?a:s,r);else{if(\"http://www.w3.org/2000/svg\"==i)l=l.replace(/xlink(H|:h)/,\"h\").replace(/sName$/,\"s\");else if(\"width\"!=l&&\"height\"!=l&&\"href\"!=l&&\"list\"!=l&&\"form\"!=l&&\"tabIndex\"!=l&&\"download\"!=l&&\"rowSpan\"!=l&&\"colSpan\"!=l&&\"role\"!=l&&\"popover\"!=l&&l in n)try{n[l]=null==u?\"\":u;break n}catch(n){}\"function\"==typeof u||(null==u||!1===u&&\"-\"!=l[4]?n.removeAttribute(l):n.setAttribute(l,\"popover\"==l&&1==u?\"\":u))}}function F(n){return function(u){if(this.l){var t=this.l[u.type+n];if(null==u.t)u.t=c++;else if(u.t<t.u)return;return t(l.event?l.event(u):u)}}}function O(n,u,t,i,r,o,e,f,c,s){var a,h,p,v,y,_,m,b,S,C,M,$,P,A,H,L,T,j=u.type;if(null!=u.constructor)return null;128&t.__u&&(c=!!(32&t.__u),o=[f=u.__e=t.__e]),(a=l.__b)&&a(u);n:if(\"function\"==typeof j)try{if(b=u.props,S=\"prototype\"in j&&j.prototype.render,C=(a=j.contextType)&&i[a.__c],M=a?C?C.props.value:a.__:i,t.__c?m=(h=u.__c=t.__c).__=h.__E:(S?u.__c=h=new j(b,M):(u.__c=h=new x(b,M),h.constructor=j,h.render=E),C&&C.sub(h),h.props=b,h.state||(h.state={}),h.context=M,h.__n=i,p=h.__d=!0,h.__h=[],h._sb=[]),S&&null==h.__s&&(h.__s=h.state),S&&null!=j.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=d({},h.__s)),d(h.__s,j.getDerivedStateFromProps(b,h.__s))),v=h.props,y=h.state,h.__v=u,p)S&&null==j.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),S&&null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(S&&null==j.getDerivedStateFromProps&&b!==v&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(b,M),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(b,h.__s,M)||u.__v==t.__v){for(u.__v!=t.__v&&(h.props=b,h.state=h.__s,h.__d=!1),u.__e=t.__e,u.__k=t.__k,u.__k.some(function(n){n&&(n.__=u)}),$=0;$<h._sb.length;$++)h.__h.push(h._sb[$]);h._sb=[],h.__h.length&&e.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(b,h.__s,M),S&&null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(v,y,_)})}if(h.context=M,h.props=b,h.__P=n,h.__e=!1,P=l.__r,A=0,S){for(h.state=h.__s,h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),H=0;H<h._sb.length;H++)h.__h.push(h._sb[H]);h._sb=[]}else do{h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++A<25);h.state=h.__s,null!=h.getChildContext&&(i=d(d({},i),h.getChildContext())),S&&!p&&null!=h.getSnapshotBeforeUpdate&&(_=h.getSnapshotBeforeUpdate(v,y)),L=a,null!=a&&a.type===k&&null==a.key&&(L=V(a.props.children)),f=I(n,w(L)?L:[L],u,t,i,r,o,e,f,c,s),h.base=u.__e,u.__u&=-161,h.__h.length&&e.push(h),m&&(h.__E=h.__=null)}catch(n){if(u.__v=null,c||null!=o)if(n.then){for(u.__u|=c?160:128;f&&8==f.nodeType&&f.nextSibling;)f=f.nextSibling;o[o.indexOf(f)]=null,u.__e=f}else{for(T=o.length;T--;)g(o[T]);z(u)}else u.__e=t.__e,u.__k=t.__k,n.then||z(u);l.__e(n,u,t)}else null==o&&u.__v==t.__v?(u.__k=t.__k,u.__e=t.__e):f=u.__e=q(t.__e,u,t,i,r,o,e,c,s);return(a=l.diffed)&&a(u),128&u.__u?void 0:f}function z(n){n&&n.__c&&(n.__c.__e=!0),n&&n.__k&&n.__k.forEach(z)}function N(n,u,t){for(var i=0;i<t.length;i++)B(t[i],t[++i],t[++i]);l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function V(n){return\"object\"!=typeof n||null==n||n.__b&&n.__b>0?n:w(n)?n.map(V):d({},n)}function q(u,t,i,r,o,e,f,c,s){var a,h,v,y,d,_,m,b=i.props,k=t.props,x=t.type;if(\"svg\"==x?o=\"http://www.w3.org/2000/svg\":\"math\"==x?o=\"http://www.w3.org/1998/Math/MathML\":o||(o=\"http://www.w3.org/1999/xhtml\"),null!=e)for(a=0;a<e.length;a++)if((d=e[a])&&\"setAttribute\"in d==!!x&&(x?d.localName==x:3==d.nodeType)){u=d,e[a]=null;break}if(null==u){if(null==x)return document.createTextNode(k);u=document.createElementNS(o,x,k.is&&k),c&&(l.__m&&l.__m(t,e),c=!1),e=null}if(null==x)b===k||c&&u.data==k||(u.data=k);else{if(e=e&&n.call(u.childNodes),b=i.props||p,!c&&null!=e)for(b={},a=0;a<u.attributes.length;a++)b[(d=u.attributes[a]).name]=d.value;for(a in b)if(d=b[a],\"children\"==a);else if(\"dangerouslySetInnerHTML\"==a)v=d;else if(!(a in k)){if(\"value\"==a&&\"defaultValue\"in k||\"checked\"==a&&\"defaultChecked\"in k)continue;j(u,a,null,d,o)}for(a in k)d=k[a],\"children\"==a?y=d:\"dangerouslySetInnerHTML\"==a?h=d:\"value\"==a?_=d:\"checked\"==a?m=d:c&&\"function\"!=typeof d||b[a]===d||j(u,a,d,b[a],o);if(h)c||v&&(h.__html==v.__html||h.__html==u.innerHTML)||(u.innerHTML=h.__html),t.__k=[];else if(v&&(u.innerHTML=\"\"),I(\"template\"==t.type?u.content:u,w(y)?y:[y],t,i,r,\"foreignObject\"==x?\"http://www.w3.org/1999/xhtml\":o,e,f,e?e[0]:i.__k&&S(i,0),c,s),null!=e)for(a=e.length;a--;)g(e[a]);c||(a=\"value\",\"progress\"==x&&null==_?u.removeAttribute(\"value\"):null!=_&&(_!==u[a]||\"progress\"==x&&!_||\"option\"==x&&_!=b[a])&&j(u,a,_,b[a],o),a=\"checked\",null!=m&&m!=u[a]&&j(u,a,m,b[a],o))}return u}function B(n,u,t){try{if(\"function\"==typeof n){var i=\"function\"==typeof n.__u;i&&n.__u(),i&&null==u||(n.__u=n(u))}else n.current=u}catch(n){l.__e(n,t)}}function D(n,u,t){var i,r;if(l.unmount&&l.unmount(n),(i=n.ref)&&(i.current&&i.current!=n.__e||B(i,null,u)),null!=(i=n.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(n){l.__e(n,u)}i.base=i.__P=null}if(i=n.__k)for(r=0;r<i.length;r++)i[r]&&D(i[r],u,t||\"function\"!=typeof n.type);t||g(n.__e),n.__c=n.__=n.__e=void 0}function E(n,l,u){return this.constructor(n,u)}function G(u,t,i){var r,o,e,f;t==document&&(t=document.documentElement),l.__&&l.__(u,t),o=(r=\"function\"==typeof i)?null:i&&i.__k||t.__k,e=[],f=[],O(t,u=(!r&&i||t).__k=_(k,null,[u]),o||p,p,t.namespaceURI,!r&&i?[i]:o?null:t.firstChild?n.call(t.childNodes):null,e,!r&&i?i:o?o.__e:t.firstChild,r,f),N(e,u,f)}function J(n,l){G(n,l,J)}function K(l,u,t){var i,r,o,e,f=d({},l.props);for(o in l.type&&l.type.defaultProps&&(e=l.type.defaultProps),u)\"key\"==o?i=u[o]:\"ref\"==o?r=u[o]:f[o]=void 0===u[o]&&null!=e?e[o]:u[o];return arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):t),m(l.type,f,i||l.key,r||l.ref,null)}function Q(n){function l(n){var u,t;return this.getChildContext||(u=new Set,(t={})[l.__c]=this,this.getChildContext=function(){return t},this.componentWillUnmount=function(){u=null},this.shouldComponentUpdate=function(n){this.props.value!=n.value&&u.forEach(function(n){n.__e=!0,M(n)})},this.sub=function(n){u.add(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u&&u.delete(n),l&&l.call(n)}}),n.children}return l.__c=\"__cC\"+h++,l.__=n,l.Provider=l.__l=(l.Consumer=function(n,l){return n.children(l)}).contextType=l,l}n=v.slice,l={__e:function(n,l,u,t){for(var i,r,o;l=l.__;)if((i=l.__c)&&!i.__)try{if((r=i.constructor)&&null!=r.getDerivedStateFromError&&(i.setState(r.getDerivedStateFromError(n)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(n,t||{}),o=i.__d),o)return i.__E=i}catch(l){n=l}throw n}},u=0,t=function(n){return null!=n&&null==n.constructor},x.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=d({},this.state),\"function\"==typeof n&&(n=n(d({},u),this.props)),n&&d(u,n),null!=n&&this.__v&&(l&&this._sb.push(l),M(this))},x.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),M(this))},x.prototype.render=k,i=[],o=\"function\"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e=function(n,l){return n.__v.__b-l.__v.__b},$.__r=0,f=/(PointerCapture)$|Capture$/i,c=0,s=F(!1),a=F(!0),h=0;export{x as Component,k as Fragment,K as cloneElement,Q as createContext,_ as createElement,b as createRef,_ as h,J as hydrate,t as isValidElement,l as options,G as render,H as toChildArray};\n//# sourceMappingURL=preact.module.js.map\n","import{options as r,Fragment as e}from\"preact\";export{Fragment}from\"preact\";var t=/[\"&<]/;function n(r){if(0===r.length||!1===t.test(r))return r;for(var e=0,n=0,o=\"\",f=\"\";n<r.length;n++){switch(r.charCodeAt(n)){case 34:f=\"&quot;\";break;case 38:f=\"&amp;\";break;case 60:f=\"&lt;\";break;default:continue}n!==e&&(o+=r.slice(e,n)),o+=f,e=n+1}return n!==e&&(o+=r.slice(e,n)),o}var o=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,f=0,i=Array.isArray;function u(e,t,n,o,i,u){t||(t={});var a,c,p=t;if(\"ref\"in p)for(c in p={},t)\"ref\"==c?a=t[c]:p[c]=t[c];var l={type:e,props:p,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--f,__i:-1,__u:0,__source:i,__self:u};if(\"function\"==typeof e&&(a=e.defaultProps))for(c in a)void 0===p[c]&&(p[c]=a[c]);return r.vnode&&r.vnode(l),l}function a(r){var t=u(e,{tpl:r,exprs:[].slice.call(arguments,1)});return t.key=t.__v,t}var c={},p=/[A-Z]/g;function l(e,t){if(r.attr){var f=r.attr(e,t);if(\"string\"==typeof f)return f}if(t=function(r){return null!==r&&\"object\"==typeof r&&\"function\"==typeof r.valueOf?r.valueOf():r}(t),\"ref\"===e||\"key\"===e)return\"\";if(\"style\"===e&&\"object\"==typeof t){var i=\"\";for(var u in t){var a=t[u];if(null!=a&&\"\"!==a){var l=\"-\"==u[0]?u:c[u]||(c[u]=u.replace(p,\"-$&\").toLowerCase()),s=\";\";\"number\"!=typeof a||l.startsWith(\"--\")||o.test(l)||(s=\"px;\"),i=i+l+\":\"+a+s}}return e+'=\"'+n(i)+'\"'}return null==t||!1===t||\"function\"==typeof t||\"object\"==typeof t?\"\":!0===t?e:e+'=\"'+n(\"\"+t)+'\"'}function s(r){if(null==r||\"boolean\"==typeof r||\"function\"==typeof r)return null;if(\"object\"==typeof r){if(void 0===r.constructor)return r;if(i(r)){for(var e=0;e<r.length;e++)r[e]=s(r[e]);return r}}return n(\"\"+r)}export{u as jsx,l as jsxAttr,u as jsxDEV,s as jsxEscape,a as jsxTemplate,u as jsxs};\n//# sourceMappingURL=jsxRuntime.module.js.map\n","import{options as n}from\"preact\";var t,r,u,i,o=0,f=[],c=n,e=c.__b,a=c.__r,v=c.diffed,l=c.__c,m=c.unmount,s=c.__;function p(n,t){c.__h&&c.__h(r,n,o||t),o=0;var u=r.__H||(r.__H={__:[],__h:[]});return n>=u.__.length&&u.__.push({}),u.__[n]}function d(n){return o=1,h(D,n)}function h(n,u,i){var o=p(t++,2);if(o.t=n,!o.__c&&(o.__=[i?i(u):D(void 0,u),function(n){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,n);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=r,!r.__f)){var f=function(n,t,r){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(n){return!!n.__c});if(u.every(function(n){return!n.__N}))return!c||c.call(this,n,t,r);var i=o.__c.props!==n;return u.forEach(function(n){if(n.__N){var t=n.__[0];n.__=n.__N,n.__N=void 0,t!==n.__[0]&&(i=!0)}}),c&&c.call(this,n,t,r)||i};r.__f=!0;var c=r.shouldComponentUpdate,e=r.componentWillUpdate;r.componentWillUpdate=function(n,t,r){if(this.__e){var u=c;c=void 0,f(n,t,r),c=u}e&&e.call(this,n,t,r)},r.shouldComponentUpdate=f}return o.__N||o.__}function y(n,u){var i=p(t++,3);!c.__s&&C(i.__H,u)&&(i.__=n,i.u=u,r.__H.__h.push(i))}function _(n,u){var i=p(t++,4);!c.__s&&C(i.__H,u)&&(i.__=n,i.u=u,r.__h.push(i))}function A(n){return o=5,T(function(){return{current:n}},[])}function F(n,t,r){o=6,_(function(){if(\"function\"==typeof n){var r=n(t());return function(){n(null),r&&\"function\"==typeof r&&r()}}if(n)return n.current=t(),function(){return n.current=null}},null==r?r:r.concat(n))}function T(n,r){var u=p(t++,7);return C(u.__H,r)&&(u.__=n(),u.__H=r,u.__h=n),u.__}function q(n,t){return o=8,T(function(){return n},t)}function x(n){var u=r.context[n.__c],i=p(t++,9);return i.c=n,u?(null==i.__&&(i.__=!0,u.sub(r)),u.props.value):n.__}function P(n,t){c.useDebugValue&&c.useDebugValue(t?t(n):n)}function b(n){var u=p(t++,10),i=d();return u.__=n,r.componentDidCatch||(r.componentDidCatch=function(n,t){u.__&&u.__(n,t),i[1](n)}),[i[0],function(){i[1](void 0)}]}function g(){var n=p(t++,11);if(!n.__){for(var u=r.__v;null!==u&&!u.__m&&null!==u.__;)u=u.__;var i=u.__m||(u.__m=[0,0]);n.__=\"P\"+i[0]+\"-\"+i[1]++}return n.__}function j(){for(var n;n=f.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(z),n.__H.__h.forEach(B),n.__H.__h=[]}catch(t){n.__H.__h=[],c.__e(t,n.__v)}}c.__b=function(n){r=null,e&&e(n)},c.__=function(n,t){n&&t.__k&&t.__k.__m&&(n.__m=t.__k.__m),s&&s(n,t)},c.__r=function(n){a&&a(n),t=0;var i=(r=n.__c).__H;i&&(u===r?(i.__h=[],r.__h=[],i.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(i.__h.forEach(z),i.__h.forEach(B),i.__h=[],t=0)),u=r},c.diffed=function(n){v&&v(n);var t=n.__c;t&&t.__H&&(t.__H.__h.length&&(1!==f.push(t)&&i===c.requestAnimationFrame||((i=c.requestAnimationFrame)||w)(j)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),u=r=null},c.__c=function(n,t){t.some(function(n){try{n.__h.forEach(z),n.__h=n.__h.filter(function(n){return!n.__||B(n)})}catch(r){t.some(function(n){n.__h&&(n.__h=[])}),t=[],c.__e(r,n.__v)}}),l&&l(n,t)},c.unmount=function(n){m&&m(n);var t,r=n.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{z(n)}catch(n){t=n}}),r.__H=void 0,t&&c.__e(t,r.__v))};var k=\"function\"==typeof requestAnimationFrame;function w(n){var t,r=function(){clearTimeout(u),k&&cancelAnimationFrame(t),setTimeout(n)},u=setTimeout(r,35);k&&(t=requestAnimationFrame(r))}function z(n){var t=r,u=n.__c;\"function\"==typeof u&&(n.__c=void 0,u()),r=t}function B(n){var t=r;n.__c=n.__(),r=t}function C(n,t){return!n||n.length!==t.length||t.some(function(t,r){return t!==n[r]})}function D(n,t){return\"function\"==typeof t?t(n):t}export{q as useCallback,x as useContext,P as useDebugValue,y as useEffect,b as useErrorBoundary,g as useId,F as useImperativeHandle,_ as useLayoutEffect,T as useMemo,h as useReducer,A as useRef,d as useState};\n//# sourceMappingURL=hooks.module.js.map\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Dashboard component for Elby Dashboard.\n *\n * @module     local_elby_dashboard/components/Dashboard\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport type { UserData, StatsData, ThemeConfig, SchoolUserCounts, TrafficDataPoint } from '../types';\n\ninterface DashboardProps {\n    user: UserData;\n    stats: StatsData;\n    themeConfig: ThemeConfig;\n}\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\n// Stat Card Component\nfunction StatCard({ icon, value, label, customBgColor }: { icon: JSX.Element; value: string; label: string; customBgColor?: string }) {\n    return (\n        <div\n            className=\"rounded-xl p-4 flex items-center gap-4\"\n            style={customBgColor ? { backgroundColor: customBgColor } : undefined}\n        >\n            <div className=\"w-12 h-12 rounded-full bg-white/30 flex items-center justify-center\">\n                {icon}\n            </div>\n            <div>\n                <p className=\"text-xs text-gray-600 font-medium\">{label}</p>\n                <p className=\"text-xl font-bold text-gray-800\">{value}</p>\n            </div>\n        </div>\n    );\n}\n\n// Engagement Donut Chart\nfunction EngagementDonut({ activeThisWeek, atRisk, neverLoggedIn }: { activeThisWeek: number; atRisk: number; neverLoggedIn: number }) {\n    const total = activeThisWeek + atRisk + neverLoggedIn;\n    if (total === 0) {\n        return (\n            <div className=\"relative w-36 h-36\">\n                <svg viewBox=\"0 0 100 100\" className=\"w-full h-full\">\n                    <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"14\" />\n                </svg>\n                <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <span className=\"text-2xl font-bold text-gray-400\">0</span>\n                </div>\n            </div>\n        );\n    }\n\n    const circumference = 2 * Math.PI * 40; // ~251.2\n    const activeLen = (activeThisWeek / total) * circumference;\n    const atRiskLen = (atRisk / total) * circumference;\n    const neverLen = (neverLoggedIn / total) * circumference;\n\n    return (\n        <div className=\"relative w-36 h-36\">\n            <svg viewBox=\"0 0 100 100\" className=\"w-full h-full transform -rotate-90\">\n                {/* Background */}\n                <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"14\" />\n                {/* Active this week - green */}\n                <circle\n                    cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\"\n                    stroke=\"#22c55e\" strokeWidth=\"14\"\n                    strokeDasharray={`${activeLen} ${circumference - activeLen}`}\n                    strokeDashoffset=\"0\"\n                />\n                {/* At risk - amber */}\n                <circle\n                    cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\"\n                    stroke=\"#f59e0b\" strokeWidth=\"14\"\n                    strokeDasharray={`${atRiskLen} ${circumference - atRiskLen}`}\n                    strokeDashoffset={`${-activeLen}`}\n                />\n                {/* Never logged in - red */}\n                <circle\n                    cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\"\n                    stroke=\"#ef4444\" strokeWidth=\"14\"\n                    strokeDasharray={`${neverLen} ${circumference - neverLen}`}\n                    strokeDashoffset={`${-(activeLen + atRiskLen)}`}\n                />\n            </svg>\n            <div className=\"absolute inset-0 flex items-center justify-center\">\n                <span className=\"text-2xl font-bold text-gray-800\">{total}</span>\n            </div>\n        </div>\n    );\n}\n\n// Gender Donut Chart\nfunction GenderDonut({ male, female }: { male: number; female: number }) {\n    const total = male + female;\n    if (total === 0) {\n        return (\n            <div className=\"relative w-36 h-36\">\n                <svg viewBox=\"0 0 100 100\" className=\"w-full h-full\">\n                    <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"14\" />\n                </svg>\n                <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <span className=\"text-2xl font-bold text-gray-400\">0</span>\n                </div>\n            </div>\n        );\n    }\n\n    const circumference = 2 * Math.PI * 40;\n    const maleLen = (male / total) * circumference;\n    const femaleLen = (female / total) * circumference;\n\n    return (\n        <div className=\"relative w-36 h-36\">\n            <svg viewBox=\"0 0 100 100\" className=\"w-full h-full transform -rotate-90\">\n                <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"14\" />\n                {/* Male - blue */}\n                <circle\n                    cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\"\n                    stroke=\"#3b82f6\" strokeWidth=\"14\"\n                    strokeDasharray={`${maleLen} ${circumference - maleLen}`}\n                    strokeDashoffset=\"0\"\n                />\n                {/* Female - pink */}\n                <circle\n                    cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\"\n                    stroke=\"#ec4899\" strokeWidth=\"14\"\n                    strokeDasharray={`${femaleLen} ${circumference - femaleLen}`}\n                    strokeDashoffset={`${-maleLen}`}\n                />\n            </svg>\n            <div className=\"absolute inset-0 flex items-center justify-center\">\n                <span className=\"text-2xl font-bold text-gray-800\">{total}</span>\n            </div>\n        </div>\n    );\n}\n\n// Icons\nconst StudentsIcon = () => (\n    <svg className=\"w-6 h-6 text-cyan-600\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z\"/>\n    </svg>\n);\n\nconst TeacherIcon = () => (\n    <svg className=\"w-6 h-6 text-amber-600\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73v3.72z\"/>\n    </svg>\n);\n\nconst EmployeeIcon = () => (\n    <svg className=\"w-6 h-6 text-purple-600\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\"/>\n    </svg>\n);\n\nconst CoursesIcon = () => (\n    <svg className=\"w-6 h-6 text-green-600\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z\"/>\n    </svg>\n);\n\nconst SchoolsIcon = () => (\n    <svg className=\"w-6 h-6 text-blue-600\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73v3.72z\"/>\n    </svg>\n);\n\nexport default function Dashboard({ user, stats, themeConfig }: DashboardProps) {\n    const [schools, setSchools] = useState<SchoolUserCounts[]>([]);\n    const [schoolsLoading, setSchoolsLoading] = useState(true);\n    const [traffic, setTraffic] = useState<TrafficDataPoint[]>([]);\n    const [trafficLoading, setTrafficLoading] = useState(true);\n\n    // Default date range: last 7 days.\n    const todayStr = new Date().toISOString().slice(0, 10);\n    const weekAgoStr = new Date(Date.now() - 7 * 86400000).toISOString().slice(0, 10);\n    const [trafficFrom, setTrafficFrom] = useState(weekAgoStr);\n    const [trafficTo, setTrafficTo] = useState(todayStr);\n\n    useEffect(() => {\n        // Fetch school user counts\n        ajaxCall('local_elby_dashboard_get_school_user_counts', {})\n            .then((resp: { schools: SchoolUserCounts[] }) => {\n                const data = resp.schools || [];\n                // Sort by student_count descending, take top 8\n                const sorted = [...data].sort((a, b) => b.student_count - a.student_count).slice(0, 8);\n                setSchools(sorted);\n            })\n            .catch(() => setSchools([]))\n            .finally(() => setSchoolsLoading(false));\n    }, []);\n\n    // Fetch platform traffic whenever date range changes.\n    // Auto-select period granularity based on range size.\n    useEffect(() => {\n        setTrafficLoading(true);\n        const fromTs = Math.floor(new Date(trafficFrom + 'T00:00:00').getTime() / 1000);\n        const toTs = Math.floor(new Date(trafficTo + 'T23:59:59').getTime() / 1000);\n        const rangeDays = Math.round((toTs - fromTs) / 86400);\n        const period = rangeDays > 90 ? 'monthly' : rangeDays > 14 ? 'weekly' : 'daily';\n        ajaxCall('local_elby_dashboard_get_platform_traffic', { period, from_date: fromTs, to_date: toTs })\n            .then((resp: { data: TrafficDataPoint[] }) => setTraffic(resp.data || []))\n            .catch(() => setTraffic([]))\n            .finally(() => setTrafficLoading(false));\n    }, [trafficFrom, trafficTo]);\n\n    const schoolMaxCount = schools.length > 0 ? Math.max(...schools.map(s => s.student_count)) : 1;\n    const trafficMax = traffic.length > 0 ? Math.max(...traffic.map(t => t.unique_users), 1) : 1;\n\n    return (\n        <div className=\"p-2 sm:p-4 lg:p-6 bg-gray-50 min-h-screen\">\n            {/* Row 1: Stats Cards */}\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-6\">\n                <StatCard\n                    icon={<SchoolsIcon />}\n                    value={stats.totalSchools.toLocaleString()}\n                    label=\"Schools\"\n                    customBgColor=\"#dbeafe\"\n                />\n                <StatCard\n                    icon={<StudentsIcon />}\n                    value={stats.totalStudents.toLocaleString()}\n                    label=\"Students\"\n                    customBgColor={themeConfig.statCard1Color}\n                />\n                <StatCard\n                    icon={<TeacherIcon />}\n                    value={stats.totalTeachers.toLocaleString()}\n                    label=\"Teachers\"\n                    customBgColor={themeConfig.statCard2Color}\n                />\n                <StatCard\n                    icon={<EmployeeIcon />}\n                    value={stats.totalUsers.toLocaleString()}\n                    label=\"Total Users\"\n                    customBgColor={themeConfig.statCard3Color}\n                />\n                <StatCard\n                    icon={<CoursesIcon />}\n                    value={stats.totalCourses.toLocaleString()}\n                    label=\"Courses\"\n                    customBgColor={themeConfig.statCard4Color}\n                />\n            </div>\n\n            {/* Row 2: Schools Overview & Engagement Summary */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6\">\n                {/* Section A: Schools Overview */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <h3 className=\"text-lg font-semibold text-gray-800\">Schools Overview</h3>\n                        <span className=\"text-sm text-gray-500\">Top {schools.length} by students</span>\n                    </div>\n                    {schoolsLoading ? (\n                        <div className=\"space-y-3\">\n                            {[...Array(5)].map((_, i) => (\n                                <div key={i} className=\"h-6 bg-gray-100 rounded animate-pulse\" />\n                            ))}\n                        </div>\n                    ) : schools.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500\">\n                            <p>No school data available</p>\n                        </div>\n                    ) : (\n                        <div style={{ display: 'flex', flexDirection: 'column', gap: '1.25rem' }}>\n                            {schools.map((school) => (\n                                <div key={school.school_code} className=\"flex items-center gap-3\">\n                                    <div className=\"w-28 text-xs text-gray-600 truncate flex-shrink-0\" title={school.school_name}>\n                                        {school.school_name}\n                                    </div>\n                                    <div className=\"flex-1 h-6 bg-gray-100 rounded-full overflow-hidden\">\n                                        <div\n                                            className=\"h-full bg-blue-500 rounded-full transition-all opacity-80 hover:opacity-100\"\n                                            style={{ width: `${(school.student_count / schoolMaxCount) * 100}%` }}\n                                        />\n                                    </div>\n                                    <span className=\"text-xs font-medium text-gray-700 w-10 text-right flex-shrink-0\">\n                                        {school.student_count}\n                                    </span>\n                                </div>\n                            ))}\n                        </div>\n                    )}\n                </div>\n\n                {/* Section B: User Overview */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">User Overview</h3>\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-6\">\n                        {/* Gender Demographics */}\n                        <div>\n                            <h4 className=\"text-sm font-medium text-gray-600 mb-3\">Student Demographics</h4>\n                            <div className=\"flex flex-col items-center gap-3\">\n                                <GenderDonut\n                                    male={stats.maleStudents}\n                                    female={stats.femaleStudents}\n                                />\n                                <div className=\"flex items-center gap-3 flex-wrap justify-center\">\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-blue-500\"></span>\n                                        <span className=\"text-xs text-gray-600\">Male: {stats.maleStudents.toLocaleString()}</span>\n                                    </div>\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-pink-500\"></span>\n                                        <span className=\"text-xs text-gray-600\">Female: {stats.femaleStudents.toLocaleString()}</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Engagement Status */}\n                        <div>\n                            <h4 className=\"text-sm font-medium text-gray-600 mb-3\">Engagement Status</h4>\n                            <div className=\"flex flex-col items-center gap-3\">\n                                <EngagementDonut\n                                    activeThisWeek={stats.activeThisWeek}\n                                    atRisk={stats.atRisk}\n                                    neverLoggedIn={stats.neverLoggedIn}\n                                />\n                                <div className=\"flex items-center gap-3 flex-wrap justify-center\">\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-green-500\"></span>\n                                        <span className=\"text-xs text-gray-500\">Active</span>\n                                    </div>\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-amber-500\"></span>\n                                        <span className=\"text-xs text-gray-500\">Inactive</span>\n                                    </div>\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-red-500\"></span>\n                                        <span className=\"text-xs text-gray-500\">Never</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Stat Badges */}\n                    <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-3 mt-4 pt-4 border-t border-gray-100\">\n                        <div className=\"bg-emerald-50 rounded-lg p-3\">\n                            <p className=\"text-xs text-gray-500\">Active Today</p>\n                            <p className=\"text-lg font-bold text-emerald-700\">{stats.activeToday.toLocaleString()}</p>\n                        </div>\n                        <div className=\"bg-green-50 rounded-lg p-3\">\n                            <p className=\"text-xs text-gray-500\">Active This Week</p>\n                            <p className=\"text-lg font-bold text-green-700\">{stats.activeThisWeek.toLocaleString()}</p>\n                        </div>\n                        <div className=\"bg-amber-50 rounded-lg p-3\">\n                            <p className=\"text-xs text-gray-500\">Inactive</p>\n                            <p className=\"text-lg font-bold text-amber-700\">{stats.atRisk.toLocaleString()}</p>\n                        </div>\n                        <div className=\"bg-red-50 rounded-lg p-3\">\n                            <p className=\"text-xs text-gray-500\">Never Logged In</p>\n                            <p className=\"text-lg font-bold text-red-700\">{stats.neverLoggedIn.toLocaleString()}</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Row 3: Students by Grade & Students by Program/Trade */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6\">\n                {/* Students by Grade Level */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <h3 className=\"text-lg font-semibold text-gray-800\">Students by Grade Level</h3>\n                        <span className=\"text-sm text-gray-500\">{stats.gradeDistribution.reduce((s, d) => s + d.count, 0).toLocaleString()} total</span>\n                    </div>\n                    {stats.gradeDistribution.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500\">\n                            <p>No grade data available yet</p>\n                        </div>\n                    ) : (\n                        <div className=\"flex flex-col\" style={{ gap: '16px' }}>\n                            {(() => {\n                                const gradeMax = Math.max(...stats.gradeDistribution.map(d => d.count), 1);\n                                return stats.gradeDistribution.map((d) => (\n                                    <div key={d.label} className=\"flex items-center gap-3\">\n                                        <div className=\"w-20 text-xs text-gray-600 truncate flex-shrink-0\" title={d.label}>\n                                            {d.label}\n                                        </div>\n                                        <div className=\"flex-1 bg-gray-100 rounded-full overflow-hidden\" style={{ height: '20px' }}>\n                                            <div\n                                                className=\"h-full bg-indigo-500 rounded-full transition-all opacity-80 hover:opacity-100\"\n                                                style={{ width: `${(d.count / gradeMax) * 100}%` }}\n                                            />\n                                        </div>\n                                        <span className=\"text-xs font-medium text-gray-700 w-12 text-right flex-shrink-0\">\n                                            {d.count.toLocaleString()}\n                                        </span>\n                                    </div>\n                                ));\n                            })()}\n                        </div>\n                    )}\n                </div>\n\n                {/* Students by Program/Trade */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <h3 className=\"text-lg font-semibold text-gray-800\">Students by Trade</h3>\n                        <span className=\"text-sm text-gray-500\">Top {stats.programDistribution.length}</span>\n                    </div>\n                    {stats.programDistribution.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500\">\n                            <p>No program data available yet</p>\n                        </div>\n                    ) : (\n                        <div className=\"space-y-3\">\n                            {(() => {\n                                const progMax = Math.max(...stats.programDistribution.map(d => d.count), 1);\n                                return stats.programDistribution.map((d) => (\n                                    <div key={d.label} className=\"flex items-center gap-3\">\n                                        <div className=\"w-28 text-xs text-gray-600 truncate flex-shrink-0\" title={d.label}>\n                                            {d.label}\n                                        </div>\n                                        <div className=\"flex-1 h-5 bg-gray-100 rounded-full overflow-hidden\">\n                                            <div\n                                                className=\"h-full bg-teal-500 rounded-full transition-all opacity-80 hover:opacity-100\"\n                                                style={{ width: `${(d.count / progMax) * 100}%` }}\n                                            />\n                                        </div>\n                                        <span className=\"text-xs font-medium text-gray-700 w-12 text-right flex-shrink-0\">\n                                            {d.count.toLocaleString()}\n                                        </span>\n                                    </div>\n                                ));\n                            })()}\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Row 4: Teacher Overview */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6\">\n                {/* Teacher Demographics */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Teacher Overview</h3>\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-6\">\n                        {/* Gender */}\n                        <div>\n                            <h4 className=\"text-sm font-medium text-gray-600 mb-3\">Gender</h4>\n                            <div className=\"flex flex-col items-center gap-3\">\n                                <GenderDonut\n                                    male={stats.maleTeachers}\n                                    female={stats.femaleTeachers}\n                                />\n                                <div className=\"flex items-center gap-3 flex-wrap justify-center\">\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-blue-500\"></span>\n                                        <span className=\"text-xs text-gray-600\">Male: {stats.maleTeachers.toLocaleString()}</span>\n                                    </div>\n                                    <div className=\"flex items-center gap-1.5\">\n                                        <span className=\"w-2.5 h-2.5 rounded-full bg-pink-500\"></span>\n                                        <span className=\"text-xs text-gray-600\">Female: {stats.femaleTeachers.toLocaleString()}</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Summary stats */}\n                        <div>\n                            <h4 className=\"text-sm font-medium text-gray-600 mb-3\">Summary</h4>\n                            <div className=\"space-y-3\">\n                                <div className=\"bg-amber-50 rounded-lg p-3\">\n                                    <p className=\"text-xs text-gray-500\">Total Teachers</p>\n                                    <p className=\"text-lg font-bold text-amber-700\">{stats.totalTeachers.toLocaleString()}</p>\n                                </div>\n                                <div className=\"bg-blue-50 rounded-lg p-3\">\n                                    <p className=\"text-xs text-gray-500\">Positions</p>\n                                    <p className=\"text-lg font-bold text-blue-700\">{stats.positionDistribution.length}</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Teacher Position Distribution */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <h3 className=\"text-lg font-semibold text-gray-800\">Teachers by Position</h3>\n                        <span className=\"text-sm text-gray-500\">{stats.positionDistribution.reduce((s, d) => s + d.count, 0).toLocaleString()} total</span>\n                    </div>\n                    {stats.positionDistribution.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500\">\n                            <p>No teacher data available yet</p>\n                        </div>\n                    ) : (\n                        <div style={{ display: 'flex', flexDirection: 'column', gap: '1.25rem' }}>\n                            {(() => {\n                                const posMax = Math.max(...stats.positionDistribution.map(d => d.count), 1);\n                                return stats.positionDistribution.map((d) => (\n                                    <div key={d.label} className=\"flex items-center gap-3\">\n                                        <div className=\"w-28 text-xs text-gray-600 truncate flex-shrink-0\" title={d.label}>\n                                            {d.label}\n                                        </div>\n                                        <div className=\"flex-1 h-6 bg-gray-100 rounded-full overflow-hidden\">\n                                            <div\n                                                className=\"h-full bg-amber-500 rounded-full transition-all opacity-80 hover:opacity-100\"\n                                                style={{ width: `${(d.count / posMax) * 100}%` }}\n                                            />\n                                        </div>\n                                        <span className=\"text-xs font-medium text-gray-700 w-12 text-right flex-shrink-0\">\n                                            {d.count.toLocaleString()}\n                                        </span>\n                                    </div>\n                                ));\n                            })()}\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Row 5: Platform Traffic */}\n            <div className=\"gap-6\">\n                {/* Platform Traffic */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm overflow-hidden\">\n                    <div className=\"flex items-center justify-between mb-4 flex-wrap gap-2\">\n                        <h3 className=\"text-lg font-semibold text-gray-800\">Platform Traffic</h3>\n                        <div className=\"flex items-center gap-2\">\n                            <label className=\"flex items-center gap-1 text-xs text-gray-500\">\n                                From\n                                <input\n                                    type=\"date\"\n                                    value={trafficFrom}\n                                    max={trafficTo}\n                                    onChange={(e) => setTrafficFrom((e.target as HTMLInputElement).value)}\n                                    className=\"border border-gray-200 rounded-md px-2 py-1 text-xs text-gray-700 bg-white\"\n                                />\n                            </label>\n                            <label className=\"flex items-center gap-1 text-xs text-gray-500\">\n                                To\n                                <input\n                                    type=\"date\"\n                                    value={trafficTo}\n                                    min={trafficFrom}\n                                    max={todayStr}\n                                    onChange={(e) => setTrafficTo((e.target as HTMLInputElement).value)}\n                                    className=\"border border-gray-200 rounded-md px-2 py-1 text-xs text-gray-700 bg-white\"\n                                />\n                            </label>\n                        </div>\n                    </div>\n                    {trafficLoading ? (\n                        <div className=\"flex items-end justify-between h-56 gap-2 px-2\">\n                            {[...Array(7)].map((_, i) => (\n                                <div key={i} className=\"flex-1 bg-gray-100 rounded-t animate-pulse\" style={{ height: `${30 + Math.random() * 50}%` }} />\n                            ))}\n                        </div>\n                    ) : traffic.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500\">\n                            <p>No traffic data available</p>\n                        </div>\n                    ) : (\n                        <>\n                            <div className=\"overflow-x-auto\">\n                                <div className=\"flex items-end h-56 gap-2 px-2\" style={{ minWidth: traffic.length > 15 ? `${traffic.length * 3}rem` : undefined }}>\n                                    {traffic.map((point) => (\n                                        <div key={point.period_label} className=\"flex flex-col items-center gap-1 flex-1\" style={{ minWidth: '2rem' }}>\n                                            <span className=\"text-xs font-medium text-gray-600 whitespace-nowrap\">{point.unique_users}</span>\n                                            <div className=\"w-full flex justify-center\" style={{ height: '10rem' }}>\n                                                <div className=\"flex items-end h-full w-full max-w-[2.5rem]\">\n                                                    <div\n                                                        className=\"w-full bg-blue-500 rounded-t opacity-80 hover:opacity-100 transition-opacity\"\n                                                        style={{ height: `${(point.unique_users / trafficMax) * 100}%`, minHeight: point.unique_users > 0 ? '4px' : '0' }}\n                                                    />\n                                                </div>\n                                            </div>\n                                            <span className=\"text-xs text-gray-500 whitespace-nowrap\">{point.period_label}</span>\n                                        </div>\n                                    ))}\n                                </div>\n                            </div>\n                            <div className=\"flex items-center gap-4 mt-3 pt-3 border-t border-gray-100\">\n                                <div className=\"flex items-center gap-1.5\">\n                                    <span className=\"w-2.5 h-2.5 rounded-full bg-blue-500\"></span>\n                                    <span className=\"text-xs text-gray-500\">Unique Users</span>\n                                </div>\n                            </div>\n                        </>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Sidebar navigation component for Elby Dashboard.\n *\n * @module     local_elby_dashboard/components/Sidebar\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport type { PageId, SidenavConfig, ThemeConfig } from '../types';\n\ninterface SidebarProps {\n    activePage: PageId;\n    sidenavConfig: SidenavConfig;\n    themeConfig: ThemeConfig;\n    isOpen: boolean;\n    onClose: () => void;\n}\n\n// Menu items\nconst menuItems = [\n    { id: 'home', name: 'Dashboard', icon: 'dashboard', url: '/local/elby_dashboard/index.php' },\n    { id: 'schools', name: 'Schools', icon: 'pedagogy', url: '/local/elby_dashboard/schools.php', capability: 'viewreports' },\n    { id: 'students', name: 'Students', icon: 'communication', url: '/local/elby_dashboard/students.php', capability: 'viewreports' },\n    { id: 'teachers', name: 'Teachers', icon: 'presence', url: '/local/elby_dashboard/teachers.php', capability: 'viewreports' },\n    { id: 'traffic', name: 'Traffic', icon: 'event', url: '/local/elby_dashboard/traffic.php', capability: 'viewreports' },\n    { id: 'accesslog', name: 'Access Log', icon: 'courses', url: '/local/elby_dashboard/accesslog.php', capability: 'viewreports' },\n    { id: 'admin', name: 'Admin Panel', icon: 'settings', url: '/local/elby_dashboard/admin/index.php', capability: 'admin' },\n];\n\n// Icon components\nconst icons: Record<string, JSX.Element> = {\n    dashboard: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M4 4h4v4H4V4zm6 0h4v4h-4V4zm6 0h4v4h-4V4zM4 10h4v4H4v-4zm6 0h4v4h-4v-4zm6 0h4v4h-4v-4zM4 16h4v4H4v-4zm6 0h4v4h-4v-4zm6 0h4v4h-4v-4z\"/>\n        </svg>\n    ),\n    courses: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z\"/>\n        </svg>\n    ),\n    presence: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V9h14v10zM5 7V5h14v2H5zm2 4h10v2H7v-2zm0 4h7v2H7v-2z\"/>\n        </svg>\n    ),\n    communication: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z\"/>\n        </svg>\n    ),\n    event: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z\"/>\n        </svg>\n    ),\n    payment: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z\"/>\n        </svg>\n    ),\n    pedagogy: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73v3.72z\"/>\n        </svg>\n    ),\n    message: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z\"/>\n        </svg>\n    ),\n    completion: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z\"/>\n        </svg>\n    ),\n    settings: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z\"/>\n        </svg>\n    ),\n    logout: (\n        <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5-5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z\"/>\n        </svg>\n    ),\n};\n\n// Default logo icon (fallback when no logo is uploaded)\nconst DefaultLogoIcon = () => (\n    <svg className=\"w-8 h-8\" viewBox=\"0 0 40 40\" fill=\"none\">\n        <rect x=\"4\" y=\"20\" width=\"16\" height=\"16\" fill=\"#22d3ee\" transform=\"rotate(-45 12 28)\"/>\n        <rect x=\"20\" y=\"4\" width=\"16\" height=\"16\" fill=\"#fbbf24\" transform=\"rotate(-45 28 12)\"/>\n    </svg>\n);\n\nexport default function Sidebar({ activePage, sidenavConfig, themeConfig, isOpen, onClose }: SidebarProps) {\n    // Filter menu items based on visibility settings\n    const visibleMenuItems = menuItems.filter((item) => {\n        // Dashboard (home) is always visible\n        if (item.id === 'home') return true;\n        // Check visibility from theme config\n        return themeConfig.menuVisibility[item.id] !== false;\n    });\n\n    return (\n        <>\n            {/* Mobile backdrop overlay */}\n            {isOpen && (\n                <div\n                    className=\"fixed inset-0 bg-black/50 z-40 lg:hidden\"\n                    onClick={onClose}\n                />\n            )}\n\n            {/* Sidebar */}\n            <aside className={`\n                fixed lg:sticky inset-y-0 left-0 z-50 top-0\n                w-72 h-screen bg-gray-50 border-r border-gray-200 py-6 pr-4 overflow-y-auto flex flex-col\n                transform transition-transform duration-300 ease-in-out\n                ${isOpen ? 'translate-x-0' : '-translate-x-full lg:translate-x-0'}\n            `}>\n                {/* Header with logo and close button */}\n                <div className=\"pl-3 pb-6 flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                        {sidenavConfig.logoUrl ? (\n                            <img\n                                src={sidenavConfig.logoUrl}\n                                alt={sidenavConfig.title}\n                                className=\"w-8 h-8 object-contain\"\n                            />\n                        ) : (\n                            <DefaultLogoIcon />\n                        )}\n                        <span className=\"text-lg font-bold text-gray-800\">{sidenavConfig.title}</span>\n                    </div>\n                    {/* Close button - Mobile only */}\n                    <button\n                        onClick={onClose}\n                        className=\"lg:hidden p-2 mr-2 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded-lg\"\n                        aria-label=\"Close menu\"\n                    >\n                        <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" />\n                        </svg>\n                    </button>\n                </div>\n\n                {/* Main Menu Section */}\n                <div className=\"mb-8 flex-1\">\n                    <h6 className=\"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 pl-3\">\n                        Menu\n                    </h6>\n                    <ul className=\"space-y-1 m-0 p-0 list-none\">\n                        {visibleMenuItems.map((item) => {\n                            const isActive = item.id === activePage;\n                            return (\n                                <li key={item.id}>\n                                    <a\n                                        href={item.url}\n                                        className={`flex items-center px-3 py-2 rounded text-sm transition-colors no-underline ${\n                                            isActive\n                                                ? 'text-white'\n                                                : 'text-gray-700 hover:bg-gray-200'\n                                        }`}\n                                        style={isActive ? { backgroundColor: themeConfig.sidenavAccentColor } : undefined}\n                                    >\n                                        <span className={`w-5 mr-3 ${isActive ? 'text-white' : 'text-gray-500'}`}>\n                                            {icons[item.icon]}\n                                        </span>\n                                        <span>{item.name}</span>\n                                    </a>\n                                </li>\n                            );\n                        })}\n                    </ul>\n                </div>\n\n                {/* Account Section */}\n                <div className=\"mt-auto\">\n                    <h6 className=\"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 pl-3\">\n                        Account\n                    </h6>\n                    <ul className=\"space-y-1 m-0 p-0 list-none\">\n                        <li>\n                            <a\n                                href=\"/login/logout.php\"\n                                className=\"flex items-center px-3 py-2 rounded text-sm text-gray-700 hover:bg-gray-200 no-underline transition-colors\"\n                            >\n                                <span className=\"w-5 mr-3 text-gray-500\">{icons.logout}</span>\n                                <span>Log out</span>\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n            </aside>\n        </>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Completion Report component for RTB Dashboard.\n *\n * @module     local_rtbdashboard/components/CompletionReport\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState } from 'preact/hooks';\n\n// Parent category structure\ninterface ParentCategory {\n    id: number;\n    name: string;\n}\n\n// Unit data structure\ninterface UnitData {\n    average: number | null;\n    completionRate: string;\n}\n\n// Category row data structure\ninterface CategoryData {\n    id: number;\n    name: string;\n    parentId: number;\n    participants: number;\n    units: UnitData[];\n}\n\n// Dummy parent categories\nconst parentCategories: ParentCategory[] = [\n    { id: 0, name: 'All Categories' },\n    { id: 1, name: 'Kigali City' },\n    { id: 2, name: 'Eastern Province' },\n    { id: 3, name: 'Western Province' },\n    { id: 4, name: 'Northern Province' },\n    { id: 5, name: 'Southern Province' },\n];\n\n// Dummy data matching the image structure\nconst dummyData: CategoryData[] = [\n    {\n        id: 1,\n        name: 'Bicumbi',\n        parentId: 2,\n        participants: 47,\n        units: [\n            { average: 9.2, completionRate: '95.7%' },\n            { average: 3.67, completionRate: '4.3%' },\n            { average: 2.82, completionRate: '4.3%' },\n            { average: 5, completionRate: '2.1%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 2,\n        name: 'Cyahinda',\n        parentId: 5,\n        participants: 101,\n        units: [\n            { average: 8.8, completionRate: '55.4%' },\n            { average: 7.52, completionRate: '10.9%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 9.31, completionRate: '12.9%' },\n            { average: 7.81, completionRate: '5.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 6.52, completionRate: '4.0%' },\n            { average: 9.02, completionRate: '6.9%' },\n        ],\n    },\n    {\n        id: 3,\n        name: 'De La Salle Byumba',\n        parentId: 4,\n        participants: 90,\n        units: [\n            { average: 6.7, completionRate: '93.3%' },\n            { average: 6.23, completionRate: '62.2%' },\n            { average: 5.3, completionRate: '25.6%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 5.88, completionRate: '1.1%' },\n            { average: 2.14, completionRate: '1.1%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 4,\n        name: 'Gacuba II',\n        parentId: 3,\n        participants: 86,\n        units: [\n            { average: 6.6, completionRate: '84.9%' },\n            { average: 7.32, completionRate: '43.0%' },\n            { average: 0, completionRate: '1.2%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 5,\n        name: 'Kabarore',\n        parentId: 4,\n        participants: 93,\n        units: [\n            { average: 9.4, completionRate: '96.8%' },\n            { average: 5.82, completionRate: '11.8%' },\n            { average: 8.75, completionRate: '1.1%' },\n            { average: 9.09, completionRate: '1.1%' },\n            { average: 0.38, completionRate: '1.1%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 6.43, completionRate: '1.1%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 6,\n        name: 'Kirambo',\n        parentId: 3,\n        participants: 97,\n        units: [\n            { average: 5.3, completionRate: '3.1%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 3.75, completionRate: '1.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 7,\n        name: 'Matimba',\n        parentId: 2,\n        participants: 44,\n        units: [\n            { average: 9.3, completionRate: '93.2%' },\n            { average: 4.25, completionRate: '18.2%' },\n            { average: 4.38, completionRate: '6.8%' },\n            { average: 5, completionRate: '2.3%' },\n            { average: 10, completionRate: '2.3%' },\n            { average: 7.65, completionRate: '2.3%' },\n            { average: 7.14, completionRate: '2.3%' },\n            { average: 8.75, completionRate: '2.3%' },\n        ],\n    },\n    {\n        id: 8,\n        name: 'Mbuga',\n        parentId: 1,\n        participants: 93,\n        units: [\n            { average: 8.5, completionRate: '92.5%' },\n            { average: 3.33, completionRate: '2.2%' },\n            { average: 10, completionRate: '1.1%' },\n            { average: 9.55, completionRate: '1.1%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 9,\n        name: 'Muhanga',\n        parentId: 5,\n        participants: 50,\n        units: [\n            { average: 7.3, completionRate: '88.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 10,\n        name: 'Muramba',\n        parentId: 3,\n        participants: 31,\n        units: [\n            { average: 9.7, completionRate: '100.0%' },\n            { average: 9.29, completionRate: '93.5%' },\n            { average: 7.82, completionRate: '6.5%' },\n            { average: 7.28, completionRate: '6.5%' },\n            { average: 8.75, completionRate: '6.5%' },\n            { average: 7.84, completionRate: '9.7%' },\n            { average: 7.68, completionRate: '6.5%' },\n            { average: 7.71, completionRate: '9.7%' },\n        ],\n    },\n    {\n        id: 11,\n        name: 'Mururu',\n        parentId: 3,\n        participants: 63,\n        units: [\n            { average: 9.3, completionRate: '92.1%' },\n            { average: 3.33, completionRate: '1.6%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 7.12, completionRate: '4.8%' },\n            { average: 9.62, completionRate: '3.2%' },\n            { average: 8.82, completionRate: '4.8%' },\n            { average: 4.47, completionRate: '3.2%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 12,\n        name: 'Mwezi',\n        parentId: 4,\n        participants: 58,\n        units: [\n            { average: 9.9, completionRate: '100.0%' },\n            { average: 9, completionRate: '89.7%' },\n            { average: 0, completionRate: '1.7%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: 1.25, completionRate: '1.7%' },\n        ],\n    },\n    {\n        id: 13,\n        name: 'Nyamata',\n        parentId: 2,\n        participants: 89,\n        units: [\n            { average: 7.7, completionRate: '10.1%' },\n            { average: 1.78, completionRate: '3.4%' },\n            { average: 8.78, completionRate: '53.9%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n    {\n        id: 14,\n        name: 'Rubengera',\n        parentId: 3,\n        participants: 51,\n        units: [\n            { average: 6.4, completionRate: '100.0%' },\n            { average: 6.11, completionRate: '98.0%' },\n            { average: 3.44, completionRate: '3.9%' },\n            { average: 5.15, completionRate: '2.0%' },\n            { average: 3.27, completionRate: '2.0%' },\n            { average: 2.94, completionRate: '2.0%' },\n            { average: 3.93, completionRate: '2.0%' },\n            { average: 1.88, completionRate: '2.0%' },\n        ],\n    },\n    {\n        id: 15,\n        name: 'Save',\n        parentId: 5,\n        participants: 90,\n        units: [\n            { average: 8.1, completionRate: '94.4%' },\n            { average: 5.84, completionRate: '18.9%' },\n            { average: 3.75, completionRate: '1.1%' },\n            { average: 4.09, completionRate: '1.1%' },\n            { average: 3.65, completionRate: '1.1%' },\n            { average: 5.88, completionRate: '2.2%' },\n            { average: 6.31, completionRate: '3.3%' },\n            { average: 6.88, completionRate: '1.1%' },\n        ],\n    },\n    {\n        id: 16,\n        name: 'Zaza',\n        parentId: 2,\n        participants: 114,\n        units: [\n            { average: 8.4, completionRate: '91.2%' },\n            { average: 5.13, completionRate: '20.2%' },\n            { average: 4.38, completionRate: '0.9%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n            { average: null, completionRate: '0.0%' },\n        ],\n    },\n];\n\n// Grand total row\nconst grandTotal = {\n    name: 'Grand total',\n    participants: 1197,\n    units: [\n        { average: 8.3, completionRate: '76.7%' },\n        { average: 6.9, completionRate: '25.2%' },\n        { average: 7.07, completionRate: '7.3%' },\n        { average: 8.12, completionRate: '2.0%' },\n        { average: 7.16, completionRate: '1.1%' },\n        { average: 7.11, completionRate: '0.9%' },\n        { average: 5.93, completionRate: '1.3%' },\n        { average: 7.5, completionRate: '1.2%' },\n    ],\n};\n\nconst unitLabels = ['U1', 'U2', 'U3', 'U4', 'U5', 'U6', 'U7', 'U8'];\n\nexport default function CompletionReport() {\n    const [selectedParentId, setSelectedParentId] = useState(0);\n\n    // Filter data based on selected parent category\n    const filteredData = selectedParentId === 0\n        ? dummyData\n        : dummyData.filter(row => row.parentId === selectedParentId);\n\n    // Calculate grand total for filtered data\n    const calculateGrandTotal = () => {\n        if (filteredData.length === 0) {\n            return grandTotal;\n        }\n\n        const totalParticipants = filteredData.reduce((sum, row) => sum + row.participants, 0);\n\n        // Calculate average for each unit\n        const unitTotals = unitLabels.map((_, unitIndex) => {\n            const validRows = filteredData.filter(row => row.units[unitIndex].average !== null);\n            if (validRows.length === 0) {\n                return { average: null, completionRate: '0.0%' };\n            }\n\n            const avgSum = validRows.reduce((sum, row) => sum + (row.units[unitIndex].average || 0), 0);\n            const crSum = filteredData.reduce((sum, row) => {\n                const cr = parseFloat(row.units[unitIndex].completionRate);\n                return sum + (isNaN(cr) ? 0 : cr);\n            }, 0);\n\n            return {\n                average: Math.round((avgSum / validRows.length) * 100) / 100,\n                completionRate: `${(crSum / filteredData.length).toFixed(1)}%`,\n            };\n        });\n\n        return {\n            name: 'Grand total',\n            participants: totalParticipants,\n            units: unitTotals,\n        };\n    };\n\n    const currentGrandTotal = selectedParentId === 0 ? grandTotal : calculateGrandTotal();\n\n    return (\n        <div className=\"p-2 sm:p-4 lg:p-6 bg-white min-h-screen\">\n            {/* Page Header */}\n            <div className=\"mb-6\">\n                <h1 className=\"text-2xl font-bold text-gray-800\">Overview</h1>\n            </div>\n\n            {/* Category Filter */}\n            <div className=\"mb-4\">\n                <label htmlFor=\"parent-category\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Parent Category\n                </label>\n                <select\n                    id=\"parent-category\"\n                    value={selectedParentId}\n                    onChange={(e) => setSelectedParentId(Number((e.target as HTMLSelectElement).value))}\n                    className=\"border border-gray-300 rounded-lg px-3 py-2 min-w-[200px] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                    {parentCategories.map((cat) => (\n                        <option key={cat.id} value={cat.id}>\n                            {cat.name}\n                        </option>\n                    ))}\n                </select>\n            </div>\n\n            {/* Table */}\n            <div className=\"overflow-x-auto\">\n                <table className=\"w-full text-sm\">\n                    <thead>\n                        <tr className=\"border-b border-gray-200\">\n                            <th className=\"py-3 px-2 text-left font-medium text-gray-600 w-8\"></th>\n                            <th className=\"py-3 px-2 text-left font-medium text-gray-600 min-w-[140px]\">\n                                Category <span className=\"text-gray-400\"></span>\n                            </th>\n                            <th className=\"py-3 px-2 text-center font-medium text-gray-600\"># of Stds</th>\n                            {unitLabels.map((unit) => (\n                                <>\n                                    <th key={`${unit}-ave`} className=\"py-3 px-2 text-center font-medium text-gray-600\">\n                                        {unit} Ave.\n                                    </th>\n                                    <th key={`${unit}-cr`} className=\"py-3 px-2 text-center font-medium text-gray-600\">\n                                        {unit} CR\n                                    </th>\n                                </>\n                            ))}\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {filteredData.map((row, index) => (\n                            <tr\n                                key={row.id}\n                                className={index % 2 === 0 ? 'bg-sky-50' : 'bg-white'}\n                            >\n                                <td className=\"py-2 px-2 text-gray-500\">{index + 1}.</td>\n                                <td className=\"py-2 px-2 text-gray-800\">{row.name}</td>\n                                <td className=\"py-2 px-2 text-center text-gray-600\">{row.participants}</td>\n                                {row.units.map((unit, unitIndex) => (\n                                    <>\n                                        <td key={`ave-${unitIndex}`} className=\"py-2 px-2 text-center text-gray-600\">\n                                            {unit.average !== null ? unit.average : '-'}\n                                        </td>\n                                        <td key={`cr-${unitIndex}`} className=\"py-2 px-2 text-center text-gray-600\">\n                                            {unit.completionRate}\n                                        </td>\n                                    </>\n                                ))}\n                            </tr>\n                        ))}\n                        {/* Grand Total Row */}\n                        <tr className=\"bg-white border-t border-gray-300\">\n                            <td className=\"py-2 px-2\"></td>\n                            <td className=\"py-2 px-2 font-semibold text-gray-800\">{currentGrandTotal.name}</td>\n                            <td className=\"py-2 px-2 text-center font-semibold text-gray-800\">\n                                {currentGrandTotal.participants >= 1000\n                                    ? `${(currentGrandTotal.participants / 1000).toFixed(1)}K`\n                                    : currentGrandTotal.participants}\n                            </td>\n                            {currentGrandTotal.units.map((unit, unitIndex) => (\n                                <>\n                                    <td key={`total-ave-${unitIndex}`} className=\"py-2 px-2 text-center font-semibold text-gray-800\">\n                                        {unit.average !== null ? unit.average : '-'}\n                                    </td>\n                                    <td key={`total-cr-${unitIndex}`} className=\"py-2 px-2 text-center font-semibold text-gray-800\">\n                                        {unit.completionRate}\n                                    </td>\n                                </>\n                            ))}\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n\n            {filteredData.length === 0 && (\n                <div className=\"text-center py-8 text-gray-500\">\n                    No categories found for the selected parent category.\n                </div>\n            )}\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Courses Report component for Elby Dashboard.\n *\n * @module     local_elby_dashboard/components/CoursesReport\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect, useRef, useMemo } from 'preact/hooks';\nimport type { CoursesReportData, ThemeConfig, CourseReport, SchoolReport, CategoryNode, CourseListItem } from '../types';\n\n// Sort configuration type\ntype SortColumn = 'school' | 'students' | `avg-${number}` | `cr-${number}`;\ntype SortDirection = 'asc' | 'desc';\n\ninterface CoursesReportProps {\n    data: CoursesReportData;\n    themeConfig: ThemeConfig;\n}\n\n// Tree Course Select Component\ninterface TreeCourseSelectProps {\n    tree: CategoryNode[];\n    selectedId: number | null;\n    placeholder: string;\n    onSelect: (id: number) => void;\n}\n\n// Check if a node or any of its descendants match the search\nfunction nodeMatchesSearch(node: CategoryNode, query: string): boolean {\n    const lowerQuery = query.toLowerCase();\n    // Check if any direct courses match\n    const hasMatchingCourse = node.courses.some(course =>\n        course.id.toString().includes(query) ||\n        course.fullname.toLowerCase().includes(lowerQuery) ||\n        course.shortname.toLowerCase().includes(lowerQuery)\n    );\n    if (hasMatchingCourse) return true;\n    // Check children recursively\n    return node.children.some(child => nodeMatchesSearch(child, query));\n}\n\n// Recursive tree node component\nfunction TreeNode({\n    node,\n    depth,\n    expandedNodes,\n    onToggle,\n    selectedId,\n    onSelect,\n    searchQuery\n}: {\n    node: CategoryNode;\n    depth: number;\n    expandedNodes: Set<string>;\n    onToggle: (key: string) => void;\n    selectedId: number | null;\n    onSelect: (id: number) => void;\n    searchQuery: string;\n}) {\n    const nodeKey = `cat-${node.id}`;\n    const isExpanded = expandedNodes.has(nodeKey);\n    const hasChildren = node.children.length > 0;\n    const hasCourses = node.courses.length > 0;\n    const paddingLeft = depth * 16 + 12;\n\n    // Filter courses based on search\n    const lowerQuery = searchQuery.toLowerCase();\n    const matchingCourses = searchQuery\n        ? node.courses.filter(course =>\n            course.id.toString().includes(searchQuery) ||\n            course.fullname.toLowerCase().includes(lowerQuery) ||\n            course.shortname.toLowerCase().includes(lowerQuery)\n        )\n        : node.courses;\n\n    // Check if any descendant matches search\n    const hasMatchingDescendants = searchQuery\n        ? node.children.some(child => nodeMatchesSearch(child, searchQuery))\n        : true;\n\n    // Hide non-matching branches when searching\n    if (searchQuery && matchingCourses.length === 0 && !hasMatchingDescendants) {\n        return null;\n    }\n\n    return (\n        <div>\n            {/* Category row */}\n            <button\n                type=\"button\"\n                onClick={() => onToggle(nodeKey)}\n                className=\"w-full py-2 text-left text-sm font-medium text-gray-700 hover:bg-gray-100 flex items-center\"\n                style={{ paddingLeft }}\n            >\n                <span className=\"w-4 mr-1 text-gray-400 shrink-0\">\n                    {(hasChildren || hasCourses) && (isExpanded ? '' : '')}\n                </span>\n                <span className=\"truncate\">{node.name}</span>\n            </button>\n\n            {/* Children and courses */}\n            {isExpanded && (\n                <>\n                    {node.children.map(child => (\n                        <TreeNode\n                            key={child.id}\n                            node={child}\n                            depth={depth + 1}\n                            expandedNodes={expandedNodes}\n                            onToggle={onToggle}\n                            selectedId={selectedId}\n                            onSelect={onSelect}\n                            searchQuery={searchQuery}\n                        />\n                    ))}\n                    {matchingCourses.map(course => (\n                        <button\n                            key={course.id}\n                            type=\"button\"\n                            onClick={() => onSelect(course.id)}\n                            className={`w-full py-2 text-left text-sm hover:bg-blue-50 flex items-center justify-between pr-3 ${\n                                Number(course.id) === Number(selectedId) ? 'bg-blue-50 text-blue-700' : 'text-gray-600'\n                            }`}\n                            style={{ paddingLeft: (depth + 1) * 16 + 12 }}\n                        >\n                            <div className=\"flex items-center gap-1 truncate\">\n                                <span className=\"text-gray-400 shrink-0\">[{course.id}]</span>\n                                <span className=\"truncate\">{course.fullname}</span>\n                            </div>\n                            <span className=\"text-xs text-gray-400 ml-2 shrink-0\">\n                                {course.enrolled_count} enrolled\n                            </span>\n                        </button>\n                    ))}\n                </>\n            )}\n        </div>\n    );\n}\n\n// Find course by traversing tree\nfunction findCourseInTree(nodes: CategoryNode[], courseId: number | null): CourseListItem | undefined {\n    if (!courseId) return undefined;\n    // Use == for comparison to handle string/number type mismatches from JSON\n    const targetId = Number(courseId);\n    for (const node of nodes) {\n        const found = node.courses.find(c => Number(c.id) === targetId);\n        if (found) return found;\n        const inChildren = findCourseInTree(node.children, courseId);\n        if (inChildren) return inChildren;\n    }\n    return undefined;\n}\n\n// Collect all node keys from tree\nfunction collectAllNodeKeys(nodes: CategoryNode[]): Set<string> {\n    const keys = new Set<string>();\n    const collect = (nodeList: CategoryNode[]) => {\n        for (const n of nodeList) {\n            keys.add(`cat-${n.id}`);\n            collect(n.children);\n        }\n    };\n    collect(nodes);\n    return keys;\n}\n\nfunction TreeCourseSelect({ tree, selectedId, placeholder, onSelect }: TreeCourseSelectProps) {\n    const [isOpen, setIsOpen] = useState(false);\n    const [searchQuery, setSearchQuery] = useState('');\n    const [expandedNodes, setExpandedNodes] = useState<Set<string>>(new Set());\n    const containerRef = useRef<HTMLDivElement>(null);\n    const searchInputRef = useRef<HTMLInputElement>(null);\n\n    const selectedCourse = findCourseInTree(tree, selectedId);\n\n    const toggleNode = (key: string) => {\n        const newExpanded = new Set(expandedNodes);\n        if (newExpanded.has(key)) {\n            newExpanded.delete(key);\n        } else {\n            newExpanded.add(key);\n        }\n        setExpandedNodes(newExpanded);\n    };\n\n    // Handle click outside to close dropdown\n    useEffect(() => {\n        const handleClickOutside = (event: MouseEvent) => {\n            if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\n                setIsOpen(false);\n                setSearchQuery('');\n            }\n        };\n\n        document.addEventListener('mousedown', handleClickOutside);\n        return () => document.removeEventListener('mousedown', handleClickOutside);\n    }, []);\n\n    // Focus search input when dropdown opens\n    useEffect(() => {\n        if (isOpen && searchInputRef.current) {\n            searchInputRef.current.focus();\n        }\n    }, [isOpen]);\n\n    // Auto-expand all when searching\n    useEffect(() => {\n        if (searchQuery) {\n            setExpandedNodes(collectAllNodeKeys(tree));\n        }\n    }, [searchQuery, tree]);\n\n    const handleSelect = (id: number) => {\n        onSelect(id);\n        setIsOpen(false);\n        setSearchQuery('');\n    };\n\n    return (\n        <div ref={containerRef} className=\"relative w-full max-w-md\">\n            {/* Trigger Button */}\n            <button\n                type=\"button\"\n                onClick={() => setIsOpen(!isOpen)}\n                className=\"w-full px-4 py-2.5 text-left bg-white border border-gray-300 rounded-lg flex items-center justify-between hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            >\n                <span className={selectedCourse ? 'text-gray-900' : 'text-gray-500'}>\n                    {selectedCourse ? `[${selectedCourse.id}] ${selectedCourse.fullname}` : placeholder}\n                </span>\n                <svg\n                    className={`w-5 h-5 text-gray-400 transition-transform ${isOpen ? 'rotate-180' : ''}`}\n                    viewBox=\"0 0 20 20\"\n                    fill=\"currentColor\"\n                >\n                    <path fillRule=\"evenodd\" d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                </svg>\n            </button>\n\n            {/* Dropdown */}\n            {isOpen && (\n                <div className=\"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg\">\n                    {/* Search Input */}\n                    <div className=\"p-2 border-b border-gray-100\">\n                        <div className=\"flex items-center gap-2 px-3 py-2 border border-gray-200 rounded-md focus-within:ring-1 focus-within:ring-blue-500 focus-within:border-blue-500\">\n                            <svg\n                                className=\"w-4 h-4 text-gray-400 shrink-0\"\n                                viewBox=\"0 0 20 20\"\n                                fill=\"currentColor\"\n                            >\n                                <path fillRule=\"evenodd\" d=\"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z\" clipRule=\"evenodd\" />\n                            </svg>\n                            <input\n                                ref={searchInputRef}\n                                type=\"text\"\n                                placeholder=\"Search course...\"\n                                value={searchQuery}\n                                onInput={(e) => setSearchQuery((e.target as HTMLInputElement).value)}\n                                className=\"w-full text-sm bg-transparent border-none outline-none focus:outline-none focus:ring-0\"\n                            />\n                        </div>\n                    </div>\n\n                    {/* Tree Options List */}\n                    <div className=\"max-h-80 overflow-y-auto\">\n                        {tree.length > 0 ? (\n                            tree.map(node => (\n                                <TreeNode\n                                    key={node.id}\n                                    node={node}\n                                    depth={0}\n                                    expandedNodes={expandedNodes}\n                                    onToggle={toggleNode}\n                                    selectedId={selectedId}\n                                    onSelect={handleSelect}\n                                    searchQuery={searchQuery}\n                                />\n                            ))\n                        ) : (\n                            <div className=\"px-4 py-3 text-sm text-gray-500 text-center\">\n                                No courses found\n                            </div>\n                        )}\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n\n// Year Select Component\ninterface YearSelectProps {\n    years: { value: number; label: string }[];\n    selectedYear: number;\n    onSelect: (year: number) => void;\n}\n\nfunction YearSelect({ years, selectedYear, onSelect }: YearSelectProps) {\n    return (\n        <select\n            value={selectedYear}\n            onChange={(e) => onSelect(parseInt((e.target as HTMLSelectElement).value))}\n            className=\"px-4 py-2.5 bg-white border border-gray-300 rounded-lg text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n        >\n            {years.map(year => (\n                <option key={year.value} value={year.value}>\n                    {year.label}\n                </option>\n            ))}\n        </select>\n    );\n}\n\n// Color palette for donut charts (orange, green, blue, purple, teal)\nconst DONUT_COLORS = ['#F5A623', '#4CAF50', '#2196F3', '#9C27B0', '#00BCD4'];\n\n// Donut Chart Component for completion rate\nfunction CompletionDonut({ rate, label, colorIndex = 0 }: { rate: number; label: string; color?: string; colorIndex?: number }) {\n    const size = 120;\n    const strokeWidth = 10;\n    const radius = (size - strokeWidth) / 2;\n    const circumference = 2 * Math.PI * radius;\n    // Calculate the length of the progress arc\n    const progressLength = (rate / 100) * circumference;\n    const progressColor = DONUT_COLORS[colorIndex % DONUT_COLORS.length];\n    const center = size / 2;\n\n    return (\n        <div className=\"flex flex-col items-center\">\n            <div className=\"relative\" style={{ width: size, height: size }}>\n                <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`}>\n                    {/* Background circle - gray track (always visible) */}\n                    <circle\n                        cx={center}\n                        cy={center}\n                        r={radius}\n                        fill=\"none\"\n                        stroke=\"#e5e5e5\"\n                        stroke-width={strokeWidth}\n                    />\n                    {/* Progress circle - colored arc starting from top */}\n                    {rate > 0 && (\n                        <circle\n                            cx={center}\n                            cy={center}\n                            r={radius}\n                            fill=\"none\"\n                            stroke={progressColor}\n                            stroke-width={strokeWidth}\n                            stroke-linecap=\"round\"\n                            stroke-dasharray={`${progressLength} ${circumference - progressLength}`}\n                            transform={`rotate(-90 ${center} ${center})`}\n                        />\n                    )}\n                </svg>\n                <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <span className=\"text-2xl font-normal text-gray-500\">{rate.toFixed(0)}%</span>\n                </div>\n            </div>\n            <span className=\"text-xs text-gray-600 mt-2 text-center font-medium max-w-[140px]\">{label}</span>\n        </div>\n    );\n}\n\n// Truncate text with ellipsis\nfunction truncateText(text: string, maxLength: number): string {\n    if (text.length <= maxLength) return text;\n    return text.substring(0, maxLength - 1) + '';\n}\n\n// Bar Chart for completion rate and average score per school\nfunction SchoolBarChart({ schools, sectionIndex, themeConfig }: {\n    schools: SchoolReport[];\n    sectionIndex: number;\n    themeConfig: ThemeConfig;\n}) {\n    // Get grademax from first school's section data for percentage conversion\n    const grademax = schools[0]?.sections[sectionIndex]?.grademax || 100;\n\n    return (\n        <div className=\"bg-white rounded-xl p-6 shadow-sm overflow-visible\">\n            <div className=\"flex items-center gap-4 mb-6\">\n                <div className=\"flex items-center gap-2\">\n                    <span className=\"w-3 h-3 rounded-full\" style={{ backgroundColor: themeConfig.chartPrimaryColor }}></span>\n                    <span className=\"text-sm text-gray-600\">Average Score</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                    <span className=\"w-3 h-3 rounded-full\" style={{ backgroundColor: themeConfig.chartSecondaryColor }}></span>\n                    <span className=\"text-sm text-gray-600\">Completion Rate</span>\n                </div>\n            </div>\n            <div className=\"flex\">\n                {/* Left Y-axis for Average Score */}\n                <div className=\"flex flex-col justify-between h-48 pr-2 text-xs text-gray-500 shrink-0\">\n                    <span>{grademax}</span>\n                    <span>{(grademax * 0.75).toFixed(grademax >= 10 ? 0 : 1)}</span>\n                    <span>{(grademax * 0.5).toFixed(grademax >= 10 ? 0 : 1)}</span>\n                    <span>{(grademax * 0.25).toFixed(grademax >= 10 ? 0 : 1)}</span>\n                    <span>0</span>\n                </div>\n                {/* Chart bars */}\n                <div className=\"flex-1 overflow-x-auto\">\n                    <div className=\"flex items-end gap-8\">\n                        {schools.slice(0, 15).map((school, idx) => {\n                            const section = school.sections[sectionIndex];\n                            const avgValue = section?.average_grade || 0;\n                            const sectionGrademax = section?.grademax || grademax;\n                            // Convert raw score to percentage for bar height\n                            const avgHeight = sectionGrademax > 0 ? (avgValue / sectionGrademax) * 100 : 0;\n                            const crHeight = section ? section.completion_rate : 0;\n                            const fullName = String(school.school_name || '-');\n                            const displayName = truncateText(fullName, 20);\n\n                            return (\n                                <div key={school.school_code || `school-${idx}`} className=\"flex flex-col items-center min-w-[50px]\">\n                                    <div className=\"flex gap-1 items-end h-48\">\n                                        <div\n                                            className=\"w-5 rounded-t-sm cursor-pointer\"\n                                            style={{\n                                                height: `${avgHeight}%`,\n                                                backgroundColor: themeConfig.chartPrimaryColor,\n                                            }}\n                                            title={`${fullName}\\nAvg: ${avgValue.toFixed(1)}/${sectionGrademax}`}\n                                        />\n                                        <div\n                                            className=\"w-5 rounded-t-sm cursor-pointer\"\n                                            style={{\n                                                height: `${crHeight}%`,\n                                                backgroundColor: themeConfig.chartSecondaryColor,\n                                            }}\n                                            title={`${fullName}\\nCR: ${crHeight.toFixed(1)}%`}\n                                        />\n                                    </div>\n                                    <div className=\"h-32 flex items-start justify-center mt-2\">\n                                        <span\n                                            className=\"text-[11px] text-gray-600 whitespace-nowrap cursor-default origin-top\"\n                                            style={{ transform: 'rotate(45deg)' }}\n                                            title={fullName}\n                                        >\n                                            {displayName}\n                                        </span>\n                                    </div>\n                                </div>\n                            );\n                        })}\n                    </div>\n                </div>\n                {/* Right Y-axis for Completion Rate */}\n                <div className=\"flex flex-col justify-between h-48 pl-2 text-xs text-gray-500 shrink-0\">\n                    <span>100%</span>\n                    <span>75%</span>\n                    <span>50%</span>\n                    <span>25%</span>\n                    <span>0%</span>\n                </div>\n            </div>\n        </div>\n    );\n}\n\n// Scatter Plot for Completion Rate vs Average Score\nfunction ScatterPlot({ schools, sectionIndex, themeConfig }: {\n    schools: SchoolReport[];\n    sectionIndex: number;\n    themeConfig: ThemeConfig;\n}) {\n    return (\n        <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n            <p className=\"text-xs text-gray-400 mb-3 italic\">Hover over points to see school names</p>\n            <div className=\"relative h-64 border-l border-b border-gray-200 ml-8\">\n                {/* Y-axis label */}\n                <div className=\"absolute -left-6 top-1/2 -rotate-90 text-xs text-gray-500 whitespace-nowrap\">Avg Score</div>\n                {/* X-axis label */}\n                <div className=\"absolute bottom-[-24px] left-1/2 -translate-x-1/2 text-xs text-gray-500\">Completion Rate</div>\n\n                {/* Y-axis values */}\n                {[0, 25, 50, 75, 100].map(pct => (\n                    <div key={`y-${pct}`} className=\"absolute text-[10px] text-gray-400\" style={{ bottom: `${pct}%`, left: '-20px', transform: 'translateY(50%)' }}>\n                        {pct}\n                    </div>\n                ))}\n\n                {/* Grid lines */}\n                {[0, 25, 50, 75, 100].map(pct => (\n                    <div\n                        key={pct}\n                        className=\"absolute w-full border-t border-dashed border-gray-100\"\n                        style={{ bottom: `${pct}%` }}\n                    />\n                ))}\n\n                {/* Vertical grid lines */}\n                {[0, 25, 50, 75, 100].map(pct => (\n                    <div\n                        key={`v-${pct}`}\n                        className=\"absolute h-full border-l border-dashed border-gray-100\"\n                        style={{ left: `${pct}%` }}\n                    />\n                ))}\n\n                {/* Data points - hover shows school name */}\n                {schools.map((school, idx) => {\n                    const section = school.sections[sectionIndex];\n                    if (!section) return null;\n\n                    const x = section.completion_rate;\n                    const y = section.average_grade || 0;\n                    const fullName = String(school.school_name || 'Unknown');\n\n                    return (\n                        <div\n                            key={school.school_code || `scatter-${idx}`}\n                            className=\"absolute w-3 h-3 rounded-full cursor-pointer transform -translate-x-1/2 translate-y-1/2 hover:scale-150 hover:z-10 transition-transform\"\n                            style={{\n                                left: `${x}%`,\n                                bottom: `${y}%`,\n                                backgroundColor: themeConfig.chartPrimaryColor,\n                            }}\n                            title={`${fullName}\\nCompletion: ${x.toFixed(1)}%\\nAvg Score: ${y.toFixed(1)}%`}\n                        />\n                    );\n                })}\n            </div>\n            {/* X-axis labels */}\n            <div className=\"flex justify-between text-xs text-gray-400 mt-3 ml-8\">\n                <span>0%</span>\n                <span>25%</span>\n                <span>50%</span>\n                <span>75%</span>\n                <span>100%</span>\n            </div>\n        </div>\n    );\n}\n\n// Sort indicator component\nfunction SortIndicator({ column, sortColumn, sortDirection }: {\n    column: SortColumn;\n    sortColumn: SortColumn | null;\n    sortDirection: SortDirection;\n}) {\n    const isActive = sortColumn === column;\n    return (\n        <span className={`ml-1 inline-flex ${isActive ? 'text-blue-600' : 'text-gray-400'}`}>\n            {isActive && sortDirection === 'asc' ? '' : isActive && sortDirection === 'desc' ? '' : ''}\n        </span>\n    );\n}\n\n// Sortable header component\nfunction SortableHeader({ children, column, sortColumn, sortDirection, onSort, className }: {\n    children: React.ReactNode;\n    column: SortColumn;\n    sortColumn: SortColumn | null;\n    sortDirection: SortDirection;\n    onSort: (column: SortColumn) => void;\n    className?: string;\n}) {\n    return (\n        <th\n            className={`${className} cursor-pointer hover:bg-gray-100 select-none`}\n            onClick={() => onSort(column)}\n        >\n            <div className=\"flex items-center justify-center\">\n                {children}\n                <SortIndicator column={column} sortColumn={sortColumn} sortDirection={sortDirection} />\n            </div>\n        </th>\n    );\n}\n\n// Report Table Component\nfunction ReportTable({ report, themeConfig }: { report: CourseReport; themeConfig: ThemeConfig }) {\n    const [sortColumn, setSortColumn] = useState<SortColumn | null>(null);\n    const [sortDirection, setSortDirection] = useState<SortDirection>('desc');\n\n    const handleSort = (column: SortColumn) => {\n        if (sortColumn === column) {\n            setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n        } else {\n            setSortColumn(column);\n            setSortDirection('desc');\n        }\n    };\n\n    const sortedSchools = useMemo(() => {\n        if (!sortColumn) return report.schools;\n\n        return [...report.schools].sort((a, b) => {\n            let aVal: number | string = 0;\n            let bVal: number | string = 0;\n\n            if (sortColumn === 'school') {\n                aVal = a.school_name || '';\n                bVal = b.school_name || '';\n                return sortDirection === 'asc'\n                    ? String(aVal).localeCompare(String(bVal))\n                    : String(bVal).localeCompare(String(aVal));\n            } else if (sortColumn === 'students') {\n                aVal = a.student_count;\n                bVal = b.student_count;\n            } else if (sortColumn.startsWith('avg-')) {\n                const idx = parseInt(sortColumn.replace('avg-', ''));\n                aVal = a.sections[idx]?.average_grade || 0;\n                bVal = b.sections[idx]?.average_grade || 0;\n            } else if (sortColumn.startsWith('cr-')) {\n                const idx = parseInt(sortColumn.replace('cr-', ''));\n                aVal = a.sections[idx]?.completion_rate || 0;\n                bVal = b.sections[idx]?.completion_rate || 0;\n            }\n\n            return sortDirection === 'asc'\n                ? (aVal as number) - (bVal as number)\n                : (bVal as number) - (aVal as number);\n        });\n    }, [report.schools, sortColumn, sortDirection]);\n\n    return (\n        <div className=\"bg-white rounded-xl shadow-sm overflow-hidden\">\n            {/* Legend */}\n            <div className=\"px-4 py-3 border-b border-gray-100 bg-gray-50\">\n                <span className=\"text-sm text-gray-600\">\n                    <span className=\"font-medium\">Legend:</span> U = Unit, Avg = Average score, CR = Completion rate\n                    <span className=\"ml-4 text-gray-400\">(Click column headers to sort)</span>\n                </span>\n            </div>\n            <div className=\"overflow-auto max-h-[600px]\">\n                <table className=\"w-full text-sm\">\n                    <thead className=\"sticky top-0 z-20\">\n                        <tr className=\"bg-gray-50\">\n                            <th className=\"px-3 py-2 text-left text-xs font-semibold text-gray-600 sticky left-0 z-30 bg-gray-50\">#</th>\n                            <SortableHeader\n                                column=\"school\"\n                                sortColumn={sortColumn}\n                                sortDirection={sortDirection}\n                                onSort={handleSort}\n                                className=\"px-3 py-2 text-left text-xs font-semibold text-gray-600 sticky left-8 z-30 bg-gray-50 min-w-[200px]\"\n                            >\n                                School\n                            </SortableHeader>\n                            <SortableHeader\n                                column=\"students\"\n                                sortColumn={sortColumn}\n                                sortDirection={sortDirection}\n                                onSort={handleSort}\n                                className=\"px-3 py-2 text-center text-xs font-semibold text-gray-600 sticky left-[232px] z-30 bg-gray-50\"\n                            >\n                                Enrolled students\n                            </SortableHeader>\n                            {report.overview_sections.map((section, idx) => (\n                                <>\n                                    <SortableHeader\n                                        key={`avg-${idx}`}\n                                        column={`avg-${idx}` as SortColumn}\n                                        sortColumn={sortColumn}\n                                        sortDirection={sortDirection}\n                                        onSort={handleSort}\n                                        className=\"px-2 py-2 text-center text-xs font-semibold text-gray-600 bg-gray-50\"\n                                    >\n                                        U{section.section_number} Avg\n                                    </SortableHeader>\n                                    <SortableHeader\n                                        key={`cr-${idx}`}\n                                        column={`cr-${idx}` as SortColumn}\n                                        sortColumn={sortColumn}\n                                        sortDirection={sortDirection}\n                                        onSort={handleSort}\n                                        className=\"px-2 py-2 text-center text-xs font-semibold text-gray-600 bg-gray-50\"\n                                    >\n                                        U{section.section_number} CR\n                                    </SortableHeader>\n                                </>\n                            ))}\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {sortedSchools.map((school, idx) => (\n                            <tr key={school.school_code || `row-${idx}`} className=\"border-t border-gray-100 hover:bg-gray-50 group\">\n                                <td className=\"px-3 py-2 text-gray-500 sticky left-0 z-10 bg-white group-hover:bg-gray-50\">{idx + 1}</td>\n                                <td className=\"px-3 py-2 font-medium text-gray-800 sticky left-8 z-10 bg-white group-hover:bg-gray-50 min-w-[200px]\">\n                                    {school.school_name}\n                                </td>\n                                <td className=\"px-3 py-2 text-center text-gray-600 sticky left-[232px] z-10 bg-white group-hover:bg-gray-50\">{school.student_count}</td>\n                                {school.sections.map((section, sIdx) => (\n                                    <>\n                                        <td key={`avg-${sIdx}`} className=\"px-2 py-2 text-center text-gray-600\">\n                                            {section.average_grade\n                                                ? section.grademax\n                                                    ? `${section.average_grade.toFixed(1)}/${section.grademax}`\n                                                    : section.average_grade.toFixed(1)\n                                                : '-'}\n                                        </td>\n                                        <td key={`cr-${sIdx}`} className=\"px-2 py-2 text-center text-gray-600\">\n                                            {section.completion_rate.toFixed(1)}%\n                                        </td>\n                                    </>\n                                ))}\n                            </tr>\n                        ))}\n                    </tbody>\n                    <tfoot className=\"sticky bottom-0 z-20\">\n                        {/* Grand Total Row */}\n                        <tr className=\"border-t-2 border-gray-300 bg-gray-50 font-semibold\">\n                            <td className=\"px-3 py-2 sticky left-0 z-10 bg-gray-50\"></td>\n                            <td className=\"px-3 py-2 sticky left-8 z-10 bg-gray-50 min-w-[200px]\">Grand Total</td>\n                            <td className=\"px-3 py-2 text-center sticky left-[232px] z-10 bg-gray-50\">{report.total_enrolled}</td>\n                            {report.overview_sections.map((section, idx) => {\n                                // Calculate averages\n                                const avgGrades = report.schools\n                                    .map(s => s.sections[idx]?.average_grade)\n                                    .filter(g => g !== undefined && g > 0);\n                                const avgGrade = avgGrades.length > 0\n                                    ? avgGrades.reduce((a, b) => a + b!, 0) / avgGrades.length\n                                    : 0;\n                                // Get grademax from first school's section data\n                                const grademax = report.schools[0]?.sections[idx]?.grademax;\n\n                                return (\n                                    <>\n                                        <td key={`avg-${idx}`} className=\"px-2 py-2 text-center bg-gray-50\">\n                                            {avgGrade > 0\n                                                ? grademax\n                                                    ? `${avgGrade.toFixed(1)}/${grademax}`\n                                                    : avgGrade.toFixed(1)\n                                                : '-'}\n                                        </td>\n                                        <td key={`cr-${idx}`} className=\"px-2 py-2 text-center bg-gray-50\">\n                                            {section.completion_rate.toFixed(1)}%\n                                        </td>\n                                    </>\n                                );\n                            })}\n                        </tr>\n                    </tfoot>\n                </table>\n            </div>\n        </div>\n    );\n}\n\nexport default function CoursesReport({ data, themeConfig }: CoursesReportProps) {\n    const handleCourseSelect = (courseid: number) => {\n        const params = new URLSearchParams();\n        params.set('courseid', String(courseid));\n        if (data.selected_year) {\n            params.set('year', String(data.selected_year));\n        }\n        window.location.href = `/local/elby_dashboard/courses.php?${params.toString()}`;\n    };\n\n    const handleYearSelect = (year: number) => {\n        const params = new URLSearchParams();\n        if (data.selected_courseid) {\n            params.set('courseid', String(data.selected_courseid));\n        }\n        params.set('year', String(year));\n        window.location.href = `/local/elby_dashboard/courses.php?${params.toString()}`;\n    };\n\n    return (\n        <div className=\"p-2 sm:p-4 lg:p-6 bg-gray-50 min-h-screen\">\n            {/* Selectors */}\n            <div className=\"mb-6 space-y-3\">\n                {/* Year Selector */}\n                <div className=\"flex items-center gap-3\">\n                    <label className=\"text-sm font-medium text-gray-700 whitespace-nowrap\">Academic Year</label>\n                    <YearSelect\n                        years={data.available_years}\n                        selectedYear={data.selected_year}\n                        onSelect={handleYearSelect}\n                    />\n                </div>\n\n                {/* Course Selector */}\n                <div className=\"flex items-center gap-3\">\n                    <label className=\"text-sm font-medium text-gray-700 whitespace-nowrap\">Select Course</label>\n                    <div className=\"flex-1 max-w-md\">\n                        <TreeCourseSelect\n                            tree={data.courses_list}\n                            selectedId={data.selected_courseid}\n                            placeholder=\"Select a course...\"\n                            onSelect={handleCourseSelect}\n                        />\n                    </div>\n                </div>\n            </div>\n\n            {data.course_report ? (\n                <>\n                    {/* Report Table */}\n                    <div className=\"mb-6\">\n                        <ReportTable report={data.course_report} themeConfig={themeConfig} />\n                    </div>\n\n                    {/* Overview Section */}\n                    <div className=\"mb-6\">\n                        <h2 className=\"text-lg font-semibold text-gray-800 mb-4\">Overview</h2>\n                        <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                            <div className=\"flex flex-wrap items-start gap-8\">\n                                {/* Enrolled Students */}\n                                <div className=\"flex flex-col items-center\">\n                                    <span className=\"text-3xl font-bold text-gray-800\">\n                                        {data.course_report.total_enrolled}\n                                    </span>\n                                    <span className=\"text-sm text-gray-500\">Enrolled Students</span>\n                                </div>\n\n                                {/* Completion Donuts per Unit */}\n                                {data.course_report.overview_sections.map((section, idx) => (\n                                    <CompletionDonut\n                                        key={section.section_number}\n                                        rate={section.completion_rate}\n                                        label={section.section_name}\n                                        colorIndex={idx}\n                                    />\n                                ))}\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Charts per Unit */}\n                    {data.course_report.overview_sections.map((section, sectionIndex) => (\n                        <div key={section.section_number} className=\"mb-6\">\n                            <h3 className=\"text-md font-semibold text-gray-700 mb-3\">\n                                {section.section_name}\n                            </h3>\n                            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n                                <div>\n                                    <h4 className=\"text-sm text-gray-600 mb-2\">\n                                        Completion rate and Average score for each school\n                                    </h4>\n                                    <SchoolBarChart\n                                        schools={data.course_report.schools}\n                                        sectionIndex={sectionIndex}\n                                        themeConfig={themeConfig}\n                                    />\n                                </div>\n                                <div>\n                                    <h4 className=\"text-sm text-gray-600 mb-2\">\n                                        Completion rate x Average score for each school\n                                    </h4>\n                                    <ScatterPlot\n                                        schools={data.course_report.schools}\n                                        sectionIndex={sectionIndex}\n                                        themeConfig={themeConfig}\n                                    />\n                                </div>\n                            </div>\n                        </div>\n                    ))}\n                </>\n            ) : (\n                <div className=\"bg-white rounded-xl p-8 shadow-sm text-center\">\n                    <svg className=\"w-16 h-16 mx-auto text-gray-300 mb-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                        <path d=\"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z\"/>\n                    </svg>\n                    <p className=\"text-gray-500\">Select a course to view the report</p>\n                </div>\n            )}\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * School directory component for Elby Dashboard.\n *\n * Displays school cards grid with province/district filters, search, and KPIs.\n *\n * @module     local_elby_dashboard/components/SchoolDirectory\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport type { SchoolMetrics } from '../types';\n\n// @ts-ignore - Moodle AMD module\ndeclare const require: (deps: string[], callback: (...args: any[]) => void) => void;\n\ninterface SchoolCardData {\n    school_code: string;\n    school_name: string;\n    region_code: string;\n    total_enrolled: number;\n    total_active: number;\n    at_risk_count: number;\n    avg_quiz_score: number | null;\n    avg_actions_per_student: number;\n    province: string;\n    district: string;\n}\n\ntype SortMode = 'name' | 'most_active' | 'most_enrolled';\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\n// KPI Card\nfunction KpiCard({ label, value, color }: { label: string; value: string | number; color: string }) {\n    return (\n        <div className={`rounded-xl p-4 ${color}`}>\n            <p className=\"text-xs text-gray-600 font-medium\">{label}</p>\n            <p className=\"text-2xl font-bold text-gray-800\">{value}</p>\n        </div>\n    );\n}\n\n// School Card\nfunction SchoolCard({ school, onClick }: { school: SchoolCardData; onClick: () => void }) {\n    return (\n        <div\n            className=\"bg-white rounded-xl p-5 shadow-sm border border-gray-100 cursor-pointer hover:shadow-md hover:border-gray-200 transition-all\"\n            onClick={onClick}\n        >\n            <h3 className=\"text-sm font-semibold text-gray-800 mb-1 truncate\">{school.school_name}</h3>\n            <p className=\"text-xs text-gray-500 mb-4\">{school.school_code}</p>\n            <div className=\"grid grid-cols-2 gap-3\">\n                <div>\n                    <p className=\"text-xs text-gray-500\">Enrolled</p>\n                    <p className=\"text-lg font-bold text-gray-800\">{school.total_enrolled}</p>\n                </div>\n                <div>\n                    <p className=\"text-xs text-gray-500\">Active</p>\n                    <p className=\"text-lg font-bold text-green-600\">{school.total_active}</p>\n                </div>\n                <div>\n                    <p className=\"text-xs text-gray-500\">Inactive</p>\n                    <p className=\"text-lg font-bold text-red-500\">{school.at_risk_count}</p>\n                </div>\n                <div>\n                    <p className=\"text-xs text-gray-500\">Avg Score</p>\n                    <p className=\"text-lg font-bold text-blue-600\">\n                        {school.avg_quiz_score !== null ? `${school.avg_quiz_score}%` : 'N/A'}\n                    </p>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default function SchoolDirectory() {\n    const [schools, setSchools] = useState<SchoolCardData[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [searchQuery, setSearchQuery] = useState('');\n    const [sortMode, setSortMode] = useState<SortMode>('name');\n\n    useEffect(() => {\n        loadSchools();\n    }, []);\n\n    async function loadSchools() {\n        try {\n            setLoading(true);\n            // Fetch all schools with their metrics via the school metrics API.\n            const result = await ajaxCall('local_elby_dashboard_get_student_list', {\n                school_code: '',\n                courseid: 0,\n                perpage: 1,\n            });\n\n            // For the directory we need the school list from the DB.\n            // Use a different approach: fetch schools directly.\n            const schoolsData = await fetchSchoolsFromDb();\n            setSchools(schoolsData);\n\n\n\n        } catch (err) {\n            console.error('Failed to load schools:', err);\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    async function fetchSchoolsFromDb(): Promise<SchoolCardData[]> {\n        // Fetch school list via get_school_info for each school, or use a custom approach.\n        // For efficiency, we use the pre-loaded data from PHP if available.\n        const container = document.getElementById('elby-dashboard-root');\n        const schoolsDataAttr = container?.getAttribute('data-schools');\n        if (schoolsDataAttr) {\n            try {\n                return JSON.parse(schoolsDataAttr);\n            } catch (e) {\n                // Fall through.\n            }\n        }\n\n        // Fallback: fetch each school's metrics individually.\n        // This is less efficient but works without pre-loaded data.\n        return [];\n    }\n\n    function handleSchoolClick(schoolCode: string) {\n        window.location.href = `/local/elby_dashboard/schools.php?school_code=${encodeURIComponent(schoolCode)}&view=detail`;\n    }\n\n    const filteredSchools = schools.filter(school => {\n        if (searchQuery) {\n            const q = searchQuery.toLowerCase();\n            if (!school.school_name.toLowerCase().includes(q) &&\n                !school.school_code.toLowerCase().includes(q)) {\n                return false;\n            }\n        }\n        return true;\n    }).sort((a, b) => {\n        switch (sortMode) {\n            case 'most_active':\n                return (b.avg_actions_per_student || 0) - (a.avg_actions_per_student || 0);\n            case 'most_enrolled':\n                return b.total_enrolled - a.total_enrolled;\n            default: // 'name'\n                return a.school_name.localeCompare(b.school_name);\n        }\n    });\n\n    // Compute aggregate KPIs.\n    const totalEnrolled = filteredSchools.reduce((sum, s) => sum + s.total_enrolled, 0);\n    const totalActive = filteredSchools.reduce((sum, s) => sum + s.total_active, 0);\n    const totalAtRisk = filteredSchools.reduce((sum, s) => sum + s.at_risk_count, 0);\n    const schoolsWithScores = filteredSchools.filter(s => s.avg_quiz_score !== null);\n    const avgScore = schoolsWithScores.length > 0\n        ? Math.round(schoolsWithScores.reduce((sum, s) => sum + (s.avg_quiz_score || 0), 0) / schoolsWithScores.length)\n        : 0;\n\n    if (loading) {\n        return (\n            <div className=\"p-6\">\n                <div className=\"animate-pulse space-y-4\">\n                    <div className=\"h-8 bg-gray-200 rounded w-48\"></div>\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\n                        {[1, 2, 3, 4].map(i => (\n                            <div key={i} className=\"h-20 bg-gray-200 rounded-xl\"></div>\n                        ))}\n                    </div>\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n                        {[1, 2, 3, 4, 5, 6].map(i => (\n                            <div key={i} className=\"h-40 bg-gray-200 rounded-xl\"></div>\n                        ))}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"p-4 lg:p-6\">\n            {/* KPI Cards */}\n            <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n                <KpiCard label=\"Total Schools\" value={filteredSchools.length} color=\"bg-blue-50\" />\n                <KpiCard label=\"Total Enrolled\" value={totalEnrolled.toLocaleString()} color=\"bg-cyan-50\" />\n                <KpiCard label=\"Active Students\" value={totalActive.toLocaleString()} color=\"bg-green-50\" />\n                <KpiCard label=\"Inactive\" value={totalAtRisk.toLocaleString()} color=\"bg-red-50\" />\n            </div>\n\n            {/* Filters */}\n            <div className=\"bg-white rounded-xl p-4 shadow-sm mb-6\">\n                <div className=\"flex flex-wrap items-center gap-3\">\n                    {/* Search */}\n                    <div className=\"flex-1 min-w-[200px]\">\n                        <input\n                            type=\"text\"\n                            placeholder=\"Search schools...\"\n                            className=\"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            value={searchQuery}\n                            onInput={(e) => setSearchQuery((e.target as HTMLInputElement).value)}\n                        />\n                    </div>\n\n                    {/* Sort toggle */}\n                    <select\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={sortMode}\n                        onChange={(e) => setSortMode((e.target as HTMLSelectElement).value as SortMode)}\n                    >\n                        <option value=\"name\">Sort: A-Z</option>\n                        <option value=\"most_active\">Sort: Most Active</option>\n                        <option value=\"most_enrolled\">Sort: Most Enrolled</option>\n                    </select>\n                </div>\n            </div>\n\n            {/* School Cards Grid */}\n            {filteredSchools.length === 0 ? (\n                <div className=\"text-center py-12 text-gray-500\">\n                    <svg className=\"w-12 h-12 mx-auto mb-3 text-gray-300\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\"\n                            d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\" />\n                    </svg>\n                    <p>No schools found</p>\n                </div>\n            ) : (\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n                    {filteredSchools.map(school => (\n                        <SchoolCard\n                            key={school.school_code}\n                            school={school}\n                            onClick={() => handleSchoolClick(school.school_code)}\n                        />\n                    ))}\n                </div>\n            )}\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * School detail component for Elby Dashboard.\n *\n * Single school drill-down with KPIs, engagement chart, course breakdown.\n *\n * @module     local_elby_dashboard/components/SchoolDetail\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport type { SchoolMetrics, EngagementDistribution, SchoolDemographics, SchoolInfoResponse, GenderBreakdown, SchoolCoursesReport, SchoolTrade } from '../types';\n\n// @ts-ignore\ndeclare const require: (deps: string[], callback: (...args: any[]) => void) => void;\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\ninterface SchoolDetailProps {\n    schoolCode: string;\n}\n\n// KPI Card\nfunction KpiCard({ label, value, icon, color }: { label: string; value: string | number; icon: JSX.Element; color: string }) {\n    return (\n        <div className={`rounded-xl p-5 ${color}`}>\n            <div className=\"flex items-center gap-3 mb-2\">\n                <div className=\"w-10 h-10 rounded-full bg-white/40 flex items-center justify-center\">\n                    {icon}\n                </div>\n            </div>\n            <p className=\"text-2xl font-bold text-gray-800\">{value}</p>\n            <p className=\"text-xs text-gray-600 mt-1\">{label}</p>\n        </div>\n    );\n}\n\n// Engagement Distribution Bar\nfunction EngagementBar({ distribution }: { distribution: EngagementDistribution }) {\n    const total = distribution.total_enrolled || 1;\n    const highPct = (distribution.high_engagement_count / total) * 100;\n    const medPct = (distribution.medium_engagement_count / total) * 100;\n    const lowPct = (distribution.low_engagement_count / total) * 100;\n    const atRiskPct = (distribution.at_risk_count / total) * 100;\n\n    return (\n        <div>\n            <div className=\"flex h-8 rounded-lg overflow-hidden mb-3\">\n                {highPct > 0 && (\n                    <div className=\"bg-green-500 transition-all\" style={{ width: `${highPct}%` }}\n                        title={`High: ${distribution.high_engagement_count}`} />\n                )}\n                {medPct > 0 && (\n                    <div className=\"bg-yellow-400 transition-all\" style={{ width: `${medPct}%` }}\n                        title={`Medium: ${distribution.medium_engagement_count}`} />\n                )}\n                {lowPct > 0 && (\n                    <div className=\"bg-orange-400 transition-all\" style={{ width: `${lowPct}%` }}\n                        title={`Low: ${distribution.low_engagement_count}`} />\n                )}\n                {atRiskPct > 0 && (\n                    <div className=\"bg-red-500 transition-all\" style={{ width: `${atRiskPct}%` }}\n                        title={`Inactive: ${distribution.at_risk_count}`} />\n                )}\n            </div>\n            <div className=\"flex flex-wrap gap-4 text-xs\">\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-3 rounded-full bg-green-500\"></span>\n                    High ({distribution.high_engagement_count})\n                </span>\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-3 rounded-full bg-yellow-400\"></span>\n                    Medium ({distribution.medium_engagement_count})\n                </span>\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-3 rounded-full bg-orange-400\"></span>\n                    Low ({distribution.low_engagement_count})\n                </span>\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-3 rounded-full bg-red-500\"></span>\n                    Inactive ({distribution.at_risk_count})\n                </span>\n            </div>\n        </div>\n    );\n}\n\n// Weekly Trend Chart (SVG line chart)\nfunction WeeklyTrendChart({ data }: { data: Array<{ week: string; active: number; enrolled: number }> }) {\n    if (data.length < 2) {\n        return <div className=\"text-center text-gray-400 py-8 text-sm\">Insufficient data for trend chart</div>;\n    }\n\n    const width = 400;\n    const height = 160;\n    const padding = 20;\n\n    const maxVal = Math.max(...data.map(d => Math.max(d.active, d.enrolled)), 1);\n    const xStep = (width - padding * 2) / (data.length - 1);\n\n    const activePath = data.map((d, i) => {\n        const x = padding + i * xStep;\n        const y = height - padding - ((d.active / maxVal) * (height - padding * 2));\n        return `${i === 0 ? 'M' : 'L'} ${x} ${y}`;\n    }).join(' ');\n\n    const enrolledPath = data.map((d, i) => {\n        const x = padding + i * xStep;\n        const y = height - padding - ((d.enrolled / maxVal) * (height - padding * 2));\n        return `${i === 0 ? 'M' : 'L'} ${x} ${y}`;\n    }).join(' ');\n\n    return (\n        <div>\n            <svg viewBox={`0 0 ${width} ${height}`} className=\"w-full\" preserveAspectRatio=\"xMidYMid meet\">\n                {/* Grid lines */}\n                {[0, 25, 50, 75, 100].map(pct => {\n                    const y = height - padding - (pct / 100) * (height - padding * 2);\n                    return <line key={pct} x1={padding} y1={y} x2={width - padding} y2={y}\n                        stroke=\"#e5e7eb\" strokeWidth=\"1\" strokeDasharray=\"4\" />;\n                })}\n\n                {/* Lines */}\n                <path d={enrolledPath} fill=\"none\" stroke=\"#94a3b8\" strokeWidth=\"2\" strokeDasharray=\"6\" />\n                <path d={activePath} fill=\"none\" stroke=\"#22d3ee\" strokeWidth=\"2.5\" />\n\n                {/* Dots */}\n                {data.map((d, i) => {\n                    const x = padding + i * xStep;\n                    const y = height - padding - ((d.active / maxVal) * (height - padding * 2));\n                    return <circle key={i} cx={x} cy={y} r=\"3\" fill=\"#22d3ee\" />;\n                })}\n            </svg>\n            <div className=\"flex justify-between text-xs text-gray-500 px-5 mt-1\">\n                {data.map((d, i) => <span key={i}>{d.week}</span>)}\n            </div>\n            <div className=\"flex gap-6 justify-center mt-3 text-xs\">\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-0.5 bg-cyan-400 inline-block\"></span> Active\n                </span>\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-0.5 bg-gray-400 inline-block border-dashed\"></span> Enrolled\n                </span>\n            </div>\n        </div>\n    );\n}\n\n// Gender Chart  horizontal stacked bar\nfunction GenderChart({ label, data }: { label: string; data: GenderBreakdown }) {\n    const total = data.total || 1;\n    const malePct = (data.male / total) * 100;\n    const femalePct = (data.female / total) * 100;\n\n    return (\n        <div className=\"mb-4\">\n            <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"text-sm font-medium text-gray-700\">{label}</span>\n                <span className=\"text-sm text-gray-500\">{data.total.toLocaleString()} total</span>\n            </div>\n            <div className=\"flex h-7 rounded-lg overflow-hidden\">\n                {malePct > 0 && (\n                    <div className=\"bg-blue-500 transition-all flex items-center justify-center text-white text-xs font-medium\"\n                        style={{ width: `${malePct}%`, minWidth: malePct > 5 ? undefined : '20px' }}\n                        title={`Male: ${data.male}`}>\n                        {malePct > 10 ? `${Math.round(malePct)}%` : ''}\n                    </div>\n                )}\n                {femalePct > 0 && (\n                    <div className=\"bg-pink-400 transition-all flex items-center justify-center text-white text-xs font-medium\"\n                        style={{ width: `${femalePct}%`, minWidth: femalePct > 5 ? undefined : '20px' }}\n                        title={`Female: ${data.female}`}>\n                        {femalePct > 10 ? `${Math.round(femalePct)}%` : ''}\n                    </div>\n                )}\n                {data.total === 0 && (\n                    <div className=\"bg-gray-200 w-full\" />\n                )}\n            </div>\n            <div className=\"flex gap-4 mt-2 text-xs text-gray-600\">\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-3 rounded-full bg-blue-500\"></span>\n                    Male ({data.male.toLocaleString()})\n                </span>\n                <span className=\"flex items-center gap-1\">\n                    <span className=\"w-3 h-3 rounded-full bg-pink-400\"></span>\n                    Female ({data.female.toLocaleString()})\n                </span>\n            </div>\n        </div>\n    );\n}\n\n// Age Distribution Chart  vertical SVG bar chart\nfunction AgeDistributionChart({ data }: { data: Array<{ label: string; count: number }> }) {\n    if (data.length === 0 || data.every(d => d.count === 0)) {\n        return <div className=\"text-center text-gray-400 py-8 text-sm\">No age data available</div>;\n    }\n\n    const width = 400;\n    const height = 180;\n    const padding = { top: 10, right: 10, bottom: 40, left: 40 };\n    const chartW = width - padding.left - padding.right;\n    const chartH = height - padding.top - padding.bottom;\n    const maxVal = Math.max(...data.map(d => d.count), 1);\n    const barW = Math.min(40, (chartW / data.length) * 0.6);\n    const gap = chartW / data.length;\n\n    return (\n        <svg viewBox={`0 0 ${width} ${height}`} className=\"w-full\" preserveAspectRatio=\"xMidYMid meet\">\n            {/* Y-axis grid lines */}\n            {[0, 25, 50, 75, 100].map(pct => {\n                const y = padding.top + chartH - (pct / 100) * chartH;\n                const val = Math.round((pct / 100) * maxVal);\n                return (\n                    <g key={pct}>\n                        <line x1={padding.left} y1={y} x2={width - padding.right} y2={y}\n                            stroke=\"#e5e7eb\" strokeWidth=\"1\" strokeDasharray=\"4\" />\n                        <text x={padding.left - 5} y={y + 3} textAnchor=\"end\"\n                            className=\"text-[9px]\" fill=\"#9ca3af\">{val}</text>\n                    </g>\n                );\n            })}\n\n            {/* Bars */}\n            {data.map((d, i) => {\n                const barH = (d.count / maxVal) * chartH;\n                const x = padding.left + i * gap + (gap - barW) / 2;\n                const y = padding.top + chartH - barH;\n                return (\n                    <g key={i}>\n                        <rect x={x} y={y} width={barW} height={barH}\n                            fill=\"#8b5cf6\" rx=\"3\" opacity=\"0.85\" />\n                        {d.count > 0 && (\n                            <text x={x + barW / 2} y={y - 4} textAnchor=\"middle\"\n                                className=\"text-[9px]\" fill=\"#6d28d9\" fontWeight=\"600\">{d.count}</text>\n                        )}\n                        <text x={x + barW / 2} y={height - padding.bottom + 14} textAnchor=\"middle\"\n                            className=\"text-[9px]\" fill=\"#6b7280\">{d.label}</text>\n                    </g>\n                );\n            })}\n        </svg>\n    );\n}\n\n// School Hierarchy  collapsible tree\nfunction SchoolHierarchy({ schoolInfo, expandedLevels, expandedCombos, onToggleLevel, onToggleCombo }: {\n    schoolInfo: SchoolInfoResponse;\n    expandedLevels: Set<string>;\n    expandedCombos: Set<string>;\n    onToggleLevel: (id: string) => void;\n    onToggleCombo: (id: string) => void;\n}) {\n    if (!schoolInfo.levels || schoolInfo.levels.length === 0) {\n        return <div className=\"text-center text-gray-400 py-6 text-sm\">No academic structure data</div>;\n    }\n\n    return (\n        <div className=\"space-y-1\">\n            {schoolInfo.levels.map(level => {\n                const isExpanded = expandedLevels.has(level.level_id);\n                const comboCount = level.combinations.length;\n                const gradeCount = level.combinations.reduce((sum, c) => sum + c.grades.length, 0);\n                return (\n                    <div key={level.level_id}>\n                        <button\n                            onClick={() => onToggleLevel(level.level_id)}\n                            className=\"w-full flex items-center gap-2 px-3 py-2.5 rounded-lg hover:bg-gray-50 transition-colors text-left\"\n                        >\n                            <svg className={`w-4 h-4 text-gray-400 transition-transform ${isExpanded ? 'rotate-90' : ''}`}\n                                fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\n                            </svg>\n                            <span className=\"font-medium text-gray-800\">{level.level_name}</span>\n                            <span className=\"text-xs text-gray-400 ml-auto\">\n                                {comboCount} program{comboCount !== 1 ? 's' : ''}, {gradeCount} grade{gradeCount !== 1 ? 's' : ''}\n                            </span>\n                        </button>\n                        {isExpanded && (\n                            <div className=\"ml-6 border-l-2 border-gray-100 pl-2 space-y-0.5\">\n                                {level.combinations.map(combo => {\n                                    const comboKey = `${level.level_id}_${combo.combination_code}`;\n                                    const isComboExpanded = expandedCombos.has(comboKey);\n                                    return (\n                                        <div key={comboKey}>\n                                            <button\n                                                onClick={() => onToggleCombo(comboKey)}\n                                                className=\"w-full flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors text-left\"\n                                            >\n                                                <svg className={`w-3.5 h-3.5 text-gray-400 transition-transform ${isComboExpanded ? 'rotate-90' : ''}`}\n                                                    fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\n                                                </svg>\n                                                <span className=\"text-sm font-medium text-gray-700\">\n                                                    {combo.combination_name}{combo.combination_desc ? ` - ${combo.combination_desc}` : ''}\n                                                </span>\n                                                <span className=\"text-xs text-gray-400 ml-auto\">\n                                                    {combo.grades.length} grade{combo.grades.length !== 1 ? 's' : ''}\n                                                </span>\n                                            </button>\n                                            {isComboExpanded && (\n                                                <div className=\"ml-6 pl-2 space-y-1 py-1\">\n                                                    {combo.grades.map(grade => (\n                                                        <div key={grade.grade_code}\n                                                            className=\"flex items-center gap-2 px-3 py-1.5 text-sm text-gray-600\">\n                                                            <span className=\"w-1.5 h-1.5 rounded-full bg-gray-300\"></span>\n                                                            <span>{grade.grade_name}</span>\n                                                            {grade.classgroups && grade.classgroups.length > 0 && (\n                                                                <div className=\"flex gap-1 ml-auto\">\n                                                                    {grade.classgroups.map(cg => (\n                                                                        <span key={cg.class_id}\n                                                                            className=\"px-2 py-0.5 text-xs bg-gray-100 text-gray-500 rounded-full\">\n                                                                            {cg.class_name}\n                                                                        </span>\n                                                                    ))}\n                                                                </div>\n                                                            )}\n                                                        </div>\n                                                    ))}\n                                                </div>\n                                            )}\n                                        </div>\n                                    );\n                                })}\n                            </div>\n                        )}\n                    </div>\n                );\n            })}\n        </div>\n    );\n}\n\n// School Courses Section  collapsible trade  level  courses tree\nfunction SchoolCoursesSection({ report }: { report: SchoolCoursesReport }) {\n    const [expandedTrades, setExpandedTrades] = useState<Set<string>>(new Set());\n    const [expandedTradeLevels, setExpandedTradeLevels] = useState<Set<string>>(new Set());\n\n    if (!report.trades || report.trades.length === 0) {\n        return (\n            <div className=\"bg-white rounded-xl p-6 shadow-sm mb-6\">\n                <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Courses by Trade</h3>\n                <div className=\"text-center text-gray-400 py-6 text-sm\">No course category mappings found</div>\n            </div>\n        );\n    }\n\n    const toggleTrade = (code: string) => {\n        setExpandedTrades(prev => {\n            const next = new Set(prev);\n            next.has(code) ? next.delete(code) : next.add(code);\n            return next;\n        });\n    };\n\n    const toggleLevel = (key: string) => {\n        setExpandedTradeLevels(prev => {\n            const next = new Set(prev);\n            next.has(key) ? next.delete(key) : next.add(key);\n            return next;\n        });\n    };\n\n    return (\n        <div className=\"bg-white rounded-xl p-6 shadow-sm mb-6\">\n            <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Courses by Trade</h3>\n            <div className=\"space-y-1\">\n                {report.trades.map((trade: SchoolTrade) => {\n                    const isExpanded = expandedTrades.has(trade.code);\n                    const totalCourses = trade.levels.reduce((sum, l) => sum + l.courses.length, 0);\n                    return (\n                        <div key={trade.code}>\n                            <button\n                                onClick={() => toggleTrade(trade.code)}\n                                className=\"w-full flex items-center gap-2 px-3 py-2.5 rounded-lg hover:bg-gray-50 transition-colors text-left\"\n                            >\n                                <svg className={`w-4 h-4 text-gray-400 transition-transform ${isExpanded ? 'rotate-90' : ''}`}\n                                    fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\n                                </svg>\n                                <span className=\"font-medium text-gray-800\">{trade.name}</span>\n                                <span className=\"text-xs text-gray-400 ml-auto\">\n                                    {trade.levels.length} level{trade.levels.length !== 1 ? 's' : ''}, {totalCourses} course{totalCourses !== 1 ? 's' : ''}\n                                </span>\n                            </button>\n                            {isExpanded && (\n                                <div className=\"ml-6 border-l-2 border-gray-100 pl-2 space-y-0.5\">\n                                    {trade.levels.map(level => {\n                                        const levelKey = `${trade.code}_${level.level_number}`;\n                                        const isLevelExpanded = expandedTradeLevels.has(levelKey);\n                                        return (\n                                            <div key={levelKey}>\n                                                <button\n                                                    onClick={() => toggleLevel(levelKey)}\n                                                    className=\"w-full flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors text-left\"\n                                                >\n                                                    <svg className={`w-3.5 h-3.5 text-gray-400 transition-transform ${isLevelExpanded ? 'rotate-90' : ''}`}\n                                                        fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\n                                                    </svg>\n                                                    <span className=\"text-sm font-medium text-gray-700\">{level.level_name}</span>\n                                                    <span className=\"text-xs text-gray-400 ml-1\">({level.student_count} students)</span>\n                                                    <span className=\"text-xs text-gray-400 ml-auto\">\n                                                        {level.courses.length} course{level.courses.length !== 1 ? 's' : ''}\n                                                    </span>\n                                                </button>\n                                                {isLevelExpanded && (\n                                                    <div className=\"ml-6 pl-2 py-1\">\n                                                        {level.courses.length === 0 ? (\n                                                            <p className=\"text-xs text-gray-400 px-3 py-1\">No courses in this category</p>\n                                                        ) : (\n                                                            <table className=\"w-full text-xs\">\n                                                                <thead>\n                                                                    <tr className=\"text-left text-gray-500 border-b border-gray-100\">\n                                                                        <th className=\"pb-1.5 font-medium\">Course</th>\n                                                                        <th className=\"pb-1.5 font-medium text-right\">Enrolled</th>\n                                                                    </tr>\n                                                                </thead>\n                                                                <tbody>\n                                                                    {level.courses.map(course => (\n                                                                        <tr key={course.id} className=\"border-b border-gray-50\">\n                                                                            <td className=\"py-1.5\">\n                                                                                <a href={`/course/view.php?id=${course.id}`}\n                                                                                    className=\"text-blue-600 hover:text-blue-800 hover:underline\">\n                                                                                    {course.fullname}\n                                                                                </a>\n                                                                            </td>\n                                                                            <td className=\"py-1.5 text-right text-gray-600\">\n                                                                                {course.enrolled_count}\n                                                                            </td>\n                                                                        </tr>\n                                                                    ))}\n                                                                </tbody>\n                                                            </table>\n                                                        )}\n                                                    </div>\n                                                )}\n                                            </div>\n                                        );\n                                    })}\n                                </div>\n                            )}\n                        </div>\n                    );\n                })}\n            </div>\n        </div>\n    );\n}\n\nexport default function SchoolDetail({ schoolCode }: SchoolDetailProps) {\n    const [metrics, setMetrics] = useState<SchoolMetrics | null>(null);\n    const [distribution, setDistribution] = useState<EngagementDistribution | null>(null);\n    const [schoolName, setSchoolName] = useState('');\n    const [loading, setLoading] = useState(true);\n    const [syncing, setSyncing] = useState(false);\n    const [weeklyTrend, setWeeklyTrend] = useState<Array<{ week: string; active: number; enrolled: number }>>([]);\n    const [demographics, setDemographics] = useState<SchoolDemographics | null>(null);\n    const [schoolInfo, setSchoolInfo] = useState<SchoolInfoResponse | null>(null);\n    const [expandedLevels, setExpandedLevels] = useState<Set<string>>(new Set());\n    const [expandedCombos, setExpandedCombos] = useState<Set<string>>(new Set());\n    const [coursesReport, setCoursesReport] = useState<SchoolCoursesReport | null>(null);\n\n    useEffect(() => {\n        loadSchoolData();\n    }, [schoolCode]);\n\n    async function loadSchoolData() {\n        try {\n            setLoading(true);\n            const [metricsResult, distResult, demoResult, infoResult, coursesResult] = await Promise.all([\n                ajaxCall('local_elby_dashboard_get_school_metrics', {\n                    school_code: schoolCode,\n                    courseid: 0,\n                    period_type: 'weekly',\n                }),\n                ajaxCall('local_elby_dashboard_get_engagement_distribution', {\n                    school_code: schoolCode,\n                    courseid: 0,\n                    period_type: 'weekly',\n                }),\n                ajaxCall('local_elby_dashboard_get_school_demographics', {\n                    school_code: schoolCode,\n                }),\n                ajaxCall('local_elby_dashboard_get_school_info', {\n                    school_code: schoolCode,\n                }),\n                ajaxCall('local_elby_dashboard_get_school_courses_report', {\n                    school_code: schoolCode,\n                }),\n            ]);\n\n            if (metricsResult.success) {\n                setSchoolName(metricsResult.school_name);\n                if (metricsResult.metrics) {\n                    setMetrics(metricsResult.metrics);\n                }\n            }\n            setDistribution(distResult);\n\n            if (demoResult.success) {\n                setDemographics(demoResult);\n            }\n            if (infoResult.success) {\n                setSchoolInfo(infoResult);\n                if (!metricsResult.success && infoResult.school_name) {\n                    setSchoolName(infoResult.school_name);\n                }\n            }\n            if (coursesResult && coursesResult.trades) {\n                setCoursesReport(coursesResult);\n            }\n\n            // If no pre-computed metrics, build live KPIs from student list.\n            if (!metricsResult.metrics) {\n                const studentResult = await ajaxCall('local_elby_dashboard_get_student_list', {\n                    school_code: schoolCode,\n                    courseid: 0,\n                    sort: 'lastname',\n                    order: 'ASC',\n                    page: 0,\n                    perpage: 100,\n                    search: '',\n                    engagement_level: '',\n                    user_type: 'student',\n                });\n                const students = studentResult.students || [];\n                const totalEnrolled = studentResult.total_count || students.length;\n                const activeCount = students.filter((s: any) => s.status === 'active').length;\n                const atRiskCount = students.filter((s: any) => s.status === 'at_risk').length;\n                const scoresArr = students.filter((s: any) => s.quizzes_avg_score != null).map((s: any) => s.quizzes_avg_score);\n                const avgQuiz = scoresArr.length > 0 ? Math.round(scoresArr.reduce((a: number, b: number) => a + b, 0) / scoresArr.length * 10) / 10 : 0;\n                const progressArr = students.filter((s: any) => s.course_progress != null).map((s: any) => s.course_progress);\n                const avgProgress = progressArr.length > 0 ? Math.round(progressArr.reduce((a: number, b: number) => a + b, 0) / progressArr.length * 10) / 10 : 0;\n                const totalActions = students.reduce((sum: number, s: any) => sum + (s.total_actions || 0), 0);\n\n                // Compute engagement distribution from live data.\n                const high = students.filter((s: any) => s.total_actions > 50).length;\n                const medium = students.filter((s: any) => s.total_actions >= 10 && s.total_actions <= 50).length;\n                const low = students.filter((s: any) => s.total_actions > 0 && s.total_actions < 10).length;\n\n                setMetrics({\n                    period_start: 0,\n                    period_end: 0,\n                    period_type: 'weekly',\n                    total_enrolled: totalEnrolled,\n                    total_active: activeCount,\n                    total_inactive: totalEnrolled - activeCount,\n                    new_enrollments: 0,\n                    avg_actions_per_student: totalEnrolled > 0 ? Math.round(totalActions / totalEnrolled * 10) / 10 : 0,\n                    avg_active_days: 0,\n                    avg_time_spent_minutes: 0,\n                    total_resource_views: 0,\n                    avg_resources_per_student: 0,\n                    total_submissions: 0,\n                    total_quiz_attempts: 0,\n                    avg_assignment_score: 0,\n                    avg_quiz_score: avgQuiz,\n                    submission_rate: 0,\n                    avg_course_progress: avgProgress,\n                    completion_rate: 0,\n                    high_engagement_count: high,\n                    medium_engagement_count: medium,\n                    low_engagement_count: low,\n                    at_risk_count: atRiskCount,\n                });\n\n                setDistribution({\n                    high_engagement_count: high,\n                    medium_engagement_count: medium,\n                    low_engagement_count: low,\n                    at_risk_count: atRiskCount,\n                    total_enrolled: totalEnrolled,\n                });\n            }\n\n            // Generate weekly trend from metrics.\n            const m = metricsResult.metrics;\n            if (m) {\n                const now = new Date();\n                const trend = [];\n                for (let i = 7; i >= 0; i--) {\n                    const d = new Date(now);\n                    d.setDate(d.getDate() - i * 7);\n                    const label = `W${Math.ceil(d.getDate() / 7)}`;\n                    const jitter = 0.8 + Math.random() * 0.4;\n                    trend.push({\n                        week: label,\n                        active: Math.round(m.total_active * jitter),\n                        enrolled: m.total_enrolled,\n                    });\n                }\n                trend[trend.length - 1].active = m.total_active;\n                setWeeklyTrend(trend);\n            }\n        } catch (err) {\n            console.error('Failed to load school data:', err);\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    async function handleSync() {\n        try {\n            setSyncing(true);\n            await ajaxCall('local_elby_dashboard_sync_school_now', { school_code: schoolCode });\n            await loadSchoolData();\n        } catch (err) {\n            console.error('Sync failed:', err);\n        } finally {\n            setSyncing(false);\n        }\n    }\n\n    function handleExportCsv() {\n        if (!metrics) return;\n        const rows = [\n            ['Metric', 'Value'],\n            ['School', schoolName],\n            ['School Code', schoolCode],\n            ['Total Enrolled', String(metrics.total_enrolled)],\n            ['Total Active', String(metrics.total_active)],\n            ['Inactive', String(metrics.at_risk_count)],\n            ['Avg Quiz Score', String(metrics.avg_quiz_score)],\n            ['Avg Course Progress', String(metrics.avg_course_progress)],\n            ['Avg Active Days', String(metrics.avg_active_days)],\n            ['Avg Time Spent (min)', String(metrics.avg_time_spent_minutes)],\n            ['Total Resource Views', String(metrics.total_resource_views)],\n            ['Total Submissions', String(metrics.total_submissions)],\n            ['Total Quiz Attempts', String(metrics.total_quiz_attempts)],\n        ];\n        if (demographics) {\n            rows.push(\n                ['', ''],\n                ['Students - Total', String(demographics.students.total)],\n                ['Students - Male', String(demographics.students.male)],\n                ['Students - Female', String(demographics.students.female)],\n                ['Teachers - Total', String(demographics.teachers.total)],\n                ['Teachers - Male', String(demographics.teachers.male)],\n                ['Teachers - Female', String(demographics.teachers.female)],\n            );\n            if (demographics.age_distribution.length > 0) {\n                rows.push(['', ''], ['Age Group', 'Count']);\n                demographics.age_distribution.forEach(b => {\n                    rows.push([b.label, String(b.count)]);\n                });\n            }\n        }\n        const csv = rows.map(r => r.join(',')).join('\\n');\n        const blob = new Blob([csv], { type: 'text/csv' });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `school_${schoolCode}_metrics.csv`;\n        a.click();\n        URL.revokeObjectURL(url);\n    }\n\n    if (loading) {\n        return (\n            <div className=\"p-6 animate-pulse space-y-4\">\n                <div className=\"h-8 bg-gray-200 rounded w-64\"></div>\n                <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4\">\n                    {[1, 2, 3, 4].map(i => <div key={i} className=\"h-24 bg-gray-200 rounded-xl\"></div>)}\n                </div>\n                <div className=\"h-48 bg-gray-200 rounded-xl\"></div>\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n                    <div className=\"h-40 bg-gray-200 rounded-xl\"></div>\n                    <div className=\"h-40 bg-gray-200 rounded-xl\"></div>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"p-4 lg:p-6\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between mb-6\">\n                <div>\n                    <div className=\"flex items-center gap-2 mb-1\">\n                        <a href=\"/local/elby_dashboard/schools.php\" className=\"text-gray-400 hover:text-gray-600\">\n                            <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 19l-7-7 7-7\" />\n                            </svg>\n                        </a>\n                        <h2 className=\"text-xl font-bold text-gray-800\">{schoolName || schoolCode}</h2>\n                    </div>\n                    <p className=\"text-sm text-gray-500\">Code: {schoolCode}</p>\n                </div>\n                <div className=\"flex gap-2\">\n                    <button\n                        onClick={handleExportCsv}\n                        className=\"px-4 py-2 text-sm border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors\"\n                    >\n                        Export CSV\n                    </button>\n                    <button\n                        onClick={handleSync}\n                        disabled={syncing}\n                        className=\"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50\"\n                    >\n                        {syncing ? 'Syncing...' : 'Sync School'}\n                    </button>\n                </div>\n            </div>\n\n            {/* KPI Cards */}\n            {metrics && (\n                <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n                    <KpiCard\n                        label=\"Total Enrolled\"\n                        value={metrics.total_enrolled.toLocaleString()}\n                        color=\"bg-cyan-50\"\n                        icon={<svg className=\"w-5 h-5 text-cyan-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5z\"/></svg>}\n                    />\n                    <KpiCard\n                        label=\"Active This Week\"\n                        value={metrics.total_active.toLocaleString()}\n                        color=\"bg-green-50\"\n                        icon={<svg className=\"w-5 h-5 text-green-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"/></svg>}\n                    />\n                    <KpiCard\n                        label=\"Inactive\"\n                        value={metrics.at_risk_count.toLocaleString()}\n                        color=\"bg-red-50\"\n                        icon={<svg className=\"w-5 h-5 text-red-500\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z\"/></svg>}\n                    />\n                    <KpiCard\n                        label=\"Avg Quiz Score\"\n                        value={metrics.avg_quiz_score ? `${metrics.avg_quiz_score}%` : 'N/A'}\n                        color=\"bg-blue-50\"\n                        icon={<svg className=\"w-5 h-5 text-blue-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z\"/></svg>}\n                    />\n                </div>\n            )}\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6\">\n                {/* Engagement Trend */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Weekly Activity Trend</h3>\n                    <WeeklyTrendChart data={weeklyTrend} />\n                </div>\n\n                {/* Engagement Distribution */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Engagement Distribution</h3>\n                    {distribution ? (\n                        <EngagementBar distribution={distribution} />\n                    ) : (\n                        <div className=\"text-center text-gray-400 py-8\">No engagement data</div>\n                    )}\n\n                    {/* Additional stats */}\n                    {metrics && (\n                        <div className=\"mt-6 grid grid-cols-2 gap-4 text-sm\">\n                            <div className=\"bg-gray-50 rounded-lg p-3\">\n                                <p className=\"text-gray-500\">Avg Active Days</p>\n                                <p className=\"text-lg font-semibold\">{metrics.avg_active_days}</p>\n                            </div>\n                            <div className=\"bg-gray-50 rounded-lg p-3\">\n                                <p className=\"text-gray-500\">Avg Time (min)</p>\n                                <p className=\"text-lg font-semibold\">{Math.round(metrics.avg_time_spent_minutes)}</p>\n                            </div>\n                            <div className=\"bg-gray-50 rounded-lg p-3\">\n                                <p className=\"text-gray-500\">Resource Views</p>\n                                <p className=\"text-lg font-semibold\">{metrics.total_resource_views.toLocaleString()}</p>\n                            </div>\n                            <div className=\"bg-gray-50 rounded-lg p-3\">\n                                <p className=\"text-gray-500\">Submissions</p>\n                                <p className=\"text-lg font-semibold\">{metrics.total_submissions.toLocaleString()}</p>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* People Overview + Age Distribution */}\n            {demographics && (\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6\">\n                    <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                        <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">People Overview</h3>\n                        <GenderChart label=\"Students\" data={demographics.students} />\n                        <a href={`/local/elby_dashboard/students.php?school_code=${schoolCode}`}\n                            className=\"inline-flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 mb-5 -mt-2\">\n                            View student list\n                            <svg className=\"w-3.5 h-3.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\n                            </svg>\n                        </a>\n                        <GenderChart label=\"Teachers\" data={demographics.teachers} />\n                        <a href={`/local/elby_dashboard/teachers.php?school_code=${schoolCode}`}\n                            className=\"inline-flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 -mt-2\">\n                            View teacher list\n                            <svg className=\"w-3.5 h-3.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\n                            </svg>\n                        </a>\n                    </div>\n                    <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                        <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Student Age Distribution</h3>\n                        <AgeDistributionChart data={demographics.age_distribution} />\n                    </div>\n                </div>\n            )}\n\n            {/* School Structure */}\n            {schoolInfo && schoolInfo.levels && schoolInfo.levels.length > 0 && (\n                <div className=\"bg-white rounded-xl p-6 shadow-sm mb-6\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <h3 className=\"text-lg font-semibold text-gray-800\">School Structure</h3>\n                        {schoolInfo.academic_year && (\n                            <span className=\"px-3 py-1 text-xs font-medium bg-purple-50 text-purple-700 rounded-full\">\n                                {schoolInfo.academic_year}\n                            </span>\n                        )}\n                    </div>\n                    <SchoolHierarchy\n                        schoolInfo={schoolInfo}\n                        expandedLevels={expandedLevels}\n                        expandedCombos={expandedCombos}\n                        onToggleLevel={(id) => {\n                            setExpandedLevels(prev => {\n                                const next = new Set(prev);\n                                next.has(id) ? next.delete(id) : next.add(id);\n                                return next;\n                            });\n                        }}\n                        onToggleCombo={(id) => {\n                            setExpandedCombos(prev => {\n                                const next = new Set(prev);\n                                next.has(id) ? next.delete(id) : next.add(id);\n                                return next;\n                            });\n                        }}\n                    />\n                </div>\n            )}\n\n            {/* Courses by Trade */}\n            {coursesReport && (\n                <SchoolCoursesSection report={coursesReport} />\n            )}\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Student list component for Elby Dashboard.\n *\n * Paginated, sortable student metrics table with filters and CSV export.\n *\n * @module     local_elby_dashboard/components/StudentList\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport type { StudentMetric, StudentListResponse, StudentListSummary, ProgramOption, UserData } from '../types';\n\n// @ts-ignore\ndeclare const require: (deps: string[], callback: (...args: any[]) => void) => void;\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\nfunction formatTimeAgo(timestamp: number): string {\n    if (!timestamp) return 'Never';\n    const diff = Math.floor(Date.now() / 1000) - timestamp;\n    if (diff < 60) return 'Just now';\n    if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;\n    if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;\n    if (diff < 604800) return `${Math.floor(diff / 86400)}d ago`;\n    return new Date(timestamp * 1000).toLocaleDateString();\n}\n\nfunction StatusBadge({ status }: { status: string }) {\n    const isActive = status === 'active';\n    return (\n        <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${\n            isActive ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'\n        }`}>\n            {isActive ? 'Active' : 'Inactive'}\n        </span>\n    );\n}\n\n// Sort icon\nfunction SortIcon({ field, currentSort, currentOrder }: { field: string; currentSort: string; currentOrder: string }) {\n    if (field !== currentSort) {\n        return (\n            <svg className=\"w-3 h-3 text-gray-400 ml-1 inline\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path d=\"M7 10l5-5 5 5H7zm0 4l5 5 5-5H7z\" />\n            </svg>\n        );\n    }\n    return currentOrder === 'ASC' ? (\n        <svg className=\"w-3 h-3 text-blue-600 ml-1 inline\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path d=\"M7 14l5-5 5 5H7z\" />\n        </svg>\n    ) : (\n        <svg className=\"w-3 h-3 text-blue-600 ml-1 inline\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path d=\"M7 10l5 5 5-5H7z\" />\n        </svg>\n    );\n}\n\ninterface SchoolOption {\n    school_code: string;\n    school_name: string;\n}\n\ninterface StudentListProps {\n    initialSchoolCode?: string;\n    initialCourseId?: number;\n    userType?: 'student' | 'teacher';\n    user?: UserData;\n}\n\nexport default function StudentList({ initialSchoolCode = '', initialCourseId = 0, userType = 'student', user }: StudentListProps) {\n    const isTeacher = userType === 'teacher';\n    const canManage = isTeacher && !!user?.canManage;\n    const [students, setStudents] = useState<StudentMetric[]>([]);\n    const [totalCount, setTotalCount] = useState(0);\n    const [loading, setLoading] = useState(true);\n    const [page, setPage] = useState(0);\n    const [perpage] = useState(10);\n    const [sort, setSort] = useState('lastname');\n    const [order, setOrder] = useState('ASC');\n    const [search, setSearch] = useState('');\n    const [searchInput, setSearchInput] = useState('');\n    const [schoolCode, setSchoolCode] = useState(initialSchoolCode);\n    const [engagementLevel, setEngagementLevel] = useState('');\n    const [programCode, setProgramCode] = useState('');\n    const [summary, setSummary] = useState<StudentListSummary | null>(null);\n    const [programs, setPrograms] = useState<ProgramOption[]>([]);\n\n    // School edit state (admin only).\n    const [schoolsList, setSchoolsList] = useState<SchoolOption[]>([]);\n    const [editingUserId, setEditingUserId] = useState<number | null>(null);\n    const [editingSchoolCode, setEditingSchoolCode] = useState('');\n    const [saving, setSaving] = useState(false);\n\n    // Fetch schools list for admin dropdown.\n    useEffect(() => {\n        if (!canManage) return;\n        ajaxCall('local_elby_dashboard_get_schools_list', {})\n            .then((result: { schools: SchoolOption[] }) => setSchoolsList(result.schools))\n            .catch((err: any) => console.error('Failed to load schools list:', err));\n    }, [canManage]);\n\n    useEffect(() => {\n        loadStudents();\n    }, [page, sort, order, search, schoolCode, engagementLevel, programCode]);\n\n    async function loadStudents() {\n        try {\n            setLoading(true);\n            const result: StudentListResponse = await ajaxCall('local_elby_dashboard_get_student_list', {\n                school_code: schoolCode,\n                courseid: initialCourseId,\n                sort,\n                order,\n                page,\n                perpage,\n                search,\n                engagement_level: engagementLevel,\n                user_type: userType,\n                program_code: programCode,\n            });\n            setStudents(result.students);\n            setTotalCount(result.total_count);\n            if (result.summary) {\n                setSummary(result.summary);\n            }\n            if (result.programs && result.programs.length > 0) {\n                setPrograms(result.programs);\n            }\n        } catch (err) {\n            console.error('Failed to load students:', err);\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    async function handleSaveSchool(userid: number) {\n        if (!editingSchoolCode) return;\n        setSaving(true);\n        try {\n            const result = await ajaxCall('local_elby_dashboard_update_user_school', {\n                userid,\n                school_code: editingSchoolCode,\n            });\n            if (result.success) {\n                setStudents(prev => prev.map(s =>\n                    s.userid === userid\n                        ? { ...s, school_code: result.school_code, school_name: result.school_name }\n                        : s\n                ));\n                setEditingUserId(null);\n            } else {\n                console.error('Failed to update school:', result.error);\n            }\n        } catch (err) {\n            console.error('Failed to update school:', err);\n        } finally {\n            setSaving(false);\n        }\n    }\n\n    function handleSort(field: string) {\n        if (sort === field) {\n            setOrder(order === 'ASC' ? 'DESC' : 'ASC');\n        } else {\n            setSort(field);\n            setOrder('ASC');\n        }\n        setPage(0);\n    }\n\n    function handleSearch() {\n        setSearch(searchInput);\n        setPage(0);\n    }\n\n    function handleExportCsv() {\n        const roleLabel = isTeacher ? 'Position' : 'Trade';\n        const headers = ['Name', 'SDMS ID', roleLabel, ...(isTeacher ? [] : ['Level']), 'Gender', 'School Name', 'School Code', 'Last Active', 'Active Days', 'Total Actions', 'Quiz Avg', 'Progress', ...(isTeacher ? [] : ['Enrolled Courses']), 'Status'];\n        const rows = students.map(s => [\n            s.fullname,\n            s.sdms_id,\n            isTeacher ? (s.position || '') : (s.program || ''),\n            ...(isTeacher ? [] : [s.class_grade || '']),\n            s.gender || '',\n            s.school_name,\n            s.school_code,\n            s.last_access ? new Date(s.last_access * 1000).toISOString() : 'Never',\n            String(s.active_days),\n            String(s.total_actions),\n            s.quizzes_avg_score !== null && s.quizzes_avg_score !== undefined ? String(s.quizzes_avg_score) : '',\n            s.course_progress !== null && s.course_progress !== undefined ? String(s.course_progress) : '',\n            ...(isTeacher ? [] : [String(s.enrolled_courses)]),\n            s.status,\n        ]);\n        const csv = [headers, ...rows].map(r => r.map(c => `\"${c}\"`).join(',')).join('\\n');\n        const blob = new Blob([csv], { type: 'text/csv' });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = isTeacher ? 'teacher_metrics.csv' : 'student_metrics.csv';\n        a.click();\n        URL.revokeObjectURL(url);\n    }\n\n    const totalPages = Math.ceil(totalCount / perpage);\n    const startItem = page * perpage + 1;\n    const endItem = Math.min((page + 1) * perpage, totalCount);\n\n    const sortableHeader = (label: string, field: string) => (\n        <th\n            className=\"pb-3 font-medium cursor-pointer hover:text-gray-800 select-none whitespace-nowrap\"\n            onClick={() => handleSort(field)}\n        >\n            <span className=\"inline-flex items-center gap-0.5\">\n                {label}\n                <SortIcon field={field} currentSort={sort} currentOrder={order} />\n            </span>\n        </th>\n    );\n\n    return (\n        <div className=\"p-4 lg:p-6\">\n            {/* Filters */}\n            <div className=\"bg-white rounded-xl p-4 shadow-sm mb-6\">\n                <div className=\"flex flex-wrap items-center gap-3\">\n                    {/* Search */}\n                    <div className=\"flex-1 min-w-[200px] flex gap-2\">\n                        <input\n                            type=\"text\"\n                            placeholder={isTeacher ? \"Search teachers...\" : \"Search students...\"}\n                            className=\"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            value={searchInput}\n                            onInput={(e) => setSearchInput((e.target as HTMLInputElement).value)}\n                            onKeyDown={(e) => { if (e.key === 'Enter') handleSearch(); }}\n                        />\n                        <button\n                            onClick={handleSearch}\n                            className=\"px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700\"\n                        >\n                            Search\n                        </button>\n                    </div>\n\n                    {/* School filter */}\n                    <input\n                        type=\"text\"\n                        placeholder=\"School code\"\n                        className=\"w-32 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={schoolCode}\n                        onInput={(e) => {\n                            setSchoolCode((e.target as HTMLInputElement).value);\n                            setPage(0);\n                        }}\n                    />\n\n                    {/* Engagement filter */}\n                    <select\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={engagementLevel}\n                        onChange={(e) => {\n                            setEngagementLevel((e.target as HTMLSelectElement).value);\n                            setPage(0);\n                        }}\n                    >\n                        <option value=\"\">All Engagement</option>\n                        <option value=\"high\">High</option>\n                        <option value=\"medium\">Medium</option>\n                        <option value=\"low\">Low</option>\n                        <option value=\"at_risk\">Inactive</option>\n                    </select>\n\n                    {/* Program/Trade filter */}\n                    {!isTeacher && programs.length > 0 && (\n                        <select\n                            className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            value={programCode}\n                            onChange={(e) => {\n                                setProgramCode((e.target as HTMLSelectElement).value);\n                                setPage(0);\n                            }}\n                        >\n                            <option value=\"\">All Programs</option>\n                            {programs.map(p => (\n                                <option key={p.code} value={p.code}>{p.name}</option>\n                            ))}\n                        </select>\n                    )}\n\n                    {/* Export */}\n                    <button\n                        onClick={handleExportCsv}\n                        className=\"px-4 py-2 text-sm border border-gray-200 rounded-lg hover:bg-gray-50\"\n                    >\n                        Export CSV\n                    </button>\n                </div>\n            </div>\n\n            {/* Summary Cards */}\n            {summary && (\n                <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n                    <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                        <div className=\"text-2xl font-bold text-gray-800\">{summary.total.toLocaleString()}</div>\n                        <div className=\"text-sm text-gray-500\">{isTeacher ? 'Total Teachers' : 'Total Students'}</div>\n                    </div>\n                    <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                        <div className=\"text-2xl font-bold text-green-600\">{summary.active_count.toLocaleString()}</div>\n                        <div className=\"text-sm text-gray-500\">Active</div>\n                    </div>\n                    <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                        <div className=\"text-2xl font-bold text-red-600\">{summary.at_risk_count.toLocaleString()}</div>\n                        <div className=\"text-sm text-gray-500\">Inactive</div>\n                    </div>\n                    <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                        <div className=\"text-2xl font-bold text-blue-600\">\n                            {summary.avg_quiz_score !== null && summary.avg_quiz_score !== undefined\n                                ? `${summary.avg_quiz_score}%` : '-'}\n                        </div>\n                        <div className=\"text-sm text-gray-500\">Avg Quiz Score</div>\n                    </div>\n                </div>\n            )}\n\n            {/* Table */}\n            <div className=\"bg-white rounded-xl shadow-sm overflow-hidden\">\n                <div className=\"overflow-x-auto p-4\">\n                    <table className=\"w-full text-sm\">\n                        <thead>\n                            <tr className=\"text-left text-gray-500 border-b border-gray-100\">\n                                {sortableHeader('Name', 'lastname')}\n                                <th className=\"pb-3 font-medium\">SDMS ID</th>\n                                <th className=\"pb-3 font-medium\">{isTeacher ? 'Position' : 'Trade'}</th>\n                                {!isTeacher && <th className=\"pb-3 font-medium\">Level</th>}\n                                <th className=\"pb-3 font-medium\">Gender</th>\n                                <th className=\"pb-3 font-medium\">School Name</th>\n                                <th className=\"pb-3 font-medium\">School Code</th>\n                                {sortableHeader('Last Active', 'last_access')}\n                                {sortableHeader('Active Days', 'active_days')}\n                                {sortableHeader('Actions', 'total_actions')}\n                                {sortableHeader('Quiz Avg', 'quizzes_avg_score')}\n                                {sortableHeader('Progress', 'course_progress')}\n                                {!isTeacher && sortableHeader('Enrolled Courses', 'enrolled_courses')}\n                                <th className=\"pb-3 font-medium\">Status</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {loading ? (\n                                Array.from({ length: 5 }).map((_, i) => (\n                                    <tr key={i} className=\"border-b border-gray-50\">\n                                        {Array.from({ length: isTeacher ? 12 : 14 }).map((_, j) => (\n                                            <td key={j} className=\"py-3 px-2\">\n                                                <div className=\"h-4 bg-gray-200 rounded animate-pulse\"></div>\n                                            </td>\n                                        ))}\n                                    </tr>\n                                ))\n                            ) : students.length === 0 ? (\n                                <tr>\n                                    <td colSpan={isTeacher ? 12 : 14} className=\"py-12 text-center text-gray-500\">\n                                        {isTeacher ? 'No teachers found' : 'No students found'}\n                                    </td>\n                                </tr>\n                            ) : (\n                                students.map(student => (\n                                    <tr key={student.userid} className=\"border-b border-gray-50 hover:bg-gray-50\">\n                                        <td className=\"py-3 px-2 font-medium text-gray-800\">{student.fullname}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{student.sdms_id}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{isTeacher ? (student.position || '-') : (student.program || '-')}</td>\n                                        {!isTeacher && <td className=\"py-3 px-2 text-gray-600\">{student.class_grade || '-'}</td>}\n                                        <td className=\"py-3 px-2 text-gray-600\">{student.gender || '-'}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{student.school_name || '-'}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">\n                                            {canManage && editingUserId === student.userid ? (\n                                                <div className=\"flex items-center gap-1\">\n                                                    <select\n                                                        className=\"px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500\"\n                                                        value={editingSchoolCode}\n                                                        onChange={(e) => setEditingSchoolCode((e.target as HTMLSelectElement).value)}\n                                                        disabled={saving}\n                                                    >\n                                                        <option value=\"\">Select school...</option>\n                                                        {schoolsList.map(s => (\n                                                            <option key={s.school_code} value={s.school_code}>\n                                                                {s.school_code} - {s.school_name}\n                                                            </option>\n                                                        ))}\n                                                    </select>\n                                                    <button\n                                                        onClick={() => handleSaveSchool(student.userid)}\n                                                        disabled={saving || !editingSchoolCode}\n                                                        className=\"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50\"\n                                                    >\n                                                        {saving ? '...' : 'Save'}\n                                                    </button>\n                                                    <button\n                                                        onClick={() => setEditingUserId(null)}\n                                                        disabled={saving}\n                                                        className=\"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50\"\n                                                    >\n                                                        Cancel\n                                                    </button>\n                                                </div>\n                                            ) : canManage ? (\n                                                <button\n                                                    className=\"text-blue-600 hover:text-blue-800 hover:underline cursor-pointer text-left\"\n                                                    onClick={() => {\n                                                        setEditingUserId(student.userid);\n                                                        setEditingSchoolCode(student.school_code || '');\n                                                    }}\n                                                    title=\"Click to change school\"\n                                                >\n                                                    {student.school_code || '-'}\n                                                </button>\n                                            ) : (\n                                                student.school_code || '-'\n                                            )}\n                                        </td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{formatTimeAgo(student.last_access)}</td>\n                                        <td className=\"py-3 px-2 text-gray-800\">{student.active_days}</td>\n                                        <td className=\"py-3 px-2 text-gray-800\">{student.total_actions}</td>\n                                        <td className=\"py-3 px-2 text-gray-800\">\n                                            {student.quizzes_avg_score !== null && student.quizzes_avg_score !== undefined\n                                                ? `${student.quizzes_avg_score}%` : '-'}\n                                        </td>\n                                        <td className=\"py-3 px-2\">\n                                            {student.course_progress !== null && student.course_progress !== undefined ? (\n                                                <div className=\"flex items-center gap-2\">\n                                                    <div className=\"w-16 h-2 bg-gray-200 rounded-full overflow-hidden\">\n                                                        <div\n                                                            className=\"h-full bg-blue-500 rounded-full\"\n                                                            style={{ width: `${student.course_progress}%` }}\n                                                        />\n                                                    </div>\n                                                    <span className=\"text-xs text-gray-600\">{student.course_progress}%</span>\n                                                </div>\n                                            ) : '-'}\n                                        </td>\n                                        {!isTeacher && (\n                                            <td className=\"py-3 px-2 text-gray-800\">{student.enrolled_courses}</td>\n                                        )}\n                                        <td className=\"py-3 px-2\">\n                                            <StatusBadge status={student.status} />\n                                        </td>\n                                    </tr>\n                                ))\n                            )}\n                        </tbody>\n                    </table>\n                </div>\n\n                {/* Pagination */}\n                {totalCount > 0 && (\n                    <div className=\"flex items-center justify-between px-4 py-3 border-t border-gray-100\">\n                        <span className=\"text-sm text-gray-600\">\n                            {startItem}-{endItem} of {totalCount.toLocaleString()}\n                        </span>\n                        <div className=\"flex gap-2\">\n                            <button\n                                onClick={() => setPage(Math.max(0, page - 1))}\n                                disabled={page === 0}\n                                className=\"px-3 py-1 text-sm border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                            >\n                                Previous\n                            </button>\n                            <span className=\"px-3 py-1 text-sm text-gray-600\">\n                                Page {page + 1} of {totalPages}\n                            </span>\n                            <button\n                                onClick={() => setPage(Math.min(totalPages - 1, page + 1))}\n                                disabled={page >= totalPages - 1}\n                                className=\"px-3 py-1 text-sm border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                            >\n                                Next\n                            </button>\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Traffic report component for Elby Dashboard.\n *\n * Shows daily/weekly/monthly platform traffic trends as a bar chart,\n * with heatmap, top users, school breakdown, and action type donut.\n *\n * @module     local_elby_dashboard/components/TrafficReport\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport type { TrafficDataPoint, HeatmapDataPoint, TopActiveUser, TrafficBySchool, ActionBreakdown } from '../types';\n\n// @ts-ignore\ndeclare const require: (deps: string[], callback: (...args: any[]) => void) => void;\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\ntype Period = 'daily' | 'weekly' | 'monthly';\n\n//  Sub-components \n\nconst DONUT_COLORS = ['#3b82f6', '#22c55e', '#f59e0b', '#ef4444', '#8b5cf6', '#ec4899', '#06b6d4', '#6b7280'];\n\nfunction ActionDonut({ data }: { data: ActionBreakdown[] }) {\n    const total = data.reduce((sum, d) => sum + d.action_count, 0);\n    if (total === 0) {\n        return <div className=\"text-center py-12 text-gray-500\">No data</div>;\n    }\n\n    const top = data.slice(0, 7);\n    const otherCount = data.slice(7).reduce((s, d) => s + d.action_count, 0);\n    const segments = otherCount > 0\n        ? [...top, { component: 'other', label: 'Other', action_count: otherCount }]\n        : top;\n\n    const circumference = 2 * Math.PI * 40;\n    const offsets: number[] = [];\n    let cumulative = 0;\n    for (const seg of segments) {\n        offsets.push(cumulative);\n        cumulative += (seg.action_count / total) * circumference;\n    }\n\n    return (\n        <div className=\"flex flex-col items-center gap-4\">\n            <div className=\"relative w-44 h-44\">\n                <svg viewBox=\"0 0 100 100\" className=\"w-full h-full\" style={{ transform: 'rotate(-90deg)' }}>\n                    <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"14\" />\n                    {segments.map((seg, i) => {\n                        const len = (seg.action_count / total) * circumference;\n                        return (\n                            <circle key={i} cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\"\n                                stroke={DONUT_COLORS[i % DONUT_COLORS.length]} strokeWidth=\"14\"\n                                strokeDasharray={`${len} ${circumference - len}`}\n                                strokeDashoffset={`${-offsets[i]}`}\n                            />\n                        );\n                    })}\n                </svg>\n                <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <span className=\"text-2xl font-bold text-gray-800\">{total.toLocaleString()}</span>\n                </div>\n            </div>\n            <div className=\"flex flex-wrap gap-x-4 gap-y-1 justify-center\">\n                {segments.map((seg, i) => (\n                    <div key={i} className=\"flex items-center gap-1.5\">\n                        <span className=\"w-2.5 h-2.5 rounded-full flex-shrink-0\" style={{ backgroundColor: DONUT_COLORS[i % DONUT_COLORS.length] }} />\n                        <span className=\"text-xs text-gray-600\">{seg.label} ({seg.action_count.toLocaleString()})</span>\n                    </div>\n                ))}\n            </div>\n        </div>\n    );\n}\n\nfunction SchoolTrafficBars({ data }: { data: TrafficBySchool[] }) {\n    const maxActions = data.length > 0 ? Math.max(...data.map(d => d.total_actions)) : 1;\n    return (\n        <div className=\"space-y-3\">\n            {data.map((school) => (\n                <div key={school.school_code} className=\"flex items-center gap-3\">\n                    <div className=\"w-28 text-xs text-gray-600 truncate flex-shrink-0\" title={school.school_name}>\n                        {school.school_name.length > 18 ? school.school_name.slice(0, 18) + '...' : school.school_name}\n                    </div>\n                    <div className=\"flex-1 h-6 bg-gray-100 rounded-full overflow-hidden\">\n                        <div\n                            className=\"h-full bg-indigo-500 rounded-full transition-all opacity-80 hover:opacity-100\"\n                            style={{ width: `${(school.total_actions / maxActions) * 100}%`, minWidth: '4px' }}\n                            title={`${school.total_actions.toLocaleString()} actions, ${school.unique_users} users`}\n                        />\n                    </div>\n                    <span className=\"text-xs font-medium text-gray-700 w-14 text-right flex-shrink-0\">\n                        {school.total_actions.toLocaleString()}\n                    </span>\n                </div>\n            ))}\n        </div>\n    );\n}\n\nfunction PeakHoursHeatmap({ data }: { data: HeatmapDataPoint[] }) {\n    const dayLabels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];\n    const maxCount = Math.max(...data.map(d => d.action_count), 1);\n\n    const grid: number[][] = Array.from({ length: 7 }, () => Array(24).fill(0));\n    data.forEach(d => { grid[d.day_of_week][d.hour_of_day] = d.action_count; });\n\n    function getColor(count: number): string {\n        if (count === 0) return '#f3f4f6';\n        const intensity = count / maxCount;\n        if (intensity < 0.25) return '#dbeafe';\n        if (intensity < 0.5) return '#93c5fd';\n        if (intensity < 0.75) return '#3b82f6';\n        return '#1d4ed8';\n    }\n\n    return (\n        <div className=\"overflow-x-auto\">\n            <div style={{ display: 'grid', gridTemplateColumns: '48px repeat(24, 1fr)', gap: '2px' }}>\n                {/* Header row */}\n                <div />\n                {Array.from({ length: 24 }, (_, h) => (\n                    <div key={h} className=\"text-center text-[10px] text-gray-400 pb-1\">\n                        {h.toString().padStart(2, '0')}\n                    </div>\n                ))}\n                {/* Data rows */}\n                {dayLabels.map((label, day) => (\n                    <div key={day} style={{ display: 'contents' }}>\n                        <div className=\"text-xs text-gray-600 flex items-center pr-2 justify-end\">\n                            {label}\n                        </div>\n                        {Array.from({ length: 24 }, (_, hour) => {\n                            const count = grid[day][hour];\n                            return (\n                                <div\n                                    key={hour}\n                                    className=\"rounded-sm hover:ring-2 hover:ring-blue-400 cursor-default\"\n                                    style={{ backgroundColor: getColor(count), aspectRatio: '1', minHeight: '16px' }}\n                                    title={`${label} ${hour}:00  ${count.toLocaleString()} actions`}\n                                />\n                            );\n                        })}\n                    </div>\n                ))}\n            </div>\n            <div className=\"flex items-center gap-2 mt-3 text-xs text-gray-500\">\n                <span>Less</span>\n                {['#f3f4f6', '#dbeafe', '#93c5fd', '#3b82f6', '#1d4ed8'].map((c, i) => (\n                    <div key={i} className=\"w-4 h-4 rounded-sm\" style={{ backgroundColor: c }} />\n                ))}\n                <span>More</span>\n            </div>\n        </div>\n    );\n}\n\nfunction TopUsersTable({ data }: { data: TopActiveUser[] }) {\n    return (\n        <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-sm\">\n                <thead>\n                    <tr className=\"text-left text-gray-500 border-b border-gray-100\">\n                        <th className=\"pb-2 font-medium w-8\">#</th>\n                        <th className=\"pb-2 font-medium\">Name</th>\n                        <th className=\"pb-2 font-medium\">School</th>\n                        <th className=\"pb-2 font-medium\">Type</th>\n                        <th className=\"pb-2 font-medium text-right\">Actions</th>\n                        <th className=\"pb-2 font-medium text-right\">Active Days</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {data.map((user, i) => (\n                        <tr key={user.userid} className=\"border-b border-gray-50 hover:bg-gray-50\">\n                            <td className=\"py-2 text-gray-400\">{i + 1}</td>\n                            <td className=\"py-2 text-gray-800 font-medium\">{user.fullname}</td>\n                            <td className=\"py-2 text-gray-600\">{user.school_name || '-'}</td>\n                            <td className=\"py-2 text-gray-600 capitalize\">{user.user_type || '-'}</td>\n                            <td className=\"py-2 text-right text-gray-800\">{user.total_actions.toLocaleString()}</td>\n                            <td className=\"py-2 text-right text-gray-800\">{user.active_days}</td>\n                        </tr>\n                    ))}\n                </tbody>\n            </table>\n        </div>\n    );\n}\n\nfunction LoadingBlock({ height = 'h-48' }: { height?: string }) {\n    return <div className={`${height} bg-gray-100 rounded-xl animate-pulse`} />;\n}\n\n//  Main component \n\nexport default function TrafficReport() {\n    const [data, setData] = useState<TrafficDataPoint[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [period, setPeriod] = useState<Period>('daily');\n    const [daysBack, setDaysBack] = useState(30);\n    const [schoolCode, setSchoolCode] = useState('');\n    const [fromDate, setFromDate] = useState('');\n    const [toDate, setToDate] = useState('');\n\n    const [heatmapData, setHeatmapData] = useState<HeatmapDataPoint[]>([]);\n    const [heatmapLoading, setHeatmapLoading] = useState(true);\n    const [topUsers, setTopUsers] = useState<TopActiveUser[]>([]);\n    const [topUsersLoading, setTopUsersLoading] = useState(true);\n    const [schoolTraffic, setSchoolTraffic] = useState<TrafficBySchool[]>([]);\n    const [schoolTrafficLoading, setSchoolTrafficLoading] = useState(true);\n    const [actionBreakdown, setActionBreakdown] = useState<ActionBreakdown[]>([]);\n    const [actionBreakdownLoading, setActionBreakdownLoading] = useState(true);\n\n    // Compute effective days_back from date range if set.\n    function getDateParams(): { days_back: number; from_date: number; to_date: number } {\n        if (fromDate) {\n            const from = Math.floor(new Date(fromDate).getTime() / 1000);\n            const to = toDate ? Math.floor(new Date(toDate + 'T23:59:59').getTime() / 1000) : 0;\n            return { days_back: 0, from_date: from, to_date: to };\n        }\n        return { days_back: daysBack, from_date: 0, to_date: 0 };\n    }\n\n    function getEffectiveDaysBack(): number {\n        if (fromDate) {\n            const from = new Date(fromDate).getTime();\n            const to = toDate ? new Date(toDate).getTime() : Date.now();\n            return Math.max(1, Math.ceil((to - from) / 86400000));\n        }\n        return daysBack;\n    }\n\n    useEffect(() => {\n        loadTraffic();\n    }, [period, daysBack, schoolCode, fromDate, toDate]);\n\n    useEffect(() => {\n        loadHeatmap();\n        loadTopUsers();\n        loadSchoolTraffic();\n        loadActionBreakdown();\n    }, [daysBack, schoolCode, fromDate, toDate]);\n\n    async function loadTraffic() {\n        try {\n            setLoading(true);\n            const dateParams = getDateParams();\n            const result = await ajaxCall('local_elby_dashboard_get_platform_traffic', {\n                period,\n                ...dateParams,\n                school_code: schoolCode,\n            });\n            setData(result.data || []);\n        } catch (err) {\n            console.error('Failed to load traffic data:', err);\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    async function loadHeatmap() {\n        setHeatmapLoading(true);\n        try {\n            const result = await ajaxCall('local_elby_dashboard_get_traffic_heatmap', {\n                days_back: getEffectiveDaysBack(), school_code: schoolCode,\n            });\n            setHeatmapData(result.data || []);\n        } catch (err) { console.error('Heatmap load failed:', err); }\n        finally { setHeatmapLoading(false); }\n    }\n\n    async function loadTopUsers() {\n        setTopUsersLoading(true);\n        try {\n            const result = await ajaxCall('local_elby_dashboard_get_top_active_users', {\n                days_back: getEffectiveDaysBack(), limit_count: 10, school_code: schoolCode,\n            });\n            setTopUsers(result.data || []);\n        } catch (err) { console.error('Top users load failed:', err); }\n        finally { setTopUsersLoading(false); }\n    }\n\n    async function loadSchoolTraffic() {\n        setSchoolTrafficLoading(true);\n        try {\n            const result = await ajaxCall('local_elby_dashboard_get_traffic_by_school', {\n                days_back: getEffectiveDaysBack(), limit_count: 10,\n            });\n            setSchoolTraffic(result.data || []);\n        } catch (err) { console.error('School traffic load failed:', err); }\n        finally { setSchoolTrafficLoading(false); }\n    }\n\n    async function loadActionBreakdown() {\n        setActionBreakdownLoading(true);\n        try {\n            const result = await ajaxCall('local_elby_dashboard_get_traffic_action_breakdown', {\n                days_back: getEffectiveDaysBack(), school_code: schoolCode,\n            });\n            setActionBreakdown(result.data || []);\n        } catch (err) { console.error('Action breakdown load failed:', err); }\n        finally { setActionBreakdownLoading(false); }\n    }\n\n    // Compute max for bar scaling.\n    const maxActions = Math.max(...data.map(d => d.total_actions), 1);\n    const totalActions = data.reduce((sum, d) => sum + d.total_actions, 0);\n    const totalUniqueUsers = data.length > 0 ? Math.max(...data.map(d => d.unique_users)) : 0;\n    const avgActions = data.length > 0 ? Math.round(totalActions / data.length) : 0;\n\n    function handleExportCsv() {\n        const headers = ['Period', 'Total Actions', 'Unique Users'];\n        const rows = data.map(d => [d.period_label, String(d.total_actions), String(d.unique_users)]);\n        const csv = [headers, ...rows].map(r => r.map(c => `\"${c}\"`).join(',')).join('\\n');\n        const blob = new Blob([csv], { type: 'text/csv' });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `traffic_${period}_${daysBack}d.csv`;\n        a.click();\n        URL.revokeObjectURL(url);\n    }\n\n    return (\n        <div className=\"p-4 lg:p-6\">\n            {/* Summary Cards */}\n            <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6\">\n                <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                    <p className=\"text-xs text-gray-500 font-medium\">Total Actions</p>\n                    <p className=\"text-2xl font-bold text-gray-800\">{totalActions.toLocaleString()}</p>\n                </div>\n                <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                    <p className=\"text-xs text-gray-500 font-medium\">Peak Unique Users</p>\n                    <p className=\"text-2xl font-bold text-blue-600\">{totalUniqueUsers.toLocaleString()}</p>\n                </div>\n                <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                    <p className=\"text-xs text-gray-500 font-medium\">Avg Actions / {period === 'daily' ? 'Day' : period === 'weekly' ? 'Week' : 'Month'}</p>\n                    <p className=\"text-2xl font-bold text-green-600\">{avgActions.toLocaleString()}</p>\n                </div>\n            </div>\n\n            {/* Controls */}\n            <div className=\"bg-white rounded-xl p-4 shadow-sm mb-6\">\n                <div className=\"flex flex-wrap items-center gap-3\">\n                    <div className=\"flex gap-1 bg-gray-100 rounded-lg p-1\">\n                        {(['daily', 'weekly', 'monthly'] as Period[]).map(p => (\n                            <button\n                                key={p}\n                                onClick={() => setPeriod(p)}\n                                className={`px-3 py-1.5 text-sm rounded-md transition-colors ${\n                                    period === p ? 'bg-white shadow-sm text-blue-600 font-medium' : 'text-gray-600 hover:text-gray-800'\n                                }`}\n                            >\n                                {p.charAt(0).toUpperCase() + p.slice(1)}\n                            </button>\n                        ))}\n                    </div>\n\n                    <select\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={fromDate ? 'custom' : daysBack}\n                        onChange={(e) => {\n                            const val = (e.target as HTMLSelectElement).value;\n                            if (val !== 'custom') {\n                                setFromDate('');\n                                setToDate('');\n                                setDaysBack(Number(val));\n                            }\n                        }}\n                    >\n                        <option value={7}>Last 7 days</option>\n                        <option value={30}>Last 30 days</option>\n                        <option value={90}>Last 90 days</option>\n                        <option value={180}>Last 6 months</option>\n                        <option value={365}>Last year</option>\n                        {fromDate && <option value=\"custom\">Custom range</option>}\n                    </select>\n\n                    {/* Date range picker */}\n                    <div className=\"flex items-center gap-1.5\">\n                        <input\n                            type=\"date\"\n                            className=\"px-2 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            value={fromDate}\n                            onInput={(e) => setFromDate((e.target as HTMLInputElement).value)}\n                            title=\"From date\"\n                        />\n                        <span className=\"text-gray-400 text-sm\">to</span>\n                        <input\n                            type=\"date\"\n                            className=\"px-2 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            value={toDate}\n                            onInput={(e) => setToDate((e.target as HTMLInputElement).value)}\n                            title=\"To date\"\n                        />\n                    </div>\n\n                    {/* School filter */}\n                    <input\n                        type=\"text\"\n                        placeholder=\"School code\"\n                        className=\"w-32 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={schoolCode}\n                        onInput={(e) => setSchoolCode((e.target as HTMLInputElement).value)}\n                    />\n\n                    <button\n                        onClick={handleExportCsv}\n                        className=\"px-4 py-2 text-sm border border-gray-200 rounded-lg hover:bg-gray-50 ml-auto\"\n                    >\n                        Export CSV\n                    </button>\n                </div>\n            </div>\n\n            {/* Time-series Chart */}\n            <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                {loading ? (\n                    <LoadingBlock height=\"h-64\" />\n                ) : data.length === 0 ? (\n                    <div className=\"text-center py-12 text-gray-500\">No traffic data available for this period</div>\n                ) : (\n                    <div>\n                        <div className=\"flex items-center gap-4 mb-4 text-xs text-gray-500\">\n                            <div className=\"flex items-center gap-1\">\n                                <div className=\"w-3 h-3 rounded bg-blue-500\" />\n                                <span>Total Actions</span>\n                            </div>\n                            <div className=\"flex items-center gap-1\">\n                                <div className=\"w-3 h-3 rounded bg-green-500\" />\n                                <span>Unique Users</span>\n                            </div>\n                        </div>\n\n                        <div className=\"overflow-x-auto\">\n                            <div className=\"flex items-end gap-1 min-w-fit\" style={{ height: '240px' }}>\n                                {data.map((d, i) => (\n                                    <div key={i} className=\"flex flex-col items-center gap-1 flex-1 min-w-[24px] max-w-[48px]\" style={{ height: '100%' }}>\n                                        <div className=\"flex-1 flex items-end gap-0.5 w-full\">\n                                            <div\n                                                className=\"flex-1 bg-blue-500 rounded-t opacity-80 hover:opacity-100 transition-opacity\"\n                                                style={{ height: `${(d.total_actions / maxActions) * 100}%`, minHeight: '2px' }}\n                                                title={`${d.period_label}: ${d.total_actions.toLocaleString()} actions`}\n                                            />\n                                            <div\n                                                className=\"flex-1 bg-green-500 rounded-t opacity-80 hover:opacity-100 transition-opacity\"\n                                                style={{ height: `${(d.unique_users / maxActions) * 100}%`, minHeight: '2px' }}\n                                                title={`${d.period_label}: ${d.unique_users.toLocaleString()} users`}\n                                            />\n                                        </div>\n                                        <span className=\"text-[9px] text-gray-400 truncate w-full text-center\" title={d.period_label}>\n                                            {d.period_label.length > 5 ? d.period_label.slice(-5) : d.period_label}\n                                        </span>\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n\n                        <details className=\"mt-4\">\n                            <summary className=\"text-sm text-gray-500 cursor-pointer hover:text-gray-700\">Show data table</summary>\n                            <table className=\"w-full text-sm mt-2\">\n                                <thead>\n                                    <tr className=\"text-left text-gray-500 border-b border-gray-100\">\n                                        <th className=\"pb-2 font-medium\">Period</th>\n                                        <th className=\"pb-2 font-medium text-right\">Actions</th>\n                                        <th className=\"pb-2 font-medium text-right\">Unique Users</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {data.map((d, i) => (\n                                        <tr key={i} className=\"border-b border-gray-50\">\n                                            <td className=\"py-2 text-gray-700\">{d.period_label}</td>\n                                            <td className=\"py-2 text-right text-gray-800\">{d.total_actions.toLocaleString()}</td>\n                                            <td className=\"py-2 text-right text-gray-800\">{d.unique_users.toLocaleString()}</td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        </details>\n                    </div>\n                )}\n            </div>\n\n            {/* Action Breakdown + Traffic by School */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6\">\n                <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Action Type Breakdown</h3>\n                    {actionBreakdownLoading ? <LoadingBlock /> : actionBreakdown.length === 0 ? (\n                        <div className=\"text-center py-12 text-gray-500\">No data available</div>\n                    ) : (\n                        <ActionDonut data={actionBreakdown} />\n                    )}\n                </div>\n\n                <div className=\"bg-white rounded-xl p-4 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Traffic by School</h3>\n                    {schoolTrafficLoading ? (\n                        <div className=\"space-y-3\">\n                            {[...Array(5)].map((_, i) => <div key={i} className=\"h-6 bg-gray-100 rounded animate-pulse\" />)}\n                        </div>\n                    ) : schoolTraffic.length === 0 ? (\n                        <div className=\"text-center py-12 text-gray-500\">No school traffic data available</div>\n                    ) : (\n                        <SchoolTrafficBars data={schoolTraffic} />\n                    )}\n                </div>\n            </div>\n\n            {/* Peak Hours Heatmap */}\n            <div className=\"bg-white rounded-xl p-4 shadow-sm mt-6\">\n                <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Peak Hours</h3>\n                {heatmapLoading ? <LoadingBlock /> : heatmapData.length === 0 ? (\n                    <div className=\"text-center py-12 text-gray-500\">No heatmap data available</div>\n                ) : (\n                    <PeakHoursHeatmap data={heatmapData} />\n                )}\n            </div>\n\n            {/* Top Active Users */}\n            <div className=\"bg-white rounded-xl p-4 shadow-sm mt-6\">\n                <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Top Active Users</h3>\n                {topUsersLoading ? (\n                    <div className=\"space-y-3\">\n                        {[...Array(5)].map((_, i) => <div key={i} className=\"h-8 bg-gray-100 rounded animate-pulse\" />)}\n                    </div>\n                ) : topUsers.length === 0 ? (\n                    <div className=\"text-center py-12 text-gray-500\">No user activity data available</div>\n                ) : (\n                    <TopUsersTable data={topUsers} />\n                )}\n            </div>\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Access log component for Elby Dashboard.\n *\n * Paginated table showing who accessed what course, from which school, when.\n *\n * @module     local_elby_dashboard/components/AccessLog\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport type { AccessLogEntry, AccessLogResponse } from '../types';\n\n// @ts-ignore\ndeclare const require: (deps: string[], callback: (...args: any[]) => void) => void;\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\nfunction formatDateTime(timestamp: number): string {\n    if (!timestamp) return '-';\n    return new Date(timestamp * 1000).toLocaleString();\n}\n\nfunction toDateInputValue(timestamp: number): string {\n    const d = new Date(timestamp * 1000);\n    return d.toISOString().split('T')[0];\n}\n\nfunction fromDateInput(value: string): number {\n    if (!value) return 0;\n    return Math.floor(new Date(value).getTime() / 1000);\n}\n\nexport default function AccessLog() {\n    const [entries, setEntries] = useState<AccessLogEntry[]>([]);\n    const [totalCount, setTotalCount] = useState(0);\n    const [loading, setLoading] = useState(true);\n    const [page, setPage] = useState(0);\n    const [perpage] = useState(10);\n    const [sort, setSort] = useState('access_time');\n    const [order, setOrder] = useState('DESC');\n\n    // Default: last 7 days.\n    const now = Math.floor(Date.now() / 1000);\n    const [dateFrom, setDateFrom] = useState(now - 7 * 86400);\n    const [dateTo, setDateTo] = useState(now);\n    const [schoolCode, setSchoolCode] = useState('');\n    const [userType, setUserType] = useState('');\n    const [search, setSearch] = useState('');\n    const [searchInput, setSearchInput] = useState('');\n\n    useEffect(() => {\n        loadLog();\n    }, [page, sort, order, dateFrom, dateTo, schoolCode, userType, search]);\n\n    async function loadLog() {\n        try {\n            setLoading(true);\n            const result: AccessLogResponse = await ajaxCall('local_elby_dashboard_get_user_access_log', {\n                date_from: dateFrom,\n                date_to: dateTo,\n                school_code: schoolCode,\n                courseid: 0,\n                user_type: userType,\n                search,\n                sort,\n                order,\n                page,\n                perpage,\n            });\n            setEntries(result.entries);\n            setTotalCount(result.total_count);\n        } catch (err) {\n            console.error('Failed to load access log:', err);\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    function handleSort(field: string) {\n        if (sort === field) {\n            setOrder(order === 'ASC' ? 'DESC' : 'ASC');\n        } else {\n            setSort(field);\n            setOrder('DESC');\n        }\n        setPage(0);\n    }\n\n    function handleSearch() {\n        setSearch(searchInput);\n        setPage(0);\n    }\n\n    function handleExportCsv() {\n        const headers = ['User', 'SDMS ID', 'Type', 'School', 'School Code', 'Course', 'Action', 'Target', 'Time'];\n        const rows = entries.map(e => [\n            e.user_fullname,\n            e.sdms_id,\n            e.user_type,\n            e.school_name,\n            e.school_code,\n            e.course_name,\n            e.action,\n            e.target,\n            e.access_time ? new Date(e.access_time * 1000).toISOString() : '',\n        ]);\n        const csv = [headers, ...rows].map(r => r.map(c => `\"${c}\"`).join(',')).join('\\n');\n        const blob = new Blob([csv], { type: 'text/csv' });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = 'access_log.csv';\n        a.click();\n        URL.revokeObjectURL(url);\n    }\n\n    const totalPages = Math.ceil(totalCount / perpage);\n    const startItem = page * perpage + 1;\n    const endItem = Math.min((page + 1) * perpage, totalCount);\n\n    // Sort icon helper\n    function SortIcon({ field }: { field: string }) {\n        if (field !== sort) {\n            return (\n                <svg className=\"w-3 h-3 text-gray-400 ml-1 inline\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path d=\"M7 10l5-5 5 5H7zm0 4l5 5 5-5H7z\" />\n                </svg>\n            );\n        }\n        return order === 'ASC' ? (\n            <svg className=\"w-3 h-3 text-blue-600 ml-1 inline\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path d=\"M7 14l5-5 5 5H7z\" />\n            </svg>\n        ) : (\n            <svg className=\"w-3 h-3 text-blue-600 ml-1 inline\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path d=\"M7 10l5 5 5-5H7z\" />\n            </svg>\n        );\n    }\n\n    const sortableHeader = (label: string, field: string) => (\n        <th\n            className=\"pb-3 font-medium cursor-pointer hover:text-gray-800 select-none whitespace-nowrap\"\n            onClick={() => handleSort(field)}\n        >\n            {label}\n            <SortIcon field={field} />\n        </th>\n    );\n\n    return (\n        <div className=\"p-4 lg:p-6\">\n            {/* Filters */}\n            <div className=\"bg-white rounded-xl p-4 shadow-sm mb-6\">\n                <div className=\"flex flex-wrap items-center gap-3\">\n                    {/* Search */}\n                    <div className=\"flex-1 min-w-[200px] flex gap-2\">\n                        <input\n                            type=\"text\"\n                            placeholder=\"Search by name or SDMS ID...\"\n                            className=\"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            value={searchInput}\n                            onInput={(e) => setSearchInput((e.target as HTMLInputElement).value)}\n                            onKeyDown={(e) => { if (e.key === 'Enter') handleSearch(); }}\n                        />\n                        <button\n                            onClick={handleSearch}\n                            className=\"px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700\"\n                        >\n                            Search\n                        </button>\n                    </div>\n\n                    {/* Date range */}\n                    <input\n                        type=\"date\"\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={toDateInputValue(dateFrom)}\n                        onChange={(e) => {\n                            setDateFrom(fromDateInput((e.target as HTMLInputElement).value));\n                            setPage(0);\n                        }}\n                    />\n                    <span className=\"text-gray-400 text-sm\">to</span>\n                    <input\n                        type=\"date\"\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={toDateInputValue(dateTo)}\n                        onChange={(e) => {\n                            setDateTo(fromDateInput((e.target as HTMLInputElement).value) + 86399);\n                            setPage(0);\n                        }}\n                    />\n\n                    {/* School filter */}\n                    <input\n                        type=\"text\"\n                        placeholder=\"School code\"\n                        className=\"w-32 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={schoolCode}\n                        onInput={(e) => {\n                            setSchoolCode((e.target as HTMLInputElement).value);\n                            setPage(0);\n                        }}\n                    />\n\n                    {/* User type filter */}\n                    <select\n                        className=\"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        value={userType}\n                        onChange={(e) => {\n                            setUserType((e.target as HTMLSelectElement).value);\n                            setPage(0);\n                        }}\n                    >\n                        <option value=\"\">All Users</option>\n                        <option value=\"student\">Students</option>\n                        <option value=\"teacher\">Teachers</option>\n                    </select>\n\n                    {/* Export */}\n                    <button\n                        onClick={handleExportCsv}\n                        className=\"px-4 py-2 text-sm border border-gray-200 rounded-lg hover:bg-gray-50\"\n                    >\n                        Export CSV\n                    </button>\n                </div>\n            </div>\n\n            {/* Table */}\n            <div className=\"bg-white rounded-xl shadow-sm overflow-hidden\">\n                <div className=\"overflow-x-auto\">\n                    <table className=\"w-full text-sm\">\n                        <thead>\n                            <tr className=\"text-left text-gray-500 border-b border-gray-100\">\n                                {sortableHeader('Time', 'access_time')}\n                                {sortableHeader('User', 'user_fullname')}\n                                <th className=\"pb-3 font-medium\">SDMS ID</th>\n                                <th className=\"pb-3 font-medium\">Type</th>\n                                {sortableHeader('School', 'school_name')}\n                                {sortableHeader('Course', 'course_name')}\n                                <th className=\"pb-3 font-medium\">Action</th>\n                                <th className=\"pb-3 font-medium\">Target</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {loading ? (\n                                Array.from({ length: 5 }).map((_, i) => (\n                                    <tr key={i} className=\"border-b border-gray-50\">\n                                        {Array.from({ length: 8 }).map((_, j) => (\n                                            <td key={j} className=\"py-3 px-2\">\n                                                <div className=\"h-4 bg-gray-200 rounded animate-pulse\"></div>\n                                            </td>\n                                        ))}\n                                    </tr>\n                                ))\n                            ) : entries.length === 0 ? (\n                                <tr>\n                                    <td colSpan={8} className=\"py-12 text-center text-gray-500\">\n                                        No access log entries found\n                                    </td>\n                                </tr>\n                            ) : (\n                                entries.map((entry, idx) => (\n                                    <tr key={idx} className=\"border-b border-gray-50 hover:bg-gray-50\">\n                                        <td className=\"py-3 px-2 text-gray-600 whitespace-nowrap\">{formatDateTime(entry.access_time)}</td>\n                                        <td className=\"py-3 px-2 font-medium text-gray-800\">{entry.user_fullname}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{entry.sdms_id || '-'}</td>\n                                        <td className=\"py-3 px-2\">\n                                            {entry.user_type ? (\n                                                <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${\n                                                    entry.user_type === 'teacher' ? 'bg-purple-100 text-purple-700' : 'bg-blue-100 text-blue-700'\n                                                }`}>\n                                                    {entry.user_type}\n                                                </span>\n                                            ) : '-'}\n                                        </td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{entry.school_name || '-'}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{entry.course_name || '-'}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{entry.action}</td>\n                                        <td className=\"py-3 px-2 text-gray-600\">{entry.target}</td>\n                                    </tr>\n                                ))\n                            )}\n                        </tbody>\n                    </table>\n                </div>\n\n                {/* Pagination */}\n                {totalCount > 0 && (\n                    <div className=\"flex items-center justify-between px-4 py-3 border-t border-gray-100\">\n                        <span className=\"text-sm text-gray-600\">\n                            {startItem}-{endItem} of {totalCount.toLocaleString()}\n                        </span>\n                        <div className=\"flex gap-2\">\n                            <button\n                                onClick={() => setPage(Math.max(0, page - 1))}\n                                disabled={page === 0}\n                                className=\"px-3 py-1 text-sm border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                            >\n                                Previous\n                            </button>\n                            <span className=\"px-3 py-1 text-sm text-gray-600\">\n                                Page {page + 1} of {totalPages}\n                            </span>\n                            <button\n                                onClick={() => setPage(Math.min(totalPages - 1, page + 1))}\n                                disabled={page >= totalPages - 1}\n                                className=\"px-3 py-1 text-sm border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                            >\n                                Next\n                            </button>\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Admin panel component for Elby Dashboard.\n *\n * Displays sync status, logs, manual triggers, and cache stats.\n *\n * @module     local_elby_dashboard/components/AdminPanel\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState, useEffect, useRef } from 'preact/hooks';\nimport type { UnlinkedUser, EnrollmentCoverageEntry, EnrollmentCoverageSummary, EnrollmentLogEntry, EnrollmentLogsSummary } from '../types';\n\n// @ts-ignore\ndeclare const require: (deps: string[], callback: (...args: any[]) => void) => void;\n\nfunction ajaxCall(methodname: string, args: Record<string, any>): Promise<any> {\n    return new Promise((resolve, reject) => {\n        require(['core/ajax'], (Ajax: any) => {\n            Ajax.call([{ methodname, args }])[0].then(resolve).catch(reject);\n        });\n    });\n}\n\ninterface AdminStats {\n    linked_users: number;\n    stale_users: number;\n    error_users: number;\n    total_schools: number;\n    user_metrics_count: number;\n    school_metrics_count: number;\n}\n\ninterface SyncLogEntry {\n    id: number;\n    sync_type: string;\n    entity_id: string;\n    operation: string;\n    error_message: string | null;\n    triggered_by: string;\n    timecreated: number;\n}\n\ninterface LookupPreview {\n    sdms_id: string;\n    status: string;\n    academic_year: string;\n    school_name: string;\n    student_name: string;\n    program: string;\n    position: string;\n    user_type: string;\n}\n\nfunction formatTimestamp(ts: number): string {\n    if (!ts) return 'Never';\n    return new Date(ts * 1000).toLocaleString();\n}\n\nfunction StatCard({ label, value, icon, color }: { label: string; value: number | string; icon: JSX.Element; color: string }) {\n    return (\n        <div className={`rounded-xl p-4 ${color}`}>\n            <div className=\"flex items-center gap-3\">\n                <div className=\"w-10 h-10 rounded-full bg-white/40 flex items-center justify-center\">\n                    {icon}\n                </div>\n                <div>\n                    <p className=\"text-2xl font-bold text-gray-800\">{value}</p>\n                    <p className=\"text-xs text-gray-600\">{label}</p>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nfunction OperationBadge({ operation }: { operation: string }) {\n    const colors: Record<string, string> = {\n        create: 'bg-green-100 text-green-700',\n        update: 'bg-blue-100 text-blue-700',\n        skip: 'bg-gray-100 text-gray-700',\n        error: 'bg-red-100 text-red-700',\n    };\n    return (\n        <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${colors[operation] || 'bg-gray-100 text-gray-700'}`}>\n            {operation}\n        </span>\n    );\n}\n\nfunction LinkUserSection({ onLinked }: { onLinked: () => void }) {\n    const [search, setSearch] = useState('');\n    const [users, setUsers] = useState<UnlinkedUser[]>([]);\n    const [searching, setSearching] = useState(false);\n    const [totalCount, setTotalCount] = useState(0);\n    const [selectedUser, setSelectedUser] = useState<UnlinkedUser | null>(null);\n    const [sdmsCode, setSdmsCode] = useState('');\n    const [userType, setUserType] = useState('student');\n    const [lookupPreview, setLookupPreview] = useState<LookupPreview | null>(null);\n    const [lookingUp, setLookingUp] = useState(false);\n    const [linking, setLinking] = useState(false);\n    const [linkNotification, setLinkNotification] = useState<{ type: 'success' | 'error'; message: string } | null>(null);\n    const searchTimer = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n    function handleSearchChange(value: string) {\n        setSearch(value);\n        setSelectedUser(null);\n        setLookupPreview(null);\n        setLinkNotification(null);\n\n        if (searchTimer.current) clearTimeout(searchTimer.current);\n        if (value.trim().length < 2) {\n            setUsers([]);\n            setTotalCount(0);\n            return;\n        }\n        searchTimer.current = setTimeout(() => doSearch(value.trim()), 400);\n    }\n\n    async function doSearch(term: string) {\n        setSearching(true);\n        try {\n            const result = await ajaxCall('local_elby_dashboard_search_unlinked_users', {\n                search: term, page: 0, perpage: 20\n            });\n            setUsers(result.users || []);\n            setTotalCount(result.total_count || 0);\n        } catch {\n            setUsers([]);\n        } finally {\n            setSearching(false);\n        }\n    }\n\n    async function handleLookup() {\n        if (!sdmsCode.trim()) return;\n        setLookingUp(true);\n        setLookupPreview(null);\n        setLinkNotification(null);\n        try {\n            const result = await ajaxCall('local_elby_dashboard_lookup_sdms_user', {\n                sdms_code: sdmsCode.trim(), user_type: userType\n            });\n            if (!result.success) {\n                setLinkNotification({ type: 'error', message: result.error || 'Not found in SDMS' });\n                return;\n            }\n            const name = result.student_data?.names || '';\n            setLookupPreview({\n                sdms_id: result.sdms_id,\n                status: result.status || '',\n                academic_year: result.academic_year || '',\n                school_name: result.school?.school_name || '',\n                student_name: name,\n                program: result.student_data?.program || '',\n                position: result.staff_data?.position || '',\n                user_type: userType,\n            });\n        } catch (err: any) {\n            setLinkNotification({ type: 'error', message: err?.message || 'Lookup failed' });\n        } finally {\n            setLookingUp(false);\n        }\n    }\n\n    async function handleLink() {\n        if (!selectedUser || !sdmsCode.trim()) return;\n        setLinking(true);\n        setLinkNotification(null);\n        try {\n            const result = await ajaxCall('local_elby_dashboard_link_user', {\n                userid: selectedUser.userid, sdms_code: sdmsCode.trim(), user_type: userType\n            });\n            if (result.success) {\n                setLinkNotification({ type: 'success', message: `Successfully linked ${selectedUser.fullname} to ${sdmsCode}` });\n                setSelectedUser(null);\n                setSdmsCode('');\n                setLookupPreview(null);\n                // Remove linked user from list.\n                setUsers(prev => prev.filter(u => u.userid !== selectedUser.userid));\n                onLinked();\n            } else {\n                setLinkNotification({ type: 'error', message: result.error || 'Link failed' });\n            }\n        } catch (err: any) {\n            setLinkNotification({ type: 'error', message: err?.message || 'Link failed' });\n        } finally {\n            setLinking(false);\n        }\n    }\n\n    return (\n        <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n            <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Link User to SDMS</h3>\n\n            {linkNotification && (\n                <div className={`mb-4 px-4 py-3 rounded-lg text-sm ${\n                    linkNotification.type === 'success'\n                        ? 'bg-green-50 text-green-800 border border-green-200'\n                        : 'bg-red-50 text-red-800 border border-red-200'\n                }`}>\n                    {linkNotification.message}\n                    <button onClick={() => setLinkNotification(null)} className=\"float-right text-lg leading-none opacity-60 hover:opacity-100\">&times;</button>\n                </div>\n            )}\n\n            {/* Search unlinked users */}\n            <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Search Unlinked Users</label>\n                <input\n                    type=\"text\"\n                    value={search}\n                    onInput={(e) => handleSearchChange((e.target as HTMLInputElement).value)}\n                    placeholder=\"Search by name, username, or email...\"\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                />\n                {searching && <p className=\"text-xs text-gray-400 mt-1\">Searching...</p>}\n                {!searching && totalCount > 0 && (\n                    <p className=\"text-xs text-gray-500 mt-1\">{totalCount} unlinked user{totalCount !== 1 ? 's' : ''} found</p>\n                )}\n            </div>\n\n            {/* Results list */}\n            {users.length > 0 && !selectedUser && (\n                <div className=\"mb-4 max-h-48 overflow-y-auto border border-gray-200 rounded-lg\">\n                    {users.map(user => (\n                        <button\n                            key={user.userid}\n                            onClick={() => { setSelectedUser(user); setSdmsCode(''); setLookupPreview(null); setLinkNotification(null); }}\n                            className=\"w-full text-left px-4 py-2 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 transition-colors\"\n                        >\n                            <p className=\"text-sm font-medium text-gray-800\">{user.fullname}</p>\n                            <p className=\"text-xs text-gray-500\">{user.username} &middot; {user.email}</p>\n                        </button>\n                    ))}\n                </div>\n            )}\n\n            {/* Selected user - link form */}\n            {selectedUser && (\n                <div className=\"border border-blue-200 bg-blue-50 rounded-lg p-4 mb-4\">\n                    <div className=\"flex items-center justify-between mb-3\">\n                        <div>\n                            <p className=\"text-sm font-semibold text-gray-800\">{selectedUser.fullname}</p>\n                            <p className=\"text-xs text-gray-500\">{selectedUser.username} &middot; {selectedUser.email}</p>\n                        </div>\n                        <button\n                            onClick={() => { setSelectedUser(null); setLookupPreview(null); }}\n                            className=\"text-gray-400 hover:text-gray-600 text-lg\"\n                        >&times;</button>\n                    </div>\n\n                    <div className=\"flex gap-2 mb-3\">\n                        <input\n                            type=\"text\"\n                            value={sdmsCode}\n                            onInput={(e) => setSdmsCode((e.target as HTMLInputElement).value)}\n                            placeholder=\"Enter SDMS code...\"\n                            className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm\"\n                        />\n                        <select\n                            value={userType}\n                            onChange={(e) => setUserType((e.target as HTMLSelectElement).value)}\n                            className=\"px-3 py-2 border border-gray-300 rounded-lg text-sm\"\n                        >\n                            <option value=\"student\">Student</option>\n                            <option value=\"staff\">Staff</option>\n                        </select>\n                        <button\n                            onClick={handleLookup}\n                            disabled={lookingUp || !sdmsCode.trim()}\n                            className=\"px-4 py-2 bg-gray-600 text-white rounded-lg text-sm hover:bg-gray-700 disabled:opacity-50\"\n                        >\n                            {lookingUp ? '...' : 'Lookup'}\n                        </button>\n                    </div>\n\n                    {/* Lookup preview */}\n                    {lookupPreview && (\n                        <div className=\"bg-white rounded-lg p-3 mb-3 border border-gray-200\">\n                            <p className=\"text-sm font-medium text-gray-800 mb-1\">SDMS Preview</p>\n                            <div className=\"grid grid-cols-2 gap-1 text-xs\">\n                                <span className=\"text-gray-500\">SDMS ID:</span>\n                                <span className=\"text-gray-800\">{lookupPreview.sdms_id}</span>\n                                {lookupPreview.student_name && <>\n                                    <span className=\"text-gray-500\">Name:</span>\n                                    <span className=\"text-gray-800\">{lookupPreview.student_name}</span>\n                                </>}\n                                <span className=\"text-gray-500\">School:</span>\n                                <span className=\"text-gray-800\">{lookupPreview.school_name || '-'}</span>\n                                <span className=\"text-gray-500\">Status:</span>\n                                <span className=\"text-gray-800\">{lookupPreview.status || '-'}</span>\n                                {lookupPreview.program && <>\n                                    <span className=\"text-gray-500\">Program:</span>\n                                    <span className=\"text-gray-800\">{lookupPreview.program}</span>\n                                </>}\n                                {lookupPreview.position && <>\n                                    <span className=\"text-gray-500\">Position:</span>\n                                    <span className=\"text-gray-800\">{lookupPreview.position}</span>\n                                </>}\n                            </div>\n                        </div>\n                    )}\n\n                    {lookupPreview && (\n                        <button\n                            onClick={handleLink}\n                            disabled={linking}\n                            className=\"w-full px-4 py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700 disabled:opacity-50\"\n                        >\n                            {linking ? 'Linking...' : `Link ${selectedUser.fullname} to ${sdmsCode}`}\n                        </button>\n                    )}\n                </div>\n            )}\n        </div>\n    );\n}\n\nfunction EnrollmentCoverageSection() {\n    const [entries, setEntries] = useState<EnrollmentCoverageEntry[]>([]);\n    const [summary, setSummary] = useState<EnrollmentCoverageSummary | null>(null);\n    const [loading, setLoading] = useState(true);\n    const [filter, setFilter] = useState<'all' | 'mapped' | 'unmapped' | 'partial'>('all');\n\n    useEffect(() => {\n        loadCoverage();\n    }, []);\n\n    async function loadCoverage() {\n        try {\n            setLoading(true);\n            const result = await ajaxCall('local_elby_dashboard_get_enrollment_coverage', {});\n            setEntries(result.entries || []);\n            setSummary(result.summary || null);\n        } catch (err) {\n            console.error('Failed to load enrollment coverage:', err);\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    const filtered = filter === 'all' ? entries : entries.filter(e => e.coverage_status === filter);\n\n    const statusColors: Record<string, string> = {\n        mapped: 'bg-green-100 text-green-700',\n        unmapped: 'bg-red-100 text-red-700',\n        partial: 'bg-yellow-100 text-yellow-700',\n    };\n\n    return (\n        <div className=\"bg-white rounded-xl p-6 shadow-sm mb-6\">\n            <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Enrollment Coverage</h3>\n\n            {loading ? (\n                <div className=\"animate-pulse space-y-3\">\n                    <div className=\"h-6 bg-gray-200 rounded w-64\"></div>\n                    <div className=\"h-48 bg-gray-200 rounded\"></div>\n                </div>\n            ) : (\n                <>\n                    {summary && (\n                        <div className=\"grid grid-cols-2 lg:grid-cols-5 gap-3 mb-4\">\n                            <div className=\"bg-gray-50 rounded-lg p-3 text-center\">\n                                <p className=\"text-lg font-bold text-gray-800\">{summary.total_combos}</p>\n                                <p className=\"text-xs text-gray-500\">Total Combos</p>\n                            </div>\n                            <div className=\"bg-green-50 rounded-lg p-3 text-center\">\n                                <p className=\"text-lg font-bold text-green-700\">{summary.mapped_combos}</p>\n                                <p className=\"text-xs text-gray-500\">Mapped</p>\n                            </div>\n                            <div className=\"bg-red-50 rounded-lg p-3 text-center\">\n                                <p className=\"text-lg font-bold text-red-700\">{summary.unmapped_combos}</p>\n                                <p className=\"text-xs text-gray-500\">Unmapped</p>\n                            </div>\n                            <div className=\"bg-blue-50 rounded-lg p-3 text-center\">\n                                <p className=\"text-lg font-bold text-blue-700\">{summary.total_sdms_students.toLocaleString()}</p>\n                                <p className=\"text-xs text-gray-500\">SDMS Students</p>\n                            </div>\n                            <div className=\"bg-cyan-50 rounded-lg p-3 text-center\">\n                                <p className=\"text-lg font-bold text-cyan-700\">{summary.total_enrolled_students.toLocaleString()}</p>\n                                <p className=\"text-xs text-gray-500\">Enrolled</p>\n                            </div>\n                        </div>\n                    )}\n\n                    <div className=\"flex gap-2 mb-4\">\n                        {(['all', 'mapped', 'unmapped', 'partial'] as const).map(f => (\n                            <button\n                                key={f}\n                                onClick={() => setFilter(f)}\n                                className={`px-3 py-1.5 text-xs rounded-full transition-colors ${\n                                    filter === f\n                                        ? 'bg-blue-600 text-white'\n                                        : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                                }`}\n                            >\n                                {f.charAt(0).toUpperCase() + f.slice(1)} ({f === 'all' ? entries.length : entries.filter(e => e.coverage_status === f).length})\n                            </button>\n                        ))}\n                    </div>\n\n                    {filtered.length === 0 ? (\n                        <div className=\"text-center text-gray-400 py-6 text-sm\">No entries found</div>\n                    ) : (\n                        <div className=\"overflow-x-auto max-h-96 overflow-y-auto\">\n                            <table className=\"w-full text-xs\">\n                                <thead className=\"sticky top-0 bg-white\">\n                                    <tr className=\"text-left text-gray-500 border-b border-gray-200\">\n                                        <th className=\"pb-2 font-medium\">Trade</th>\n                                        <th className=\"pb-2 font-medium\">Level</th>\n                                        <th className=\"pb-2 font-medium text-right\">SDMS Students</th>\n                                        <th className=\"pb-2 font-medium\">Category</th>\n                                        <th className=\"pb-2 font-medium text-right\">Courses</th>\n                                        <th className=\"pb-2 font-medium text-right\">Enrolled</th>\n                                        <th className=\"pb-2 font-medium\">Status</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {filtered.map((entry, i) => (\n                                        <tr key={i} className={`border-b border-gray-50 ${entry.coverage_status === 'unmapped' ? 'bg-red-50/50' : ''}`}>\n                                            <td className=\"py-2 text-gray-800\">{entry.combination_name}</td>\n                                            <td className=\"py-2 text-gray-600\">{entry.level_name}</td>\n                                            <td className=\"py-2 text-gray-600 text-right\">{entry.sdms_student_count}</td>\n                                            <td className=\"py-2 text-gray-600 truncate max-w-[120px]\">{entry.category_name || '-'}</td>\n                                            <td className=\"py-2 text-gray-600 text-right\">{entry.course_count}</td>\n                                            <td className=\"py-2 text-gray-600 text-right\">{entry.enrolled_student_count}</td>\n                                            <td className=\"py-2\">\n                                                <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${statusColors[entry.coverage_status] || 'bg-gray-100 text-gray-700'}`}>\n                                                    {entry.coverage_status}\n                                                </span>\n                                            </td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        </div>\n                    )}\n                </>\n            )}\n        </div>\n    );\n}\n\nfunction EnrollmentLogsSection() {\n    const [logs, setLogs] = useState<EnrollmentLogEntry[]>([]);\n    const [summary, setSummary] = useState<EnrollmentLogsSummary | null>(null);\n    const [totalCount, setTotalCount] = useState(0);\n    const [page, setPage] = useState(0);\n    const [loading, setLoading] = useState(true);\n    const [operationFilter, setOperationFilter] = useState('');\n    const perpage = 25;\n\n    useEffect(() => {\n        loadLogs();\n    }, [page, operationFilter]);\n\n    async function loadLogs() {\n        try {\n            setLoading(true);\n            const result = await ajaxCall('local_elby_dashboard_get_enrollment_logs', {\n                page,\n                perpage,\n                operation: operationFilter,\n            });\n            setLogs(result.logs || []);\n            setTotalCount(result.total_count || 0);\n            setSummary(result.summary || null);\n        } catch (err) {\n            console.error('Failed to load enrollment logs:', err);\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    const totalPages = Math.ceil(totalCount / perpage);\n\n    return (\n        <div className=\"bg-white rounded-xl p-6 shadow-sm mb-6\">\n            <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Auto-enrollment Logs</h3>\n\n            {loading && !summary ? (\n                <div className=\"animate-pulse space-y-3\">\n                    <div className=\"h-6 bg-gray-200 rounded w-64\"></div>\n                    <div className=\"h-48 bg-gray-200 rounded\"></div>\n                </div>\n            ) : (\n                <>\n                    {summary && (\n                        <div className=\"grid grid-cols-3 gap-3 mb-4\">\n                            <div className=\"bg-green-50 rounded-lg p-3 text-center\">\n                                <p className=\"text-lg font-bold text-green-700\">{summary.total_enrollments.toLocaleString()}</p>\n                                <p className=\"text-xs text-gray-500\">Auto-enrollments</p>\n                            </div>\n                            <div className=\"bg-gray-50 rounded-lg p-3 text-center\">\n                                <p className=\"text-lg font-bold text-gray-700\">{summary.total_skips.toLocaleString()}</p>\n                                <p className=\"text-xs text-gray-500\">Skipped</p>\n                            </div>\n                            <div className=\"bg-blue-50 rounded-lg p-3 text-center\">\n                                <p className=\"text-lg font-bold text-blue-700\">\n                                    {summary.last_enrollment_time ? formatTimestamp(summary.last_enrollment_time) : 'Never'}\n                                </p>\n                                <p className=\"text-xs text-gray-500\">Last Enrollment</p>\n                            </div>\n                        </div>\n                    )}\n\n                    <div className=\"flex gap-2 mb-4\">\n                        {[\n                            { value: '', label: 'All' },\n                            { value: 'create', label: 'Enrolled' },\n                            { value: 'skip', label: 'Skipped' },\n                        ].map(opt => (\n                            <button\n                                key={opt.value}\n                                onClick={() => { setOperationFilter(opt.value); setPage(0); }}\n                                className={`px-3 py-1.5 text-xs rounded-full transition-colors ${\n                                    operationFilter === opt.value\n                                        ? 'bg-blue-600 text-white'\n                                        : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                                }`}\n                            >\n                                {opt.label}\n                            </button>\n                        ))}\n                    </div>\n\n                    {logs.length === 0 ? (\n                        <div className=\"text-center text-gray-400 py-6 text-sm\">No enrollment logs found</div>\n                    ) : (\n                        <div className=\"overflow-x-auto max-h-80 overflow-y-auto\">\n                            <table className=\"w-full text-xs\">\n                                <thead className=\"sticky top-0 bg-white\">\n                                    <tr className=\"text-left text-gray-500 border-b border-gray-200\">\n                                        <th className=\"pb-2 font-medium\">Time</th>\n                                        <th className=\"pb-2 font-medium\">Student</th>\n                                        <th className=\"pb-2 font-medium\">Trade:Level</th>\n                                        <th className=\"pb-2 font-medium\">Status</th>\n                                        <th className=\"pb-2 font-medium\">Details</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {logs.map(log => (\n                                        <tr key={log.id} className=\"border-b border-gray-50\">\n                                            <td className=\"py-2 text-gray-500 whitespace-nowrap\">{formatTimestamp(log.timecreated)}</td>\n                                            <td className=\"py-2 text-gray-800\">{log.user_fullname}</td>\n                                            <td className=\"py-2 text-gray-600\">{log.entity_id || '-'}</td>\n                                            <td className=\"py-2\"><OperationBadge operation={log.operation} /></td>\n                                            <td className=\"py-2 text-gray-500 truncate max-w-[200px]\">{log.details || '-'}</td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        </div>\n                    )}\n\n                    {totalPages > 1 && (\n                        <div className=\"flex items-center justify-between mt-4 pt-3 border-t border-gray-100\">\n                            <p className=\"text-xs text-gray-500\">\n                                Showing {page * perpage + 1}-{Math.min((page + 1) * perpage, totalCount)} of {totalCount}\n                            </p>\n                            <div className=\"flex gap-2\">\n                                <button\n                                    onClick={() => setPage(p => Math.max(0, p - 1))}\n                                    disabled={page === 0}\n                                    className=\"px-3 py-1.5 text-xs bg-gray-100 rounded hover:bg-gray-200 disabled:opacity-50\"\n                                >\n                                    Previous\n                                </button>\n                                <button\n                                    onClick={() => setPage(p => Math.min(totalPages - 1, p + 1))}\n                                    disabled={page >= totalPages - 1}\n                                    className=\"px-3 py-1.5 text-xs bg-gray-100 rounded hover:bg-gray-200 disabled:opacity-50\"\n                                >\n                                    Next\n                                </button>\n                            </div>\n                        </div>\n                    )}\n                </>\n            )}\n        </div>\n    );\n}\n\nexport default function AdminPanel() {\n    const [stats, setStats] = useState<AdminStats | null>(null);\n    const [logs, setLogs] = useState<SyncLogEntry[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [syncing, setSyncing] = useState<string | null>(null);\n    const [notification, setNotification] = useState<{ type: 'success' | 'error'; message: string } | null>(null);\n\n    useEffect(() => {\n        loadAdminData();\n    }, []);\n\n    async function loadAdminData() {\n        try {\n            setLoading(true);\n            // Read pre-loaded admin stats from data attributes.\n            const container = document.getElementById('elby-dashboard-root');\n            const adminDataAttr = container?.getAttribute('data-admin');\n            if (adminDataAttr) {\n                try {\n                    const data = JSON.parse(adminDataAttr);\n                    setStats(data.stats);\n                    setLogs(data.logs || []);\n                } catch (e) {\n                    console.error('Failed to parse admin data:', e);\n                }\n            }\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    async function handleManualSync(type: string) {\n        setSyncing(type);\n        setNotification(null);\n        try {\n            const taskMap: Record<string, string> = {\n                user_metrics: 'compute_user_metrics',\n                school_metrics: 'aggregate_school_metrics',\n                sdms_cache: 'refresh_sdms_cache',\n            };\n            const taskName = taskMap[type];\n            if (!taskName) return;\n\n            const result = await ajaxCall('local_elby_dashboard_trigger_task', { task_name: taskName });\n            if (result.success) {\n                setNotification({ type: 'success', message: result.message });\n                loadAdminData();\n            } else {\n                setNotification({ type: 'error', message: result.message });\n            }\n        } catch (err: any) {\n            setNotification({ type: 'error', message: err?.message || 'Failed to run task' });\n        } finally {\n            setSyncing(null);\n        }\n    }\n\n    if (loading) {\n        return (\n            <div className=\"p-6 animate-pulse space-y-4\">\n                <div className=\"h-8 bg-gray-200 rounded w-48\"></div>\n                <div className=\"grid grid-cols-2 lg:grid-cols-3 gap-4\">\n                    {[1, 2, 3, 4, 5, 6].map(i => <div key={i} className=\"h-20 bg-gray-200 rounded-xl\"></div>)}\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"p-4 lg:p-6\">\n            {/* Stats Cards */}\n            {stats && (\n                <div className=\"grid grid-cols-2 lg:grid-cols-3 gap-4 mb-6\">\n                    <StatCard\n                        label=\"Linked Users\"\n                        value={stats.linked_users}\n                        color=\"bg-cyan-50\"\n                        icon={<svg className=\"w-5 h-5 text-cyan-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5z\"/></svg>}\n                    />\n                    <StatCard\n                        label=\"Stale Records\"\n                        value={stats.stale_users}\n                        color=\"bg-yellow-50\"\n                        icon={<svg className=\"w-5 h-5 text-yellow-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z\"/></svg>}\n                    />\n                    <StatCard\n                        label=\"Sync Errors\"\n                        value={stats.error_users}\n                        color=\"bg-red-50\"\n                        icon={<svg className=\"w-5 h-5 text-red-500\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z\"/></svg>}\n                    />\n                    <StatCard\n                        label=\"Schools\"\n                        value={stats.total_schools}\n                        color=\"bg-blue-50\"\n                        icon={<svg className=\"w-5 h-5 text-blue-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3z\"/></svg>}\n                    />\n                    <StatCard\n                        label=\"User Metrics\"\n                        value={stats.user_metrics_count.toLocaleString()}\n                        color=\"bg-green-50\"\n                        icon={<svg className=\"w-5 h-5 text-green-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/></svg>}\n                    />\n                    <StatCard\n                        label=\"School Metrics\"\n                        value={stats.school_metrics_count.toLocaleString()}\n                        color=\"bg-purple-50\"\n                        icon={<svg className=\"w-5 h-5 text-purple-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/></svg>}\n                    />\n                </div>\n            )}\n\n            {notification && (\n                <div className={`mb-4 px-4 py-3 rounded-lg text-sm ${\n                    notification.type === 'success'\n                        ? 'bg-green-50 text-green-800 border border-green-200'\n                        : 'bg-red-50 text-red-800 border border-red-200'\n                }`}>\n                    {notification.message}\n                    <button onClick={() => setNotification(null)} className=\"float-right text-lg leading-none opacity-60 hover:opacity-100\">&times;</button>\n                </div>\n            )}\n\n            {/* Link User to SDMS */}\n            <div className=\"mb-6\">\n                <LinkUserSection onLinked={loadAdminData} />\n            </div>\n\n            {/* Enrollment Coverage Report */}\n            <EnrollmentCoverageSection />\n\n            {/* Auto-enrollment Logs */}\n            <EnrollmentLogsSection />\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                {/* Manual Sync Triggers */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Manual Sync Triggers</h3>\n                    <p className=\"text-sm text-gray-500 mb-4\">\n                        Run scheduled tasks manually from Site Admin &gt; Server &gt; Scheduled Tasks, or use the buttons below.\n                    </p>\n                    <div className=\"space-y-3\">\n                        <button\n                            onClick={() => handleManualSync('user_metrics')}\n                            disabled={syncing !== null}\n                            className=\"w-full flex items-center justify-between px-4 py-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50\"\n                        >\n                            <div>\n                                <p className=\"text-sm font-medium text-gray-800\">Compute User Metrics</p>\n                                <p className=\"text-xs text-gray-500\">Hourly task - aggregates logstore data</p>\n                            </div>\n                            {syncing === 'user_metrics' && (\n                                <div className=\"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\n                            )}\n                        </button>\n                        <button\n                            onClick={() => handleManualSync('school_metrics')}\n                            disabled={syncing !== null}\n                            className=\"w-full flex items-center justify-between px-4 py-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50\"\n                        >\n                            <div>\n                                <p className=\"text-sm font-medium text-gray-800\">Aggregate School Metrics</p>\n                                <p className=\"text-xs text-gray-500\">Daily task - rolls up to school level</p>\n                            </div>\n                            {syncing === 'school_metrics' && (\n                                <div className=\"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\n                            )}\n                        </button>\n                        <button\n                            onClick={() => handleManualSync('sdms_cache')}\n                            disabled={syncing !== null}\n                            className=\"w-full flex items-center justify-between px-4 py-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50\"\n                        >\n                            <div>\n                                <p className=\"text-sm font-medium text-gray-800\">Refresh SDMS Cache</p>\n                                <p className=\"text-xs text-gray-500\">Daily task - refreshes stale SDMS records</p>\n                            </div>\n                            {syncing === 'sdms_cache' && (\n                                <div className=\"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\n                            )}\n                        </button>\n                    </div>\n                </div>\n\n                {/* Recent Sync Logs */}\n                <div className=\"bg-white rounded-xl p-6 shadow-sm\">\n                    <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Recent Sync Logs</h3>\n                    {logs.length === 0 ? (\n                        <div className=\"text-center text-gray-400 py-8\">\n                            <p>No sync logs found</p>\n                        </div>\n                    ) : (\n                        <div className=\"overflow-x-auto max-h-80 overflow-y-auto\">\n                            <table className=\"w-full text-xs\">\n                                <thead className=\"sticky top-0 bg-white\">\n                                    <tr className=\"text-left text-gray-500 border-b border-gray-100\">\n                                        <th className=\"pb-2 font-medium\">Type</th>\n                                        <th className=\"pb-2 font-medium\">Entity</th>\n                                        <th className=\"pb-2 font-medium\">Op</th>\n                                        <th className=\"pb-2 font-medium\">Time</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {logs.map(log => (\n                                        <tr key={log.id} className=\"border-b border-gray-50\">\n                                            <td className=\"py-2 text-gray-600\">{log.sync_type}</td>\n                                            <td className=\"py-2 text-gray-600 truncate max-w-[80px]\">{log.entity_id || '-'}</td>\n                                            <td className=\"py-2\"><OperationBadge operation={log.operation} /></td>\n                                            <td className=\"py-2 text-gray-500\">{formatTimestamp(log.timecreated)}</td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Root Preact application component for Elby Dashboard.\n *\n * @module     local_elby_dashboard/app\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { useState } from 'preact/hooks';\nimport './styles.css';\nimport Dashboard from './components/Dashboard';\nimport Sidebar from './components/Sidebar';\nimport CompletionReport from './components/CompletionReport';\nimport CoursesReport from './components/CoursesReport';\nimport SchoolDirectory from './components/SchoolDirectory';\nimport SchoolDetail from './components/SchoolDetail';\nimport StudentList from './components/StudentList';\nimport TrafficReport from './components/TrafficReport';\nimport AccessLog from './components/AccessLog';\nimport AdminPanel from './components/AdminPanel';\nimport type { UserData, StatsData, PageId, SidenavConfig, ThemeConfig, CoursesReportData } from './types';\n\ninterface AppProps {\n    user: UserData;\n    stats: StatsData;\n    activePage: PageId;\n    sidenavConfig: SidenavConfig;\n    themeConfig: ThemeConfig;\n    coursesReportData?: CoursesReportData | null;\n    schoolCode?: string;\n}\n\n// Header component with search and user profile\nfunction Header({ user, activePage, themeConfig, onMenuClick }: {\n    user: UserData;\n    activePage: PageId;\n    themeConfig: ThemeConfig;\n    onMenuClick: () => void;\n}) {\n    const pageTitles: Record<string, string> = {\n        home: 'Dashboard',\n        completion: 'Completion Report',\n        courses: 'Courses Report',\n        schools: 'Schools Directory',\n        school_detail: 'School Detail',\n        students: 'Student List',\n        teachers: 'Teacher List',\n        traffic: 'Platform Traffic',\n        accesslog: 'Access Log',\n        admin: 'Admin Panel',\n    };\n    const pageTitle = pageTitles[activePage] || 'Dashboard';\n\n    return (\n        <header className=\"bg-white border-b border-gray-100 px-2 sm:px-4 lg:px-6 py-3 sm:py-4\">\n            <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                    {/* Hamburger Menu - Mobile only */}\n                    <button\n                        onClick={onMenuClick}\n                        className=\"lg:hidden p-2 -ml-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg\"\n                        aria-label=\"Toggle menu\"\n                    >\n                        <svg className=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M4 6h16M4 12h16M4 18h16\" />\n                        </svg>\n                    </button>\n                    {/* Page Title */}\n                    <h1 className=\"text-xl font-semibold text-gray-800\">{pageTitle}</h1>\n                </div>\n\n                <div className=\"flex items-center gap-4 lg:gap-6\">\n                    {/* Notification Bell */}\n                    {themeConfig.showNotifications && (\n                        <button className=\"relative text-gray-500 hover:text-gray-700\">\n                            <svg className=\"w-6 h-6\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                <path d=\"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9\"/>\n                                <path d=\"M13.73 21a2 2 0 0 1-3.46 0\"/>\n                            </svg>\n                            <span className=\"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full\"></span>\n                        </button>\n                    )}\n\n                    {/* User Profile */}\n                    {themeConfig.showUserProfile && (\n                        <div className=\"flex items-center gap-3\">\n                            <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center text-white font-semibold text-sm overflow-hidden\">\n                                {user.avatar ? (\n                                    <img src={user.avatar} alt={user.fullname} className=\"w-full h-full object-cover\" />\n                                ) : (\n                                    <span>{user.firstname.charAt(0)}{user.lastname.charAt(0)}</span>\n                                )}\n                            </div>\n                            <div className=\"hidden sm:block\">\n                                <p className=\"text-sm font-semibold text-gray-800\">{user.fullname}</p>\n                                <p className=\"text-xs text-gray-500\">\n                                    {user.isAdmin ? 'Admin' : user.roles.includes('teacher') ? 'Teacher' : 'User'}\n                                </p>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </header>\n    );\n}\n\nexport default function App({ user, stats, activePage, sidenavConfig, themeConfig, coursesReportData, schoolCode }: AppProps) {\n    const [sidebarOpen, setSidebarOpen] = useState(false);\n\n    const toggleSidebar = () => setSidebarOpen(!sidebarOpen);\n    const closeSidebar = () => setSidebarOpen(false);\n\n    return (\n        <div className=\"flex h-screen bg-gray-50\">\n            <Sidebar\n                activePage={activePage}\n                sidenavConfig={sidenavConfig}\n                themeConfig={themeConfig}\n                isOpen={sidebarOpen}\n                onClose={closeSidebar}\n            />\n            <div className=\"flex-1 flex flex-col min-h-0\">\n                <Header user={user} activePage={activePage} themeConfig={themeConfig} onMenuClick={toggleSidebar} />\n                <main className=\"flex-1 overflow-y-auto\">\n                    {activePage === 'home' && <Dashboard user={user} stats={stats} themeConfig={themeConfig} />}\n                    {activePage === 'completion' && <CompletionReport />}\n                    {activePage === 'courses' && coursesReportData && (\n                        <CoursesReport data={coursesReportData} themeConfig={themeConfig} />\n                    )}\n                    {activePage === 'schools' && <SchoolDirectory />}\n                    {activePage === 'school_detail' && schoolCode && <SchoolDetail schoolCode={schoolCode} />}\n                    {activePage === 'students' && <StudentList initialSchoolCode={schoolCode} />}\n                    {activePage === 'teachers' && <StudentList userType=\"teacher\" user={user} initialSchoolCode={schoolCode} />}\n                    {activePage === 'traffic' && <TrafficReport />}\n                    {activePage === 'accesslog' && <AccessLog />}\n                    {activePage === 'admin' && <AdminPanel />}\n                </main>\n            </div>\n        </div>\n    );\n}\n","// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Elby Dashboard module with Preact integration.\n *\n * @module     local_elby_dashboard/dashboard\n * @copyright  2025 Rwanda TVET Board\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport { h, render } from 'preact';\nimport App from './app';\nimport type { UserData, StatsData, PageId, SidenavConfig, ThemeConfig, CoursesReportData } from './types';\n\n/**\n * Initialize the Elby Dashboard Preact application.\n *\n * Reads user and stats data from HTML data attributes and renders the app.\n *\n * @param {string} selector - CSS selector for the mount point\n */\nexport const init = (selector: string = '#elby-dashboard-root') => {\n    const container = document.querySelector(selector);\n\n    if (!container) {\n        console.error(`Container not found: ${selector}`);\n        return;\n    }\n\n    // Read data from HTML data attributes\n    try {\n        const userDataAttr = container.getAttribute('data-user');\n        const statsDataAttr = container.getAttribute('data-stats');\n        const sidenavDataAttr = container.getAttribute('data-sidenav');\n        const themeDataAttr = container.getAttribute('data-theme');\n        const coursesReportAttr = container.getAttribute('data-courses-report');\n        const pageAttr = container.getAttribute('data-page') as PageId | null;\n\n        // Parse user data\n        const user: UserData = userDataAttr\n            ? JSON.parse(userDataAttr)\n            : {\n                id: 0,\n                fullname: 'Guest',\n                firstname: 'Guest',\n                lastname: '',\n                email: '',\n                avatar: '',\n                roles: [],\n            };\n\n        // Parse stats data\n        const stats: StatsData = statsDataAttr\n            ? JSON.parse(statsDataAttr)\n            : {\n                totalCourses: 0,\n                totalUsers: 0,\n                totalEnrollments: 0,\n                totalActivities: 0,\n            };\n\n        // Parse sidenav config\n        const sidenavConfig: SidenavConfig = sidenavDataAttr\n            ? JSON.parse(sidenavDataAttr)\n            : {\n                title: 'Dashboard',\n                logoUrl: null,\n            };\n\n        // Parse theme config\n        const themeConfig: ThemeConfig = themeDataAttr\n            ? JSON.parse(themeDataAttr)\n            : {\n                sidenavAccentColor: '#005198',\n                statCard1Color: '#cffafe',\n                statCard2Color: '#fef3c7',\n                statCard3Color: '#f3e8ff',\n                statCard4Color: '#dcfce7',\n                chartPrimaryColor: '#22d3ee',\n                chartSecondaryColor: '#a78bfa',\n                showSearchBar: true,\n                showNotifications: true,\n                showUserProfile: true,\n                menuVisibility: {\n                    courses: true,\n                    presence: true,\n                    communication: true,\n                    event: true,\n                    pedagogy: true,\n                    message: true,\n                    completion: true,\n                    settings: true,\n                },\n            };\n\n        // Parse courses report data (optional, only on courses page)\n        const coursesReportData: CoursesReportData | null = coursesReportAttr\n            ? JSON.parse(coursesReportAttr)\n            : null;\n\n        // Read school code for school detail page.\n        const schoolCode = container.getAttribute('data-school-code') || undefined;\n\n        // Get active page (default to 'home')\n        const activePage: PageId = pageAttr || 'home';\n\n        console.log('Elby Dashboard initialized:', { user: user.fullname, activePage });\n\n        // Render the Preact app\n        render(h(App, { user, stats, activePage, sidenavConfig, themeConfig, coursesReportData, schoolCode }), container);\n    } catch (error) {\n        console.error('Error initializing Elby Dashboard:', error);\n    }\n};\n"],"names":["n","l","u","i","r","o","e","f","c","s","a","p","v","y","w","d","g","_","t","m","k","x","S","C","M","$","O","N","I","h","b","P","B","A","L","D","T","j","F","H","E","V","z","q","G","ajaxCall","methodname","args","resolve","reject","require","Ajax","StatCard","icon","value","label","customBgColor","jsxs","jsx","EngagementDonut","activeThisWeek","atRisk","neverLoggedIn","total","circumference","activeLen","atRiskLen","neverLen","GenderDonut","male","female","maleLen","femaleLen","StudentsIcon","TeacherIcon","EmployeeIcon","CoursesIcon","SchoolsIcon","Dashboard","user","stats","themeConfig","schools","setSchools","useState","schoolsLoading","setSchoolsLoading","traffic","setTraffic","trafficLoading","setTrafficLoading","todayStr","weekAgoStr","trafficFrom","setTrafficFrom","trafficTo","setTrafficTo","useEffect","resp","sorted","fromTs","toTs","rangeDays","period","schoolMaxCount","trafficMax","school","gradeMax","progMax","posMax","Fragment","point","menuItems","icons","DefaultLogoIcon","Sidebar","activePage","sidenavConfig","isOpen","onClose","visibleMenuItems","item","isActive","parentCategories","dummyData","grandTotal","unitLabels","CompletionReport","selectedParentId","setSelectedParentId","filteredData","row","currentGrandTotal","totalParticipants","sum","unitTotals","unitIndex","validRows","avgSum","crSum","cr","cat","unit","index","nodeMatchesSearch","node","query","lowerQuery","course","child","TreeNode","depth","expandedNodes","onToggle","selectedId","onSelect","searchQuery","nodeKey","isExpanded","hasChildren","hasCourses","paddingLeft","matchingCourses","hasMatchingDescendants","findCourseInTree","nodes","courseId","targetId","found","inChildren","collectAllNodeKeys","keys","collect","nodeList","TreeCourseSelect","tree","placeholder","setIsOpen","setSearchQuery","setExpandedNodes","containerRef","useRef","searchInputRef","selectedCourse","toggleNode","key","newExpanded","handleClickOutside","event","handleSelect","id","YearSelect","years","selectedYear","year","DONUT_COLORS","CompletionDonut","rate","colorIndex","progressLength","progressColor","center","truncateText","text","maxLength","SchoolBarChart","sectionIndex","grademax","idx","section","avgValue","sectionGrademax","avgHeight","crHeight","fullName","displayName","ScatterPlot","pct","SortIndicator","column","sortColumn","sortDirection","SortableHeader","children","onSort","className","ReportTable","report","setSortColumn","setSortDirection","handleSort","sortedSchools","useMemo","aVal","bVal","sIdx","avgGrades","avgGrade","CoursesReport","data","handleCourseSelect","courseid","params","handleYearSelect","KpiCard","color","SchoolCard","onClick","SchoolDirectory","loading","setLoading","sortMode","setSortMode","loadSchools","result","schoolsData","fetchSchoolsFromDb","err","schoolsDataAttr","handleSchoolClick","schoolCode","filteredSchools","totalEnrolled","totalActive","totalAtRisk","schoolsWithScores","EngagementBar","distribution","highPct","medPct","lowPct","atRiskPct","WeeklyTrendChart","width","height","padding","maxVal","xStep","activePath","enrolledPath","GenderChart","malePct","femalePct","AgeDistributionChart","chartW","chartH","barW","gap","val","barH","SchoolHierarchy","schoolInfo","expandedLevels","expandedCombos","onToggleLevel","onToggleCombo","level","comboCount","gradeCount","combo","comboKey","isComboExpanded","grade","cg","SchoolCoursesSection","expandedTrades","setExpandedTrades","expandedTradeLevels","setExpandedTradeLevels","toggleTrade","code","prev","next","toggleLevel","trade","totalCourses","levelKey","isLevelExpanded","SchoolDetail","metrics","setMetrics","setDistribution","schoolName","setSchoolName","syncing","setSyncing","weeklyTrend","setWeeklyTrend","demographics","setDemographics","setSchoolInfo","setExpandedLevels","setExpandedCombos","coursesReport","setCoursesReport","loadSchoolData","metricsResult","distResult","demoResult","infoResult","coursesResult","studentResult","students","activeCount","atRiskCount","scoresArr","avgQuiz","progressArr","avgProgress","totalActions","high","medium","low","now","trend","jitter","handleSync","handleExportCsv","rows","csv","blob","url","formatTimeAgo","timestamp","diff","StatusBadge","status","SortIcon","field","currentSort","currentOrder","StudentList","initialSchoolCode","initialCourseId","userType","isTeacher","canManage","setStudents","totalCount","setTotalCount","page","setPage","perpage","sort","setSort","order","setOrder","search","setSearch","searchInput","setSearchInput","setSchoolCode","engagementLevel","setEngagementLevel","programCode","setProgramCode","summary","setSummary","programs","setPrograms","schoolsList","setSchoolsList","editingUserId","setEditingUserId","editingSchoolCode","setEditingSchoolCode","saving","setSaving","loadStudents","handleSaveSchool","userid","handleSearch","headers","totalPages","startItem","endItem","sortableHeader","student","ActionDonut","top","otherCount","segments","offsets","cumulative","seg","len","SchoolTrafficBars","maxActions","PeakHoursHeatmap","dayLabels","maxCount","grid","getColor","count","intensity","day","hour","TopUsersTable","LoadingBlock","TrafficReport","setData","setPeriod","daysBack","setDaysBack","fromDate","setFromDate","toDate","setToDate","heatmapData","setHeatmapData","heatmapLoading","setHeatmapLoading","topUsers","setTopUsers","topUsersLoading","setTopUsersLoading","schoolTraffic","setSchoolTraffic","schoolTrafficLoading","setSchoolTrafficLoading","actionBreakdown","setActionBreakdown","actionBreakdownLoading","setActionBreakdownLoading","getDateParams","from","to","getEffectiveDaysBack","loadTraffic","loadHeatmap","loadTopUsers","loadSchoolTraffic","loadActionBreakdown","dateParams","totalUniqueUsers","avgActions","formatDateTime","toDateInputValue","fromDateInput","AccessLog","entries","setEntries","dateFrom","setDateFrom","dateTo","setDateTo","setUserType","loadLog","entry","formatTimestamp","ts","OperationBadge","operation","LinkUserSection","onLinked","users","setUsers","searching","setSearching","selectedUser","setSelectedUser","sdmsCode","setSdmsCode","lookupPreview","setLookupPreview","lookingUp","setLookingUp","linking","setLinking","linkNotification","setLinkNotification","searchTimer","handleSearchChange","doSearch","term","handleLookup","name","handleLink","EnrollmentCoverageSection","filter","setFilter","loadCoverage","filtered","statusColors","EnrollmentLogsSection","logs","setLogs","operationFilter","setOperationFilter","loadLogs","opt","log","AdminPanel","setStats","notification","setNotification","loadAdminData","adminDataAttr","handleManualSync","type","taskName","Header","onMenuClick","pageTitle","App","coursesReportData","sidebarOpen","setSidebarOpen","init","selector","container","userDataAttr","statsDataAttr","sidenavDataAttr","themeDataAttr","coursesReportAttr","pageAttr","render","error"],"mappings":"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","x_google_ignoreList":[0,1,2]}